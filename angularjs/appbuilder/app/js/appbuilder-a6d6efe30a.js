function hex_md5(e){return binl2hex(core_md5(str2binl(e),e.length*chrsz))}function b64_md5(e){return binl2b64(core_md5(str2binl(e),e.length*chrsz))}function hex_hmac_md5(e,t){return binl2hex(core_hmac_md5(e,t))}function b64_hmac_md5(e,t){return binl2b64(core_hmac_md5(e,t))}function calcMD5(e){return binl2hex(core_md5(str2binl(e),e.length*chrsz))}function md5_vm_test(){return"900150983cd24fb0d6963f7d28e17f72"==hex_md5("abc")}function core_md5(e,t){e[t>>5]|=128<<t%32,e[(t+64>>>9<<4)+14]=t;for(var a=1732584193,n=-271733879,i=-1732584194,s=271733878,r=0;r<e.length;r+=16){var o=a,l=n,c=i,d=s;a=md5_ff(a,n,i,s,e[r+0],7,-680876936),s=md5_ff(s,a,n,i,e[r+1],12,-389564586),i=md5_ff(i,s,a,n,e[r+2],17,606105819),n=md5_ff(n,i,s,a,e[r+3],22,-1044525330),a=md5_ff(a,n,i,s,e[r+4],7,-176418897),s=md5_ff(s,a,n,i,e[r+5],12,1200080426),i=md5_ff(i,s,a,n,e[r+6],17,-1473231341),n=md5_ff(n,i,s,a,e[r+7],22,-45705983),a=md5_ff(a,n,i,s,e[r+8],7,1770035416),s=md5_ff(s,a,n,i,e[r+9],12,-1958414417),i=md5_ff(i,s,a,n,e[r+10],17,-42063),n=md5_ff(n,i,s,a,e[r+11],22,-1990404162),a=md5_ff(a,n,i,s,e[r+12],7,1804603682),s=md5_ff(s,a,n,i,e[r+13],12,-40341101),i=md5_ff(i,s,a,n,e[r+14],17,-1502002290),n=md5_ff(n,i,s,a,e[r+15],22,1236535329),a=md5_gg(a,n,i,s,e[r+1],5,-165796510),s=md5_gg(s,a,n,i,e[r+6],9,-1069501632),i=md5_gg(i,s,a,n,e[r+11],14,643717713),n=md5_gg(n,i,s,a,e[r+0],20,-373897302),a=md5_gg(a,n,i,s,e[r+5],5,-701558691),s=md5_gg(s,a,n,i,e[r+10],9,38016083),i=md5_gg(i,s,a,n,e[r+15],14,-660478335),n=md5_gg(n,i,s,a,e[r+4],20,-405537848),a=md5_gg(a,n,i,s,e[r+9],5,568446438),s=md5_gg(s,a,n,i,e[r+14],9,-1019803690),i=md5_gg(i,s,a,n,e[r+3],14,-187363961),n=md5_gg(n,i,s,a,e[r+8],20,1163531501),a=md5_gg(a,n,i,s,e[r+13],5,-1444681467),s=md5_gg(s,a,n,i,e[r+2],9,-51403784),i=md5_gg(i,s,a,n,e[r+7],14,1735328473),n=md5_gg(n,i,s,a,e[r+12],20,-1926607734),a=md5_hh(a,n,i,s,e[r+5],4,-378558),s=md5_hh(s,a,n,i,e[r+8],11,-2022574463),i=md5_hh(i,s,a,n,e[r+11],16,1839030562),n=md5_hh(n,i,s,a,e[r+14],23,-35309556),a=md5_hh(a,n,i,s,e[r+1],4,-1530992060),s=md5_hh(s,a,n,i,e[r+4],11,1272893353),i=md5_hh(i,s,a,n,e[r+7],16,-155497632),n=md5_hh(n,i,s,a,e[r+10],23,-1094730640),a=md5_hh(a,n,i,s,e[r+13],4,681279174),s=md5_hh(s,a,n,i,e[r+0],11,-358537222),i=md5_hh(i,s,a,n,e[r+3],16,-722521979),n=md5_hh(n,i,s,a,e[r+6],23,76029189),a=md5_hh(a,n,i,s,e[r+9],4,-640364487),s=md5_hh(s,a,n,i,e[r+12],11,-421815835),i=md5_hh(i,s,a,n,e[r+15],16,530742520),n=md5_hh(n,i,s,a,e[r+2],23,-995338651),a=md5_ii(a,n,i,s,e[r+0],6,-198630844),s=md5_ii(s,a,n,i,e[r+7],10,1126891415),i=md5_ii(i,s,a,n,e[r+14],15,-1416354905),n=md5_ii(n,i,s,a,e[r+5],21,-57434055),a=md5_ii(a,n,i,s,e[r+12],6,1700485571),s=md5_ii(s,a,n,i,e[r+3],10,-1894986606),i=md5_ii(i,s,a,n,e[r+10],15,-1051523),n=md5_ii(n,i,s,a,e[r+1],21,-2054922799),a=md5_ii(a,n,i,s,e[r+8],6,1873313359),s=md5_ii(s,a,n,i,e[r+15],10,-30611744),i=md5_ii(i,s,a,n,e[r+6],15,-1560198380),n=md5_ii(n,i,s,a,e[r+13],21,1309151649),a=md5_ii(a,n,i,s,e[r+4],6,-145523070),s=md5_ii(s,a,n,i,e[r+11],10,-1120210379),i=md5_ii(i,s,a,n,e[r+2],15,718787259),n=md5_ii(n,i,s,a,e[r+9],21,-343485551),a=safe_add(a,o),n=safe_add(n,l),i=safe_add(i,c),s=safe_add(s,d)}return Array(a,n,i,s)}function md5_cmn(e,t,a,n,i,s){return safe_add(bit_rol(safe_add(safe_add(t,e),safe_add(n,s)),i),a)}function md5_ff(e,t,a,n,i,s,r){return md5_cmn(t&a|~t&n,e,t,i,s,r)}function md5_gg(e,t,a,n,i,s,r){return md5_cmn(t&n|a&~n,e,t,i,s,r)}function md5_hh(e,t,a,n,i,s,r){return md5_cmn(t^a^n,e,t,i,s,r)}function md5_ii(e,t,a,n,i,s,r){return md5_cmn(a^(t|~n),e,t,i,s,r)}function core_hmac_md5(e,t){var a=str2binl(e);a.length>16&&(a=core_md5(a,e.length*chrsz));for(var n=Array(16),i=Array(16),s=0;s<16;s++)n[s]=909522486^a[s],i[s]=1549556828^a[s];var r=core_md5(n.concat(str2binl(t)),512+t.length*chrsz);return core_md5(i.concat(r),640)}function safe_add(e,t){var a=(65535&e)+(65535&t),n=(e>>16)+(t>>16)+(a>>16);return n<<16|65535&a}function bit_rol(e,t){return e<<t|e>>>32-t}function str2binl(e){for(var t=Array(),a=(1<<chrsz)-1,n=0;n<e.length*chrsz;n+=chrsz)t[n>>5]|=(e.charCodeAt(n/chrsz)&a)<<n%32;return t}function binl2hex(e){for(var t=hexcase?"0123456789ABCDEF":"0123456789abcdef",a="",n=0;n<4*e.length;n++)a+=t.charAt(e[n>>2]>>n%4*8+4&15)+t.charAt(e[n>>2]>>n%4*8&15);return a}function binl2b64(e){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a="",n=0;n<4*e.length;n+=3)for(var i=(e[n>>2]>>8*(n%4)&255)<<16|(e[n+1>>2]>>8*((n+1)%4)&255)<<8|e[n+2>>2]>>8*((n+2)%4)&255,s=0;s<4;s++)a+=8*n+6*s>32*e.length?b64pad:t.charAt(i>>6*(3-s)&63);return a}function base(){var e,t,a,n=document.documentElement,i=document.createElement("style");document.querySelector('meta[name="viewport"]');e=window.devicePixelRatio||1,t=n.clientWidth*e/10,a=1/e;var s=t/e;n.setAttribute("data-dpr",e),n.firstElementChild.appendChild(i),n.clientWidth>=640&&(s=64),i.innerHTML="html{font-size:"+s+"px!important;}",window.rem2px=function(e){return e=parseFloat(e),e*t},window.px2rem=function(e){return e=parseFloat(e),e/t},window.dpr=e,window.rem=t}function txtTips(e){var t=$(".txt-tips").hasClass("txt-tips");$(".txt-tips").width();t||$("body").append('<div class="txt-tips"></div>'),$(".txt-tips").html(e).css({bottom:$(window).height()/5,left:$(window).width()/2-$(".txt-tips").width()/2-10}).show(),setTimeout(function(){$(".txt-tips").fadeOut("slow")},1500)}function exchangeAppId(){var e=0,t=decodeURIComponent(location.href),a=t.split("#/");if(e=a[1].substring(0,6),localStorage.appID&&localStorage.appIDKey==e)return localStorage.appID;if(localStorage.appIDKey!==e&&"undefi"!==e)localStorage.removeItem("appID"),localStorage.removeItem("appIDKey"),localStorage.removeItem("app"),localStorage.removeItem("wxid");else if("undefi"==e&&localStorage.appID&&localStorage.appIDKey)return localStorage.appID;$.get(reqHost+"/api/app/info/"+e,function(t){localStorage.setItem("appID",t.content.id),localStorage.setItem("appIDKey",e),localStorage.setItem("wxid",t.content.WxAppId),location.reload()})}var hexcase=0,b64pad="",chrsz=8;viewSrc="",reqHost="",base(),window.onresize=function(e){base()},window.loading=!1;var loader={set:function(){$(".loading").hasClass("loading")||$("body").append('<div class="loading"><div class="img-parent"><img src="http://appbuilder.loongjoy.com/phoneweb/app/img/Loading_app.gif"></div></div>'),$(".loading").css({width:"10rem",height:$(window).height()}),$(".img-parent").css({top:$(window).height()/3,left:$(window).width()/2-$(".img-parent").width()/2-10})},open:function(){window.loading=!0,$(".loading").show()},close:function(){window.loading=!1,$(".loading").hide()}},appBuilder=angular.module("appBuilder",["ui.router","ngCookies","ngTouch","ngAnimate","appBuilderCtr","appBuilderService","appBuilderFactory","phonecatFilters","pascalprecht.translate"]);appBuilder.constant("APP_ID",exchangeAppId()).constant("HOST",viewSrc+"/phoneweb/app/index.html#").constant("API_SALT","ab3e87601534d2ad785eb2d241d59f14"),appBuilder.config(["$stateProvider","$urlRouterProvider","$logProvider","$translateProvider",function(e,t,a,n){function i(e){if(!sessionStorage.reurl){if(location.href.indexOf("login")>-1)return void(sessionStorage.reurl=localStorage._host+e+"/"+localStorage.appIDKey+"/index");sessionStorage.reurl=location.href}}var s=window.navigator.language.substring(0,2);n.translations("en",{aboutUs:"About us",enterSearchContent:"Enter search content",articleDetails:"Article details",noComment:"No comment",allComments:"All comments",merchantReply:"Merchant reply:",sendOut:"Send out",commentArticle:"How to write the article, comment on it",articleCenter:"Article center",noContent:"No content",articleList:"Article list",shoppingCart:"Shopping Cart",edit:"edit",product:"product",integralMall:"Integral mall",discount:"discount",subtract:"subtract",give:"give",Total:"Total:",notFreight:"(Does not include freight)",accounts:"To settle accounts",checkAll:"check all",delete:"delete",placeOrder:"place order",sendAddress:"Address is not added, where to send it",paymentMethod:"Payment method",shippingMethod:"Shipping Method",optionalInformation:"Optional,Input memo information",messageRemarks:"Message remarks:",available:"available",integralDeductible:"integral Deductible",inAll:"in all",pieceProduct:"piece product",freight:"freight",selectPaymentMethod:"Select payment method",weChatPayment:"WeChat payment",noteDetail:"Post Detail",pushUp:"push up",postDeleted:"This post has been deleted",commentOnIt:"Comment on it",PUBLISHPOST:"PUBLISH POST",issue:"issue",editorPostTitle:"Editor post title",enterPostContent:"Enter post content...",addToPicture:"Add up to 9 pictures, one of the largest single picture 2M",forum:"forum",personParticipate:"person participate in",dailyLifeNaggings:"Daily life naggings",post:"post:",Replies:"Replies:",forgetPassword:"Forget",phoneNumber:"Please enter a 11 digit phone number",newPassword:"Please enter a new password for 6-12",verificationCode:"Please enter the verification code",Determine:"Determine",GetverificationCode:"Get verification code",overplus:"overplus",second:"second",Login:" Login",password:"Please enter a 6-12 bit password",register:"register",nickname:"Please enter a 2-10 nickname",newProducts:"New products on the new",Rush:"Rush at once",grab:"About to open to grab",grabAtOnce:"Grab at once",robbed:"Have robbed the light",Sold:"Sold",piece:"piece",currentIntegration:"Current integration:",convertible:"convertible",Deficiency:"Deficiency of integral",noConvertibleProducts:"No convertible products",sale:"discount",openGrab:"Open grab",alreadyOpenGrab:"Already open grab",convenienceSupermarket:"Convenience supermarket",havebeenRobbed:"Have been robbed",path:"path",shippingAddress:"Shipping address",addAddress:"Add address",setUp:"Set up",aboutStore:"About store",wipeCache:"wipe cache",currentVersion:"current version",quicklyDownload:"Share to friends, sweep code quickly download",filter:" filter",whole:"whole",notPaid:"Not paid",alreadyPaid:"Already paid",paymentFailure:"Payment failure",alreadyAhipped:"Already shipped",cashOnDelivery:"Cash on Delivery",canceled:"canceled",completed:"completed",IntegrationOrder:"Integration order",ProductOrder:"Product order",Sun:"Sun.",Mon:"Mon.",Tues:"Tues.",Wed:"Wed.",Thurs:"Thurs",Fri:"Fri.",Sat:"Sat.",year:"year",month:"month",start:"start",end:"end",selectShoppingGuide:"Select shopping guide",currentLevel:"Current level",nextLevel:"Distance to the next level",growthValue:"Growth value",growthValueDetailed:"growth Value Detailed",information:"Personal information",myInformation:"My information",portrait:"Head portrait",name:"Full name",CellphoneNumber:"Cell-phone number",exitAccount:"Exit account",comment:"comment",integral:"integral",MyOrder:"My order",MyGuide:"My shopping guide",MyPost:"My post",complaintsAndAuggestions:"Complaints and suggestions",accumulatedIncome:"Accumulated income(￥)",earningsPeriod:"Earnings period(￥)",TotalOrder:"Total order(￥)",RecentUpdate:"Recent update:",to:"to",ClearFilterDate:"Clear filter date",MyMember:"My member",orderDetails:"order details",IncomeDetails:"Income Details",NoRecord:"No record",OrderAmount:"Order amount:",OrderIntegration:"Credit Order:",news:"news",back:"back"}),n.translations("zh",{back:"返回",news:"消息",OrderIntegration:"订单积分:",OrderAmount:"订单金额:",NoRecord:"暂无记录",IncomeDetails:"收益明细",orderDetails:"订单明细",MyMember:"我的会员",ClearFilterDate:"清除筛选日期",to:"至",RecentUpdate:"最近更新：",TotalOrder:"订单总额（元）",earningsPeriod:"期间收益（元）",accumulatedIncome:"累计收益（元）",complaintsAndAuggestions:"投诉建议",MyPost:"我的帖子",MyGuide:"我的导购",MyOrder:"我的订单",integral:"积分",comment:"评论",exitAccount:"退出帐号",CellphoneNumber:"手机号",name:"姓名",portrait:"头像",myInformation:"我的资料",information:"个人信息",growthValueDetailed:"成长值明细",growthValue:"成长值",nextLevel:"距离下一等级还需",currentLevel:"当前等级",selectShoppingGuide:"选择导购",end:"结束",start:"开始",month:"月",year:"年",Sat:"六",Fri:"五",Thurs:"四",Wed:"三",Tues:"二",Mon:"一",Sun:"日",ProductOrder:"产品订单",IntegrationOrder:"积分订单",canceled:"已取消",completed:"已完成",cashOnDelivery:"货到付款",alreadyAhipped:"已发货",paymentFailure:"支付失败",alreadyPaid:"已支付",notPaid:"未支付",whole:"全部",filter:"筛选",quicklyDownload:"分享给朋友，扫码快速下载",currentVersion:"当前版本",wipeCache:"清空缓存",aboutStore:"关于门店",setUp:"设置",addAddress:"新增地址",shippingAddress:"收货地址",path:"路径",convenienceSupermarket:"便民超市",havebeenRobbed:"已抢",alreadyOpenGrab:"已开抢",openGrab:"未开抢",sale:"折扣",noConvertibleProducts:"暂无可兑换产品",Deficiency:"积分不足",convertible:"可兑换",currentIntegration:"当前积分:",piece:"件",Sold:"已售",robbed:"已抢光",grabAtOnce:"马上抢",grab:"即将开抢",Rush:"立即抢",newProducts:"新品上新",nickname:"请输入2-10位昵称",register:"注册",password:"请输入6-12位密码",Login:"登录",second:"秒",overplus:"还有",GetverificationCode:"获取验证码",Determine:"确定",verificationCode:"请输入验证码",newPassword:"请输入6-12位新密码",phoneNumber:"请输入11位手机号",forgetPassword:"忘记密码",Replies:"回帖:",post:"帖子:",dailyLifeNaggings:"生活日常碎碎念",personParticipate:"人参与",forum:"论坛",addToPicture:"最多添加9张图片，单张图片最大2M",enterPostContent:"输入帖子内容...",editorPostTitle:"编辑帖子标题",issue:"发布",PUBLISHPOST:"发布帖子",commentOnIt:"点评一下吧",postDeleted:"该贴已删除",pushUp:"顶",noteDetail:"帖子详情",weChatPayment:"微信支付",selectPaymentMethod:"选择支付方式",freight:"含运费",pieceProduct:"件商品",inAll:"共",integralDeductible:"积分抵",available:"可用",messageRemarks:"留言备注：",optionalInformation:"选填，可输入备注信息",shippingMethod:"配送方式",paymentMethod:"支付方式",sendAddress:"地址都没有添加，要寄去哪里呢",placeOrder:"提交订单",delete:"删除",checkAll:"全选",accounts:"去结算",notFreight:"(不含运费)",Total:"合计：",give:"送",subtract:"减",discount:"折",integralMall:"积分商城",product:"产品",edit:"编辑",shoppingCart:"购物车",articleList:"文章列表",noContent:"没有内容了",articleCenter:"文章中心",commentArticle:"文章写得怎么样，点评一下吧",sendOut:"发送",merchantReply:"商户回复:",allComments:"全部评论",noComment:"暂无评论",articleDetails:"文章详情",aboutUs:"关于门店",enterSearchContent:"输入搜索内容"}),n.preferredLanguage(s),n.useSanitizeValueStrategy("escapeParameters");var r=(angular.fromJson(localStorage.app),"/"+localStorage.appIDKey);t.otherwise(r+"/index"),e.state("index",{url:r+"/index",templateUrl:viewSrc+"home.html",controller:"IndexController"}).state("login",{url:r+"/login?reurl",templateUrl:viewSrc+"enter/login.html",controller:"LoginController",controllerAs:"vm",onEnter:["handleURL","HOST",function(e,t){e.markValue("code")||"undefined"==typeof WeixinJSBridge?i(t):localStorage.wxid?location.href="https://open.weixin.qq.com/connect/oauth2/authorize?appid="+localStorage.wxid+"&redirect_uri="+encodeURIComponent(localStorage._host+t+"/"+localStorage.appIDKey+"/login")+"&response_type=code&scope=snsapi_userinfo&state=STATE&#wechat_redirect":i(t)}]}).state("reg",{url:r+"/reg?reurl",templateUrl:viewSrc+"enter/reg.html",controller:"RegController",controllerAs:"vm"}).state("forget",{url:r+"/forget?reurl",templateUrl:viewSrc+"enter/forget.html",controller:"ForgetController",controllerAs:"vm"}).state("index.find",{url:"/find?code",controller:"FindController",controllerAs:"vm",templateUrl:viewSrc+"index/find.html",onEnter:["$rootScope",function(e){e.currentPage=1,e.totalPage=2}],resolve:{resData:["api","APP_ID","appCache",function(e,t,a){return a.get("indexFindCache")||e.get("/api/index/index",{appId:t,page:1})}]}}).state("index.sale",{url:"/sale",controller:"SaleController",controllerAs:"vm",templateUrl:viewSrc+"index/sale.html",onEnter:["$rootScope",function(e){e.currentPage=1,e.totalPage=2}]}).state("index.subshop",{url:"/subshop",controller:"SubShopController",controllerAs:"vm",templateUrl:viewSrc+"index/subshop.html",onEnter:["$rootScope",function(e){e.currentPage=1,e.totalPage=2}]}).state("subshop-detail",{url:r+"/subshop-detail/:id",controller:"SubShopDetailController",controllerAs:"vm",templateUrl:viewSrc+"index/subshop-detail.html",resolve:{resData:["api","$stateParams","appCache",function(e,t,a){return a.get("subshopDetail"+t.id)||e.get("/api/branch/detail/"+t.id)}]}}).state("index.pointmall",{url:"/pointmall",controller:"PointMallController",controllerAs:"vm",templateUrl:viewSrc+"index/pointmall.html",onEnter:["$rootScope",function(e){e.currentPage=1,e.totalPage=2}]}).state("search",{url:r+"/search",controller:"SearchController",controllerAs:"vm",templateUrl:viewSrc+"search.html",onEnter:["$rootScope",function(e){e.currentPage=1,e.totalPage=2,e.searchtype=1,e.searchtag=0}],resolve:{resData:["api","APP_ID",function(e,t){return e.get("/api/product/list",{appId:t,pageCount:10,page:1,type:1})}]}}).state("car",{url:r+"/car?type&reurl",templateUrl:viewSrc+"buy/car.html",controller:"CarController",controllerAs:"vm",resolve:{resData:["api","APP_ID","$stateParams",function(e,t,a){void 0===a.type&&(a.type=1);var n=angular.fromJson(sessionStorage.userinfo);return e.get("/api/cart/list",{userId:n.userId,appId:t,type:a.type,pageCount:10,page:10})}]}}).state("confirm",{url:r+"/confirm?tag&cartIds&cartType&productId&number&reurl",templateUrl:viewSrc+"buy/confirm.html",controller:"ConfirmController",controllerAs:"vm",resolve:{resData:["api","$stateParams","APP_ID",function(e,t,a){var n=angular.fromJson(sessionStorage.userinfo);return e.get("/api/order/confirm",{userId:n.userId,appId:a,tag:t.tag,cartIds:t.cartIds,cartType:t.cartType,productId:t.productId,number:t.number})}]},onEnter:["$state",function(e){sessionStorage.userinfo||e.go("login");var t=sessionStorage.reurl;console.log("sessionStorage.reurl："+t),t&&t.indexOf("product-detail")<0?sessionStorage.reurl=location.href:sessionStorage.reurl=location.href}]}).state("qrcode",{url:r+"/qrcode?src&id",templateUrl:viewSrc+"buy/QRcode.html",controller:"QrCodeController",controllerAs:"vm",onExit:["$rootScope","$interval",function(e,t){t.cancel(e.stop)}]}).state("reset",{url:r+"/reset?reurl",templateUrl:viewSrc+"mine/reset.html",controller:"ResetController",controllerAs:"vm"}).state("community",{url:r+"/community",templateUrl:viewSrc+"community/index.html",controller:"CommunityController",controllerAs:"vm",onEnter:["$rootScope",function(e){e.currentPage=1,e.totalPage=2}]}).state("community-sublist",{url:r+"/community-sublist?id",templateUrl:viewSrc+"community/sublist.html",controller:"CommunitySubController",controllerAs:"vm",onEnter:["$rootScope",function(e){e.currentPage=1,e.totalPage=2}]}).state("community-detail",{url:r+"/community-detail?id",templateUrl:viewSrc+"community/detail.html",controller:"CommunityDetailController",controllerAs:"vm",resolve:{resData:["api","APP_ID","$stateParams","appCache",function(e,t,a,n){return n.get("communityDetail"+a.id)||e.get("/api/forum/topicdetail/"+a.id)}]},onEnter:["$state",function(e){e.is("community-sublist")&&(sessionStorage.reurl=location.href)}]}).state("community-edit",{url:r+"/community-edit",templateUrl:viewSrc+"community/edit.html",controller:"CommunityEditController",controllerAs:"vm",onEnter:["$state",function(e){sessionStorage.userinfo||e.go("login");var t=angular.fromJson(sessionStorage.userinfo);"AppUser"!==t.roleTag&&(txtTips("仅限普通用户操作"),e.reload())}]}).state("product",{url:r+"/product",templateUrl:viewSrc+"product/index.html",controller:"ProductController",controllerAs:"vm"}).state("product-list",{url:r+"/product-list?id?name",templateUrl:viewSrc+"product/list.html",controller:"ProductListController",controllerAs:"vm",onEnter:["$rootScope",function(e){e.currentPage=1,e.totalPage=2}]}).state("product-detail",{url:r+"/product-detail?id&reurl",templateUrl:viewSrc+"product/detail.html",controller:"ProductDetailController",controllerAs:"vm",resolve:{resData:["$stateParams","api",function(e,t){return t.get("/api/product/detail/"+e.id)}]},onEnter:["$state","$stateParams","handleURL",function(e,t,a){sessionStorage.reurl?sessionStorage.reurl.indexOf("product")<0?sessionStorage.reurl=location.href:a.markValue("id",sessionStorage.reurl)!==t.id&&(sessionStorage.reurl=location.href):sessionStorage.reurl=location.href}]}).state("allComment",{url:r+"/allComment?id",templateUrl:viewSrc+"product/allcomment.html",controller:"AllCommentController",controllerAs:"vm"}).state("article",{url:r+"/article",templateUrl:viewSrc+"article/index.html",controller:"ArticleController",controllerAs:"vm"}).state("article-list",{url:r+"/article-list?id&name",templateUrl:viewSrc+"article/list.html",controller:"ArticleListController",controllerAs:"vm",resolve:{resData:["$stateParams","api","appCache","APP_ID",function(e,t,a,n){return a.get("articleList"+e.id)||t.get("/api/article/list",{appId:n,categoryId:e.id})}]}}).state("article-detail",{url:r+"/article-detail?id",templateUrl:viewSrc+"article/detail.html",controller:"ArticleDetailController",controllerAs:"vm",resolve:{resData:["$stateParams","api","appCache",function(e,t,a){return a.get("articleDetail"+e.id)||t.get("/api/article/detail/"+e.id)}]},onEnter:["$state",function(e){e.is("article-list")&&(sessionStorage.reurl=location.href)}]}).state("mine",{url:r+"/mine",templateUrl:viewSrc+"mine/index.html",controller:"MineController",controllerAs:"vm",onEnter:["$rootScope",function(e){e.currentPage=1,e.totalPage=2}]}).state("myguide",{url:r+"/myguide?reurl",templateUrl:viewSrc+"mine/myguide.html",controller:"GuideController",controllerAs:"vm",resolve:{resData:["api","appCache","APP_ID",function(e,t,a){var n={},i=angular.fromJson(sessionStorage.userinfo);return i.guideId&&t.get("guideinfo")?n=t.get("guideinfo"):i.guideId?(n=e.get("/api/branch/guideinfo",{appId:a,userId:i.userId}),t.put("guideinfo",n)):n=null,n}]}}).state("message",{url:r+"/message",templateUrl:viewSrc+"mine/message.html",controller:"MessageController",controllerAs:"vm",resolve:{resData:["api","appCache","APP_ID",function(e,t,a){var n=angular.fromJson(sessionStorage.userinfo);return e.get("/api/account/messagegather",{appId:a,userId:n.userId})}]}}).state("messageList",{url:r+"/messageList?resourceType",templateUrl:viewSrc+"mine/messageList.html",controller:"MessageListController",controllerAs:"vm"}).state("choseguide",{url:r+"/choseguide?reurl",templateUrl:viewSrc+"mine/choseguide.html",controller:"GuideController",controllerAs:"vm",resolve:{resData:["api","appCache","APP_ID",function(e,t,a){return t.get("branchList")||e.get("/api/branch/list",{appId:a})}]}}).state("problemdetail",{url:r+"/problemdetail?id",templateUrl:viewSrc+"mine/problemdetail.html",controller:"ProblemDetailController",controllerAs:"vm"}).state("mineset",{url:r+"/mineset?reurl",templateUrl:viewSrc+"mine/mineset.html",controller:"MineSetController",controllerAs:"vm"}).state("appset",{url:r+"/appset",templateUrl:viewSrc+"mine/appset.html",controller:"AppSetController",controllerAs:"vm"}).state("address",{url:r+"/address?tag&reurl",templateUrl:viewSrc+"mine/address.html",controller:"AddressController",controllerAs:"vm"}).state("plus-address",{url:r+"/plus-address?id&reurl",templateUrl:viewSrc+"mine/plusaddress.html",controller:"PlusAddressController",controllerAs:"vm"}).state("suggest",{url:r+"/suggest",templateUrl:viewSrc+"mine/suggest.html",controller:"SuggestController",controllerAs:"vm",resolve:{resData:["api","APP_ID",function(e,t){var a=angular.fromJson(sessionStorage.userinfo);return e.get("/api/account/advise",{userId:a.userId,appId:t})}]}}).state("growth",{url:r+"/growth",templateUrl:viewSrc+"mine/growth.html",controller:"GrowthController",controllerAs:"vm",onEnter:["$rootScope",function(e){e.currentPage=1,e.totalPage=2}]}).state("myOrder",{url:r+"/myOrder",templateUrl:viewSrc+"mine/myorder.html",controller:"MyOrderController",controllerAs:"vm",onEnter:["$rootScope",function(e){e.currentPage=1,e.totalPage=2}]}).state("order-detail",{url:r+"/order-detail?id",templateUrl:viewSrc+"mine/orderdetail.html",controller:"OrderDetailController",controllerAs:"vm",resolve:{resData:["api","appCache","$stateParams",function(e,t,a){return t.get("orderDetail"+a.id)||e.get("/api/order/detail/"+a.id)}]}}).state("myCommunity",{url:r+"/myCommunity",templateUrl:viewSrc+"mine/mycommunity.html",controller:"MyCommunityController",controllerAs:"vm",onEnter:["$rootScope",function(e){e.currentPage=1,e.totalPage=2}]}).state("myComment",{url:r+"/myComment",templateUrl:viewSrc+"mine/mycomment.html",controller:"MyCommentController",controllerAs:"vm",onEnter:["$rootScope",function(e){e.currentPage=1,e.totalPage=2}]}).state("aboutus",{url:r+"/aboutus",templateUrl:viewSrc+"aboutus.html",controller:"AboutUsController",resolve:{resData:["api","APP_ID","appCache",function(e,t,a){return a.get("aboutus")||e.get("/api/public/about/"+t)}]}}).state("mypoint",{url:r+"/mypoint",templateUrl:viewSrc+"mine/mypoint.html",controller:"MyPointController",onEnter:["$rootScope",function(e){e.currentPage=1,e.totalPage=2}]}).state("guideinformation",{url:r+"/guideinformation",templateUrl:viewSrc+"mine/guideinformation.html",controller:"MineSetController"}).state("mymember",{url:r+"/mymember",templateUrl:viewSrc+"mine/mymember.html",controller:"MyMemberController",onEnter:["$rootScope",function(e){e.currentPage=1,e.totalPage=2}]}).state("takecomments",{url:r+"/takecomments?orderId",templateUrl:viewSrc+"mine/takecomments.html",controller:"TakeCommentsController",resolve:{resData:["api","appCache","$stateParams",function(e,t,a){return t.get("orderDetail"+a.orderId)||e.get("/api/order/detail/"+a.orderId)}]}}).state("calendar",{url:r+"/calendar",templateUrl:viewSrc+"mine/calendar.html",controller:"CalendarController"}).state("test",{url:r+"/test",templateUrl:viewSrc+"test.html"})}]),appBuilder.run(["APP_ID","api","$cookies","$state","$rootScope","appCache",function(e,t,a,n,i,s){loader.set(),s.removeAll(),console.log("appid:"+e),localStorage._host=location.protocol+"//"+location.host,a.get("username")&&a.get("password")?sessionStorage.userinfo||t.get("/api/account/login",{mobile:a.get("username"),appId:e,password:a.get("password")},function(e){n.go("index.find"),e.success&&sessionStorage.setItem("userinfo",angular.toJson(e.content))}):sessionStorage.removeItem("userinfo");var r=angular.fromJson(localStorage.app);void 0===r||e!==r.id?t.get("/api/app/info/"+e,function(e){localStorage.setItem("app",angular.toJson(e.content)),localStorage.setItem("wxid",e.content.WxAppId),i.apptitle=e.content.name}):i.apptitle=r.name,console.log(angular.fromJson(sessionStorage.userinfo)),console.log(angular.fromJson(localStorage.app))}]),angular.module("me-lazyload",[]).directive("lazySrc",["$window","$document",function(e,t){function a(e){var t=e.data("__uid");return t||e.data("__uid",t=""+ ++p),t}function n(){var e,t="number"==typeof c.pageXOffset?c.pageXOffset:(((e=o.documentElement)||(e=l.parentNode))&&"number"==typeof e.ScrollLeft?e:l).ScrollLeft,a="number"==typeof c.pageYOffset?c.pageYOffset:(((e=o.documentElement)||(e=l.parentNode))&&"number"==typeof e.ScrollTop?e:l).ScrollTop;return{offsetX:t,offsetY:a}}function i(e){var t,a,i=e[0],s=i.getBoundingClientRect(),r=n(),l=r.offsetX,d=r.offsetY,p=s.width,u=s.height,m=s.left+l,g=s.top+d,f=Math.max(o.documentElement.clientWidth,c.innerWidth||0),h=Math.max(o.documentElement.clientHeight,c.innerHeight||0);return g<=d?g+u>=d&&(a=!0):g>=d&&g<=d+h&&(a=!0),m<=l?m+p>=l&&(t=!0):m>=l&&m<=l+f&&(t=!0),t&&a}function s(){Object.keys(u).forEach(function(e){var t=u[e],a=t.iElement,n=t.$scope;i(a)&&a.attr("src",n.lazySrc)})}function r(){var e=angular.element(this),t=a(e);e.css("opacity",1),u.hasOwnProperty(t)&&delete u[t]}var o=t[0],l=o.body,c=e,d=angular.element(c),p=0,u={};return d.bind("scroll",s),d.bind("resize",s),{restrict:"A",scope:{lazySrc:"@",animateVisible:"@",animateSpeed:"@"},link:function(e,t){t.bind("load",r),e.$watch("lazySrc",function(){var n="1s";if(null!=e.animateSpeed&&(n=e.animateSpeed),i(t))e.animateVisible&&t.css({"background-color":"#fff",opacity:0,"-webkit-transition":"opacity "+n,transition:"opacity "+n}),t.attr("src",e.lazySrc);else{var s=a(t);t.css({"background-color":"#fff",opacity:0,"-webkit-transition":"opacity "+n,transition:"opacity "+n}),u[s]={iElement:t,$scope:e}}}),e.$on("$destroy",function(){t.unbind("load");var e=a(t);u.hasOwnProperty(e)&&delete u[e]})}}}]);var appAnimations=angular.module("view-slide-in",["ngAnimate"]);appAnimations.animation(".view-slide-in",function(){return{enter:function(e,t){e.css({opacity:.5,position:"relative",top:"100px",left:"200px"}).animate({top:0,left:0,opacity:1},1e3,t)}}});var appBuilderCtr=angular.module("appBuilderCtr",["ngCookies","ngFileUpload","me-lazyload"]);appBuilderCtr.controller("BaseController",["$filter","$scope","$rootScope","$interval","api","$state","$stateParams","APP_ID",function(e,t,a,n,i,s,r,o){a.headermove="0",t.getcodeword=e("translate")("GetverificationCode"),t.code=function(a,s){return t.getcodeword===e("translate")("GetverificationCode")&&void i.get("/api/account/captcha",{mobile:a,appId:o,tag:s||1},function(a){if(txtTips(a.msg),a.success)var i=60,s=n(function(){i-=1,t.getcodeword=e("translate")("overplus")+i+e("translate")("second"),i<0&&(n.cancel(s),t.getcodeword=e("translate")("GetverificationCode"))},1e3)})},t.set=function(e){void 0===e?t.flag=!t.flag:1==e&&(t.flagPart=!t.flagPart),t.style={height:window.innerHeight}},t.goCar=function(){var e=encodeURIComponent(location.href);return null===sessionStorage.getItem("userinfo")?void s.go("login",{reurl:e}):void s.go("car",{reurl:e})}}]),appBuilderCtr.controller("IndexController",["$scope","$state","appCache",function(e,t,a){a.remove("indexFindCache"),localStorage.appID&&t.go("index.find")}]),appBuilderCtr.controller("FindController",["$scope","$rootScope","resData","$state","appCache","KillZero",function(e,t,a,n,i,s){if(a.data.success){var r=a.data.content;e.topimgs=r.locationAds[0].ads,e.centerimgs=r.locationAds[1].ads,e.indexdata={},e.indexdata.newProducts=s(r.newProducts),e.indexdata.hotProducts=s(r.hotProducts),e.indexdata.locationAds=r.locationAds,a.data.content=e.indexdata,i.put("indexFindCache",a)}}]),appBuilderCtr.controller("SaleController",["$scope","$rootScope","api","APP_ID","appCache","$interval","KillZero",function(e,t,a,n,i,s,r){e.index=0,e.menudata=[],a.get("/api/product/promotion/"+n,{page:1},function(t){t.success&&(e.topMenu=r(t.content))}),e.menuActive=function(n,s){jQuery(document).scrollTop(0),t.currentPage=1,t.totalPage=2,e.acount=n,e.index=n,t.saleMenuData||(t.saleMenuData=[]),i.get("saleMenuCache"+n)?t.saleMenuData[n]=i.get("saleMenuCache"+n):a.get("/api/product/promotionproduct/"+s,{page:1,pageCount:10},function(e){if(e.success){t.saleMenuData[n]=e.content.products;var a=e.content.products;a.totalPage=e.content.pager.totalPage,a.currentPage=e.content.pager.currentPage,i.put("saleMenuCache"+n,a)}})}}]),appBuilderCtr.controller("SubShopController",["$scope","$rootScope","api","APP_ID","appCache",function(e,t,a,n,i){i.get("indexSubCache")?t.subshopList=i.get("indexSubCache"):a.get("/api/branch/list?appId="+n,{page:1},function(e){e.success&&(t.subshopList=e.content.branches,i.put("indexSubCache",e.content.branches))})}]),appBuilderCtr.controller("SubShopDetailController",["$scope","$rootScope","resData","appCache","$stateParams",function(e,t,a,n,i){a.data.success?(e.detail=a.data.content,n.put("subshopDetail"+i.id,a)):txtTips(a.data.msg)}]),appBuilderCtr.controller("PointMallController",["$scope","$rootScope","api","APP_ID","appCache","$state",function(e,t,a,n,i,s){e.userinfo=angular.fromJson(sessionStorage.userinfo),i.get("creditProductsList")?t.creditProductsList=i.get("creditProductsList"):a.get("/api/product/credit",{appId:n,page:1,pageCount:10},function(e){if(e.success){t.creditProductsList=e.content.creditProducts;var a=e.content.creditProducts;a.totalPage=e.content.pager.totalPage,a.currentPage=e.content.pager.currentPage,i.put("creditProductsList",a)}}),e.exchange=function(){e.active?(e.active=!1,t.creditProductsList=i.get("creditProductsList")):e.active||(e.active=!0,a.get("/api/product/credit",{appId:n,page:1,pageCount:10,userId:e.userinfo.userId},function(e){e.success&&(t.creditProductsList=e.content.creditProducts)}))}}]),appBuilderCtr.controller("SearchController",["$scope","api","resData","APP_ID","$rootScope","KillZero",function(e,t,a,n,i,s){function r(a,r){t.get("/api/product/list",{appId:n,order:r,type:i.searchtype,orderType:a,pageCount:10,keyword:e.keyword,page:1},function(e){e.success?(i.searchList=s(e.content.products),console.log(e.content.products)):txtTips("请重试")})}e.tag2=e.tag3=e.tag4=0,e.classnum2=e.classnum3=e.classnum4=1,i.searchtag=0,e.movevalue=0,i.searchtype=1,e.distype="产品",
a.data.success&&(i.searchList=s(a.data.content.products)),e.classnum0=1,e.ml=!1,e.classic=function(t){e.ml=!1,i.searchtype=t,1==t?e.distype="产品":3==t?e.distype="积分":2==t&&(e.distype="促销"),jQuery(document).scrollTop(0),i.currentPage=1,i.searchtag=0,r(i.searchtag)},e.searchKey=function(){jQuery(document).scrollTop(0);var t=null;2==e.movevalue?t="updateTime":4==e.movevalue?t="saleCount":6==e.movevalue&&(t="price"),r(i.searchtag,t)},e.menuActive=function(t){jQuery(document).scrollTop(0),i.currentPage=1;var a=0;0===t?(e.ml=!e.ml,e.movevalue=0):2==t?(e.ml=!1,e.movevalue=t,e.tag2=e.tag2+1,i.searchtag=a=e.classnum2=e.tag2%2,e.classnum4=e.classnum3=1,e.tag4=e.tag3=0,r(i.searchtag,"updateTime")):4==t?(e.ml=!1,e.movevalue=t,e.tag3=e.tag3+1,i.searchtag=a=e.classnum3=e.tag3%2,e.classnum4=e.classnum2=1,e.tag4=e.tag2=0,r(i.searchtag,"saleCount")):6==t&&(e.ml=!1,e.movevalue=t,e.tag4=e.tag4+1,i.searchtag=a=e.classnum4=e.tag4%2,e.classnum3=e.classnum2=1,e.tag3=e.tag3=0,r(i.searchtag,"price"))}}]),appBuilderCtr.controller("LoginController",["$scope","APP_ID","api","$cookies","$state","$stateParams","handleURL","$rootScope","appCache",function(e,t,a,n,i,s,r,o,l){return sessionStorage.userinfo?(sessionStorage.removeItem("reurl"),void i.go("index.find")):(n.remove("username"),n.remove("password"),l.removeAll(),o.startDate=null,o.endDate=null,e.loginValidate=function(){if(e.loginMobile){if(e.loginPassword)return!0;txtTips($filter("translate")("password"))}else txtTips($filter("translate")("phoneNumber"))},void(e.login=function(){e.loginValidate()&&a.get("/api/account/login",{mobile:e.loginMobile,appId:t,password:e.loginPassword,code:r.markValue("code")},function(t){if(txtTips(t.msg),t.success){sessionStorage.setItem("userinfo",angular.toJson(t.content));var a=new Date;if(a.setDate(a.getDate()+7),n.put("username",e.loginMobile,{expires:a}),n.put("password",e.loginPassword,{expires:a}),!t.content.guideId&&"AppUser"==t.content.roleTag)return void i.go("choseguide");if(s.reurl){var r=decodeURIComponent(decodeURIComponent(s.reurl));r.indexOf("http")>-1?location.href=r:i.go(r)}else if(sessionStorage.reurl){if("undefined"!=typeof WeixinJSBridge)return i.go("index.find"),void sessionStorage.removeItem("reurl");location.href=sessionStorage.reurl,sessionStorage.removeItem("reurl")}else history.go(-1)}})}))}]),appBuilderCtr.controller("RegController",["$scope","APP_ID","api","$state","$stateParams",function(e,t,a,n,i){e.getCode=function(){e.regValidate()&&e.code(e.regMobile)},e.checkPhone=function(){e.regMobile&&a.get("/api/account/unregisteredmobile?mobile="+e.regMobile,function(t){1!==t.success&&(txtTips(t.msg),e.regMobile="")})},e.reg=function(){e.regValidate()&&e.regCode&&a.get("/api/account/unregisteredmobile?mobile="+e.regMobile,function(s){s.success?a.post("/api/account/register",{mobile:e.regMobile,appId:t,nickname:e.regNick,password:e.regPass,captcha:e.regCode},function(e){txtTips(e.msg),e.success&&(i.reurl?n.go("login",{reurl:i.reurl}):n.go("login"))}):(txtTips(s.msg),e.regMobile="")})},e.regValidate=function(){if(e.regMobile)if(e.regNick){if(e.regPass)return!0;txtTips("请输入6-12位密码")}else txtTips("请输入2-10位昵称");else txtTips("请输入11位手机号码")}}]),appBuilderCtr.controller("ForgetController",["$scope","api","$state",function(e,t,a){e.checkPhone=function(){e.forgetMobile&&t.get("/api/account/unregisteredmobile?mobile="+e.forgetMobile,function(t){t.success&&(txtTips("手机号未注册"),e.forgetMobile="")})},e.getCode=function(){e.forgetValidate()&&e.code(e.forgetMobile,2)},e.forget=function(){e.forgetValidate()&&e.forgetCode&&t.post("/api/account/backpwd",{mobile:e.forgetMobile,password:e.forgetPass,captcha:e.forgetCode},function(e){txtTips(e.msg),e.success&&a.go("login")})},e.forgetValidate=function(){if(e.forgetMobile){if(e.forgetPass)return!0;txtTips("请输入6-12位密码")}else txtTips("请输入11位手机号")}}]),appBuilderCtr.controller("ProductController",["$scope","$state","appCache","api","APP_ID","KillZero","$rootScope",function(e,t,a,n,i,s,r){jQuery(".list-right").height(jQuery(".dl-body").height()),jQuery(".list-left").css("height",window.innerHeight-window.rem/window.dpr);var o=angular.fromJson(localStorage.app);return e.productLevel=o.productLevel,0===o.productLevel?void t.go("product-list"):(a.get("categoryTop")?(e.categoryTop=a.get("categoryTop"),1==e.productLevel&&(e.hackStyle={height:"1.1rem"},e.topMenu=a.get("categoryTop"),r.productList=a.get("productIndexList"+a.get("categoryTop")[0].id))):n.get("/api/product/category",{appId:i},function(t){t.success&&(e.categoryTop=t.content,a.put("categoryTop",t.content),a.put("categoryChildren0",t.content[0].children),1==e.productLevel&&(e.hackStyle={height:"1.1rem"},e.topMenu=t.content,t.content[0].products=s(t.content[0].products),r.productList=t.content[0].products,a.put("productIndexList"+t.content[0].id,t.content[0].products)))}),e.index=0,e.categorychildren=[],void(e.menuActive=function(t,o){1==e.productLevel?(e.acount=t,a.get("productIndexList"+o)?(r.productList=a.get("productIndexList"+o),r.currentPage=a.get("productIndexList"+o).currentPage,r.totalPage=a.get("productIndexList"+o).totalPage):(r.currentPage=1,r.totalPage=2,n.get("/api/product/list",{appId:i,categoryId:o,page:1,pageCount:10},function(e){e.success&&(e.content.products=s(e.content.products),r.productList=e.content.products,a.put("productIndexList"+o,e.content.products))}))):(e.index=t,void 0===a.get("categoryChildren"+t)?n.get("/api/product/childcategory?appId="+i+"&categoryId="+o,function(n){n.success&&(e.categorychildren[t]=s(n.content),a.put("categoryChildren"+t,e.categorychildren[t]))}):e.categorychildren[t]=a.get("categoryChildren"+t))}))}]),appBuilderCtr.controller("ProductListController",["$scope","appCache","$stateParams","api","APP_ID","$cookies","$rootScope",function(e,t,a,n,i,s,r){t.get("productListCache"+a.id)?r.productList=t.get("productListCache"+a.id):void 0===a.id?n.get("/api/product/list?appId="+i,{page:1,pageCount:10},function(e){e.success&&(r.productList=e.content.products,t.put("productListCache",e.content.products))}):n.get("/api/product/list?appId="+i+"&categoryId="+a.id,{page:1,pageCount:10},function(n){n.success&&(e.listName=a.name,r.productList=n.content.products,t.put("productListCache"+a.id,n.content.products))})}]),appBuilderCtr.controller("ProductDetailController",["$rootScope","$scope","$stateParams","api","$sce","resData","$cookies","$state","APP_ID","appCache","KillZero",function(e,t,a,n,i,s,r,o,l,c,d){function p(e,t){if(sessionStorage.userinfo){if(0===parseInt(t))return void txtTips("数量不能为0");if(!window.hasSize)return void txtTips("没有该规格的产品")}else txtTips("请登录"),o.go("login",{reurl:encodeURIComponent(location.href)});var a=angular.fromJson(sessionStorage.userinfo);n.post("/api/cart/set",{userId:a.userId,appId:l,productId:parseInt(e),number:parseInt(t)||1,tag:1},function(e){txtTips(e.msg),e.success&&txtTips("加入购物车成功")})}jQuery(window).scrollTop(0);var u=s.data.content.specInfo,m=s.data.content.specs.split(","),g=s.data.content.specValues.split(","),f="1件";if(window.hasSize=!0,u){f=" ";for(var h=0;h<u.length;h++)if(currentSpec=m[h],currentSpecValue=g[h],currentSpec==u[h].specId)for(var v=0;v<u[h].specValues.length;v++)currentSpecValue==u[h].specValues[v].specValueId&&(f+=u[h].specValues[v].specValueName+",");f=f.substring(0,f.length-1),f.length>10?f=f.substring(0,9)+"...,1件":f+=",1件"}t.chosedSize=i.trustAsHtml('<span>默认规格</span><span class="chosed">'+f+"</span><i></i>"),e.productSpecs=f.substr(f.length-2,1),s.data.success&&(s.data.content.price&&(s.data.content.price=d(s.data.content.price)),s.data.content.promotionPrice&&(s.data.content.promotionPrice=d(s.data.content.promotionPrice)),t.detail=s.data.content,console.log(t.detail),t.allDetail=i.trustAsHtml(t.detail.detail)),t.addCar=function(){if(!sessionStorage.userinfo)return txtTips("请登录"),void o.go("login",{reurl:location.href});var e=angular.fromJson(sessionStorage.userinfo);if("AppUser"!==e.roleTag)return void txtTips("仅限普通用户操作");var t=jQuery(".count-box");jQuery("body").removeAttr("style"),p(t.data("id")||a.id,t.data("num"))},t.buyNow=function(){if(e.maxcount<e.count||e.maxcount<e.chosedSize||e.maxcount<e.productSpecs)return o.reload("product-detail",{reurl:"product-detail?id="+a.id}),void txtTips("库存不足");if(!window.hasSize)return void txtTips("没有该规格的产品");jQuery("body").removeAttr("style");var t=jQuery(".count-box"),n=angular.fromJson(sessionStorage.userinfo);if(sessionStorage.userinfo){if("AppUser"!==n.roleTag)return void txtTips("仅限普通用户操作");""===n.guideId?(txtTips("请先绑定导购"),o.go("choseguide",{reurl:"product-detail?id="+a.id})):o.go("confirm",{tag:2,productId:t.data("id")||a.id,number:t.data("num")||1})}else txtTips("请登录"),o.go("login",{reurl:location.href})};angular.fromJson(sessionStorage.userinfo);t.hidesendproduct=function(){jQuery("body").removeAttr("style"),jQuery(".show-send-product").css({left:"-10rem"})},n.get("/api/app/info/"+l,function(e){e.success&&localStorage.setItem("app",angular.toJson(e.content))})}]),appBuilderCtr.controller("AllCommentController",["$scope","api","appCache","APP_ID","$stateParams","$rootScope",function(e,t,a,n,i,s){a.get("AllProductComment"+i.id)?s.AllProductComment=a.get("AllProductComment"+i.id):t.get("/api/product/comment",{appId:n,productId:i.id,page:1,pageCount:10},function(e){if(e.success){s.AllProductComment=e.content.comments;var t=e.content.comments;t.totalPage=e.content.pager.totalPage,t.currentPage=e.content.pager.currentPage,t.cnt=e.content.cnt,a.put("AllProductComment"+i.id,t)}})}]),appBuilderCtr.controller("CommunityController",["$scope","$state","api","APP_ID","appCache","$rootScope",function(e,t,a,n,i,s){var r=angular.fromJson(sessionStorage.userinfo),o="undefined"==typeof r?0:r.userId;i.get("communityIndexCache")?s.communityList=i.get("communityIndexCache"):a.get("/api/forum/list?appId="+n+"&userId="+o,{page:1,pageCount:10},function(e){if(e.success){s.communityList=e.content.forums;var t=e.content.forums;t.totalPage=e.content.pager.totalPage,t.currentPage=e.content.pager.currentPage,i.put("communityIndexCache",t)}})}]),appBuilderCtr.controller("CommunitySubController",["$state","$scope","$cookies","appCache","$stateParams","$rootScope","api","APP_ID",function(e,t,a,n,i,s,r,o){n.get("communityListCache"+i.id)?(s.topicsList=n.get("communityListCache"+i.id),console.log(s.topicsList),console.log("$rootScope.topicsList"),t.forumInfo=n.get("communityListInfo"+i.id)):r.get("/api/forum/topics?appId="+o+"&forumId="+i.id,{page:1,pageCount:10,tag:1},function(e){e.success&&(s.topicsList=e.content.topics,s.totalPage=e.content.pager.totalPage,console.log(s.topicsList),console.log("$rootScope.topicsList"),t.forumInfo=e.content.forumInfo,console.log(t.forumInfo),a.put("forumID",t.forumInfo.id),n.put("communityListCache"+i.id,e.content.topics),n.put("communityListInfo"+i.id,e.content.forumInfo))}),t.sendMessage=function(){sessionStorage.userinfo?e.go("community-edit"):e.go("login")}}]),appBuilderCtr.controller("CommunityDetailController",["$scope","resData","$cookies","appCache","$stateParams","$sce","$http","APP_ID","api","$state","handleUserInfo",function(e,t,a,n,i,s,r,o,l,c,d){e.userinfo=angular.fromJson(sessionStorage.userinfo);var p;t.data.success&&(e.detail=t.data.content,console.log(e.detail),console.log("$scope.detail"),e.thumbs="",angular.forEach(t.data.content.thumbs,function(t,a){null!==t.nickname&&a<20&&(e.thumbs+=t.nickname+",")}),t.data.content.thumbs.length>20?e.thumbs=e.thumbs.substring(0,e.thumbs.length-1)+"...":e.thumbs=e.thumbs.substring(0,e.thumbs.length-1),e.word=s.trustAsHtml(e.detail.detail),n.put("communityDetail"+i.id,t),p=t.data.content.forumId),e.discomment=0,l.get("/api/comment/list",{appId:o,resourceType:2,resourceId:e.detail.id},function(t){t.success&&(e.discomment=1,e.detail.commentCount=t.content.comments.length,e.comments=t.content.comments)}),e.sendConment=function(t){console.log(jQuery(".txa").val()),e.communityConment=jQuery(".txa").val();var a=angular.fromJson(sessionStorage.userinfo);return sessionStorage.userinfo?"AppUser"!==a.roleTag?void txtTips("仅限普通用户操作"):e.communityConment?void l.post("/api/comment/publish",{appId:o,resourceType:2,resourceId:t,content:e.communityConment,userId:a.userId},function(e){e.success&&(d.update(),n.remove("myCommunityComment"),n.remove("communityDetail"+i.id),n.remove("communityListCache"+p),n.remove("communityListInfo"+p),c.reload("community-detail",{id:i.id}))}):void txtTips("请输入评论"):(txtTips("请登录"),void c.go("login",{reurl:location.href}))},e.clickZan=function(e){var t=angular.fromJson(sessionStorage.userinfo);return sessionStorage.userinfo?"AppUser"!==t.roleTag?void txtTips("仅限普通用户操作"):void l.post("/api/forum/thumbtopic",{topicId:e,userId:t.userId,appId:o},function(e){e.success&&(n.remove("communityDetail"+i.id),n.remove("communityListCache"+p),n.remove("communityListInfo"+p),c.reload("community-detail",{id:i.id}))}):(txtTips("请登录"),void c.go("login",{reurl:location.href}))}}]),appBuilderCtr.controller("CommunityEditController",["$scope","Upload","$cookies","$state","api","APP_ID","appCache","handleUserInfo",function(e,t,a,n,i,s,r,o){return sessionStorage.userinfo?(e.thumb=[],e.uploadFiles=function(a,n){e.files=a,n[0]&&txtTips("图片大小超过了"+n[0].$errorParam),angular.forEach(a,function(a){a.upload=t.upload({url:"/image/upload?type=5",data:{file:a}}),loader.open(),a.upload.then(function(t){"success"==t.data.status&&(loader.close(),e.hidespan=!0,e.thumb.push({imagePath:t.data.path,imgName:t.config.data.file.name,id:t.data.picKey}))},function(e){console.log("Error status: "+e.status)},function(t){e.progressPercentage=parseInt(100*t.loaded/t.total)})})},e.removeItem=function(t){e.thumb.length>0&&angular.forEach(e.thumb,function(a,n){parseInt(t)==a.id&&e.thumb.splice(n,1),0===e.thumb.length&&(e.hidespan=!1)})},void(e.sub=function(){if(!e.title)return void txtTips("标题不能为空");if(!e.des)return void txtTips("内容不能为空");if(e.thumb.length>9)return void txtTips("图片最多上传9张");var t="";angular.forEach(e.thumb,function(e,a){t=t+","+e.id});var l=angular.fromJson(sessionStorage.userinfo);i.post("/api/forum/create",{appId:s,name:e.title,forumId:a.get("forumID"),userId:l.userId,detail:e.des,albumImages:t.substring(1,t.length)},function(e){e.success&&(txtTips("发布成功"),o.update(),r.remove("communityListCache"+a.get("forumID")),r.remove("communityListInfo"+a.get("forumID")),r.remove("myCommunity"),n.go("community-sublist",{id:a.get("forumID")}))})})):(txtTips("请登录"),void n.go("login"))}]),appBuilderCtr.controller("ArticleController",["$scope","api","APP_ID","appCache","$state",function(e,t,a,n,i){function s(i){i||(i=""),n.get("articleIndexListData"+i)?e.MenuArticleList=n.get("articleIndexListData"+i):t.get("/api/article/list?categoryId="+i+"&appId="+a,function(t){t.success&&(r("articleIndexListData",t,i),e.MenuArticleList=t.content.articles)})}function r(e,t,a){var i={};i=t.content.articles,i.totalPage=t.content.pager.totalPage,i.currentPage=t.content.pager.currentPage,n.put(e+a,i)}jQuery(".article-main").css("min-height",window.innerHeight);var o=angular.fromJson(localStorage.app);if(e.articleLevel=o.articleLevel,e.navindex=0,n.get("articleCategory"))e.navMenu=n.get("articleNavCategory");else{if(0===e.articleLevel)return e.navMenu=[],e.listStyle={"margin-top":"1.2rem"},void(n.get("articleIndexListData")?e.MenuArticleList=n.get("articleIndexListData"):s());t.get("/api/article/category?appId="+a,function(i){i.success&&(e.navMenu=i.content,console.log(e.navMenu),n.put("articleNavCategory",e.navMenu),1==e.articleLevel?(e.listStyle={"margin-top":"1.5rem"},e.MenuArticleList=i.content[0].articles,n.put("articleIndexListData"+i.content[0].id,i.content[0].articles)):2==e.articleLevel?(e.listStyle={"margin-top":"2.5rem"},e.topMenu=i.content[0].children,n.put("articleMenuData"+e.navMenu[0].id,e.navMenu[0].children),t.get("/api/article/list?categoryId="+e.navMenu[0].children[0].id+"&appId="+a,{page:1,pageCount:10},function(t){t.success&&(r("articleIndexListData",t,e.navMenu[0].children[0].id),e.MenuArticleList=t.content.articles)})):3==e.articleLevel&&n.put("articleMenuData"+e.navMenu[0].id,e.navMenu[0].children))})}e.navActive=function(i,o){e.anavcount=i,1==e.articleLevel?n.get("articleIndexListData"+o)?e.MenuArticleList=n.get("articleIndexListData"+o):t.get("/api/article/list",{appId:a,categoryId:o,page:1,pageCount:10},function(t){t.success&&(e.MenuArticleList=t.content.articles,r("articleIndexListData",t,o))}):2==e.articleLevel?(e.acount=0,n.get("articleMenuData"+o)?(e.topMenu=n.get("articleMenuData"+o),s(e.topMenu[0].id)):t.get("/api/article/childcategory?categoryId="+o+"&appId="+a,function(t){if(t.success){if(e.topMenu=t.content,!e.topMenu)return txtTips("没有相应的二级分类"),void(e.MenuArticleList=[]);s(e.topMenu[0].id),n.put("articleMenuData"+o,t.content)}})):3==e.articleLevel&&(n.get("articleMenuData"+o)?e.navdata=n.get("articleMenuData"+o):t.get("/api/article/childcategory?categoryId="+o+"&appId="+a,function(t){t.success&&(e.navdata=[],t.content&&(e.navdata=t.content,n.put("articleMenuData"+o,t.content)))}))},e.menuActive=function(t,a){e.acount=t,s(a)},e.goArticle=function(t){console.log("文章ID："+t),2==e.articleLevel?i.go("article-detail",{id:t}):i.go("article-list",{id:t})}}]),appBuilderCtr.controller("ArticleListController",["$scope","api","APP_ID","appCache","resData","$stateParams",function(e,t,a,n,i,s){i.data.success&&(e.listData=i.data.content.articles,e.listName=s.name,n.put("articleList"+s.id,i))}]),appBuilderCtr.controller("ArticleDetailController",["$scope","api","APP_ID","appCache","$stateParams","resData","$sce","$state","$http",function(e,t,a,n,i,s,r,o,l){s.data.success&&(e.detail=s.data.content,e.word=r.trustAsHtml(e.detail.detail)),e.discomment=0,t.get("/api/comment/list",{appId:a,resourceType:1,resourceId:e.detail.id},function(t){t.success&&(e.discomment=1,e.detail.commentCount=t.content.comments.length,e.comments=t.content.comments)}),e.tips=function(){if(null===sessionStorage.getItem("userinfo"))return txtTips("评论需要登录"),void o.go("login",{reurl:location.href})},e.sendConment=function(s){var r=angular.fromJson(sessionStorage.userinfo);return e.articleConment?"AppUser"!==r.roleTag?void txtTips("仅限普通用户操作"):void t.post("/api/comment/publish",{appId:a,resourceType:1,resourceId:s,content:e.articleConment,userId:r.userId},function(e){e.success&&(n.remove("myArticleComment"),o.reload("article-detail",{id:i.id}))}):void txtTips("请输入评论")}}]),appBuilderCtr.controller("MessageController",["$state","$scope","api","APP_ID","resData","appCache","$stateParams",function(e,t,a,n,i,s,r){t.userinfo=angular.fromJson(sessionStorage.userinfo),jQuery(".message-total").css("height",window.innerHeight),i.data.success&&(t.messageTotal=i.data.content,t.leftWidth=0),angular.forEach(t.messageTotal,function(e){e.updateTime&&(e.updateTime=e.updateTime.substring(0,10))}),t.scrollleft=function(e){console.log(e),1==e?t.leftWidth1=-1.7:2==e?t.leftWidth2=-1.7:3==e&&(t.leftWidth3=-1.7)},t.scrollright=function(e){1==e?t.leftWidth1=0:2==e?t.leftWidth2=0:3==e&&(t.leftWidth3=0)},t.deleteMessage=function(i){a.get("/api/account/deletemessage",{resourceType:i,appId:n,userId:t.userinfo.userId},function(t){t.success&&e.reload("message")})}}]),appBuilderCtr.controller("MessageListController",["$state","$scope","api","APP_ID","appCache","$stateParams",function(e,t,a,n,i,s){var r=angular.fromJson(sessionStorage.userinfo);t.resourceType=s.resourceType,jQuery(".List").css("height",window.innerHeight),a.get("/api/account/messages",{appId:n,userId:r.userId,resourceType:s.resourceType},function(e){t.messageList=e.content.messages,angular.forEach(t.messageList,function(e){e.updateTime&&(e.updateTime=e.updateTime.substring(0,10))})})}]),appBuilderCtr.controller("MineController",["$scope","$state","api","APP_ID","$cookies","appCache","$rootScope",function(e,t,a,n,i,s,r){function o(){var e=new Date,t=e.getHours(),a=e.getMinutes();return t<10?t="0"+t.toString():a<10&&(a="0"+a.toString()),t+":"+a}function l(t){"BranchAdmin"==e.userinfo.roleTag?s.get("roleRecords")?(r.records=s.get("roleRecords"),r.sum=s.get("roleRecords").sum,e.roleUpdateTime=o(),e.tag=r.tag):a.get("/api/order/list",{type:2,userId:e.userinfo.userId,appId:n,tag:1,payState:t||-1,page:1,pageCount:10,timeEnd:r.timeEnd,timeStart:r.timeStart},function(t){if(t.success){r.records=t.content.orders,r.sum=t.content.sum;var a=t.content.orders;a.sum=t.content.sum,a.currentPage=t.content.currentPage,a.totalPage=t.content.totalPage,s.put("roleRecords",a),e.roleUpdateTime=o(),e.tag=1}}):"CommonUser"!==e.userinfo.group&&(s.get("roleRecords")?(r.records=s.get("roleRecords"),r.sum=s.get("roleRecords").sum,e.roleUpdateTime=o()):a.get("/api/account/deduct",{userId:e.userinfo.userId,appId:n,page:1,pageCount:10,timeEnd:r.timeEnd,timeStart:r.timeStart},function(t){if(t.success){r.records=t.content.records,r.sum=t.content.sum;var a=t.content.records;a.sum=t.content.sum,a.currentPage=t.content.pager.currentPage,a.totalPage=t.content.pager.totalPage,s.put("roleRecords",a),e.roleUpdateTime=o(),e.tag=1}}))}if($(window).scrollTop(0),!sessionStorage.userinfo)return void t.go("login");e.userinfo=angular.fromJson(sessionStorage.userinfo);var c=angular.fromJson(localStorage.app);e.isPush=c.isPush,console.log(c),e.dismine=1,jQuery(".mine-main").css("min-height",jQuery(window).height()-jQuery("footer").height()),a.get("/api/account/userinfo",{appId:n,userId:e.userinfo.userId},function(t){t.success&&(e.userinfo=t.content,sessionStorage.userinfo=angular.toJson(t.content))}),e.app=angular.fromJson(localStorage.app),l(),e.goGuide=function(){e.userinfo.guideId?t.go("myguide"):t.go("choseguide")},e.out=function(){confirm("确定退出吗？")&&(sessionStorage.clear(),i.remove("username"),i.remove("password"),s.removeAll(),r.startDate=null,r.endDate=null,t.go("index.find"),console.log("退出成功"))},e.clearTime=function(){r.startDate=0,r.endDate=0,r.timeStart=null,r.timeEnd=null,r.sum=null,s.remove("roleRecords"),l(r.payState)}}]),appBuilderCtr.controller("MyOrderController",["$scope","$state","api","APP_ID","appCache","$rootScope","ResetMyOrderData","KillZero",function(e,t,a,n,i,s,r,o){function l(e,i,s,o,l,c){WeixinJSBridge.invoke("getBrandWCPayRequest",{appId:e,timeStamp:i,nonceStr:s,package:o,signType:"MD5",paySign:l},function(e){txtTips(e),a.post("/api/public/error",{appId:n,message:e}),"get_brand_wcpay_request:ok"==e.err_msg&&(r._delete(),t.go("order-detail",{id:c}))})}sessionStorage.userinfo||(txtTips("请登录"),t.go("login")),e.userinfo=angular.fromJson(sessionStorage.getItem("userinfo")),i.get("myOrder-1")?s.myOrder=i.get("myOrder-1"):a.get("/api/order/list",{userId:e.userinfo.userId,appId:n,payState:-1,page:1,pageCount:10},function(e){if(e.success){var t=e.content.orders;t.totalPage=e.content.pager.totalPage,t.currentPage=e.content.pager.currentPage,i.put("myOrder-1",t),s.myOrder=e.content.orders,console.log(s.myOrder)}}),e.topnum=1,e.topMenu=[{name:"全部",id:-1},{name:"未支付",id:0},{name:"已支付",id:1},{name:"支付失败",id:2},{name:"已发货",id:3},{name:"货到付款",id:4},{name:"已取消",id:5},{name:"已完成",id:6}],e.menuActive=function(t,r){jQuery(document).scrollTop(0),e.acount=t,s.myOrder=[],i.get("myOrder"+r)?s.myOrder=i.get("myOrder"+r):a.get("/api/order/list",{userId:e.userinfo.userId,appId:n,payState:r,page:1,pageCount:10},function(e){if(e.success){var t=e.content.orders;t.totalPage=e.content.pager.totalPage,t.currentPage=e.content.pager.currentPage,i.put("myOrder"+r,t),s.myOrder=e.content.orders}})},e.orderComfirm=!1,e.takeGoods=function(n){e.orderComfirm=!e.orderComfirm,console.log(e.orderComfirm),a.post("/api/order/updatestate",{orderId:n,toState:6,userId:e.userinfo.userId},function(e){e.success&&(r._delete(),t.reload("myOrder"))})},e.deleteGoods=function(n){a.post("/api/order/delete",{orderId:n,toState:5,userId:e.userinfo.userId},function(e){e.success&&(r._delete(),t.reload("myOrder"))})},e.cancelOrder=function(n){a.post("/api/order/updatestate",{orderId:n,toState:5,userId:e.userinfo.userId},function(e){txtTips(e.msg),1==e.success&&(r._delete(),t.reload("myOrder"))})},e.goConfirm=function(n){var i=e.myOrder[n];console.log(i),a.post("/api/order/pay",{orderId:i.id,payType:i.payType,fromType:i.fromType},function(e){if(txtTips(e.msg),2==i.payType)if("undefined"==typeof WeixinJSBridge)document.addEventListener?document.addEventListener("WeixinJSBridgeReady",l,!1):document.attachEvent&&(document.attachEvent("WeixinJSBridgeReady",l),document.attachEvent("onWeixinJSBridgeReady",l));else{var a=e.content.data.appId,n=e.content.data.timeStamp,s=e.content.data.nonceStr,o=e.content.data.package,c=e.content.data.paySign;l(a,n,s,o,c)}else{if(5==i.payType)return void t.go("qrcode",{src:e.content.data.billQRCodePath,id:i.id});r._delete(),t.go("order-detail",{id:i.id})}})},e.takeComments=function(e){t.go("takecomments",{orderId:e})}}]),appBuilderCtr.controller("OrderDetailController",["$rootScope","$scope","appCache","resData","$stateParams","api","$state","ResetMyOrderData","KillZero","$interval",function(e,t,a,n,i,s,r,o,l,c){function d(e,t,a,n,i,l){WeixinJSBridge.invoke("getBrandWCPayRequest",{appId:e,timeStamp:t,nonceStr:a,package:n,signType:"MD5",paySign:i},function(e){txtTips(e),s.post("/api/public/error",{appId:APP_ID,message:e}),"get_brand_wcpay_request:ok"==e.err_msg&&(o._delete(),r.reload("order-detail",{id:l}))})}var p=angular.fromJson(sessionStorage.userinfo);n.data.success&&(n.data.content.details=l(n.data.content.details),n.data.content.info=l(n.data.content.info),t.order=n.data.content,t.number=t.order.details[0].number,t.haveComment=t.order.details[0].haveComment),console.log(n.data.content),console.log("resData.data.content"),null!==t.order.info.remark&&"null"!==t.order.info.remark||(t.order.info.remark="无备注"),null!==t.order.info.shippingCode&&"null"!==t.order.info.shippingCode||(t.order.info.shippingCode=""),console.log(t.order.info),console.log("$scope.order.info"),t.repay=function(e,t){s.post("/api/order/pay",{orderId:e,payType:t,fromType:2},function(a){if(txtTips(a.msg),2==t)if("undefined"==typeof WeixinJSBridge)document.addEventListener?document.addEventListener("WeixinJSBridgeReady",d,!1):document.attachEvent&&(document.attachEvent("WeixinJSBridgeReady",d),document.attachEvent("onWeixinJSBridgeReady",d));else{var n=a.content.data.appId,i=a.content.data.timeStamp,s=a.content.data.nonceStr,l=a.content.data.package,c=a.content.data.paySign;d(n,i,s,l,c,e)}else{if(5==t)return void r.go("qrcode",{src:a.content.data.billQRCodePath,id:e});o._delete(),r.reload("order-detail",{id:e})}})},t.cancelOrder=function(e){s.post("/api/order/updatestate",{orderId:e,toState:5,userId:p.userId},function(e){txtTips(e.msg),e.success&&(o._delete(),a.remove("orderDetail"+i.id),r.reload("order-detail",{id:i.id}))})},t.orderComfirm=!1,t.takeGoods=function(e){t.orderComfirm=!t.orderComfirm,s.post("/api/order/updatestate",{orderId:e,toState:6,userId:p.userId},function(e){e.success&&(o._delete(),a.remove("orderDetail"+i.id),r.reload("order-detail",{id:i.id}))})},t.deleteGoods=function(e){s.post("/api/order/delete",{orderId:e,toState:5,userId:p.userId},function(e){e.success&&(o._delete(),r.go("myOrder"))})},t.takeComments=function(t){e.comment=!0,r.go("takecomments",{orderId:t}),console.log("123456"),console.log(e.comment)}}]),appBuilderCtr.controller("TakeCommentsController",["$scope","api","$stateParams","appCache","resData",function(e,t,a,n,i){e.list=i.data.content.details,console.log(e.list)}]),appBuilderCtr.controller("GuideController",["$scope","api","APP_ID","resData","appCache","$stateParams",function(e,t,a,n,i,s){null===sessionStorage.getItem("userinfo")&&(txtTips("请登录"),$state.go("login")),e.userinfo=angular.fromJson(sessionStorage.userinfo),n.data.success&&(n.data.content.branches?(e.branchList=n.data.content.branches,i.put("branchList",n)):n.data.content.guideId&&(e.guideInfo=n.data.content)),i.get("problemsData")?e.problemsData=i.get("problemsData"):t.get("/api/public/problems",{appId:a},function(t){t.success&&(e.problemsData=t.content.problems,i.put("problemsData",t.content.problems))})}]),appBuilderCtr.controller("ProblemDetailController",["appCache","$scope","$stateParams","$sce",function(e,t,a,n){var i=e.get("problemsData");console.log("data"),console.log(i),console.log("data11"),angular.forEach(i,function(e,i){e.id==a.id&&(t.detail=n.trustAsHtml(e.detail))})}]),appBuilderCtr.controller("MyCommunityController",["$scope","api","APP_ID","appCache","$rootScope",function(e,t,a,n,i){null===sessionStorage.getItem("userinfo")&&(txtTips("请登录"),$state.go("login")),e.userinfo=angular.fromJson(sessionStorage.getItem("userinfo")),e.discuzactive=!0,console.log(e.userinfo),e.exchange=function(){i.currentPage=1,i.totalPage=2,e.discuzactive?(e.discuzactive=!1,n.get("myCommunityComment")?i.myCommunity=n.get("myCommunityComment"):t.get("/api/comment/mine",{appId:a,userId:e.userinfo.userId,tag:2,page:1,pageCount:10},function(e){if(e.success){i.myCommunity=e.content.comments;var t=e.content.comments;t.totalPage=e.content.pager.totalPage,t.currentPage=e.content.pager.currentPage,n.put("myCommunityComment",t)}})):(e.discuzactive=!0,i.myCommunity=n.get("myCommunity"))},n.get("myCommunity")?i.myCommunity=n.get("myCommunity"):t.get("/api/forum/topics",{page:1,tag:2,pageCount:10,appId:a,userId:e.userinfo.userId},function(e){var t=e.content.topics;t.totalPage=e.content.pager.totalPage,t.currentPage=e.content.pager.currentPage,n.put("myCommunity",t),i.myCommunity=e.content.topics})}]),appBuilderCtr.controller("MyCommentController",["$scope","api","APP_ID","appCache","$rootScope",function(e,t,a,n,i){null===sessionStorage.getItem("userinfo")&&(txtTips("请登录"),$state.go("login")),e.userinfo=angular.fromJson(sessionStorage.userinfo),e.commentactive=!0,e.exchange=function(){e.commentactive?(e.commentactive=!1,n.get("myArticleComment")?i.myArticleComment=n.get("myArticleComment"):t.get("/api/comment/mine",{page:1,pageCount:10,appId:a,tag:1,userId:e.userinfo.userId},function(e){var t=e.content.comments;t.totalPage=e.content.pager.totalPage,t.currentPage=e.content.pager.currentPage,n.put("myArticleComment",t),i.myArticleComment=e.content.comments})):(e.commentactive=!0,i.myProductComment=n.get("myProductComment"))},n.get("myProductComment")?i.myProductComment=n.get("myProductComment"):t.get("/api/comment/mine",{page:1,pageCount:10,appId:a,tag:3,userId:e.userinfo.userId},function(e){var t=e.content.comments;t.totalPage=e.content.pager.totalPage,t.currentPage=e.content.pager.currentPage,n.put("myProductComment",t),i.myProductComment=e.content.comments})}]),appBuilderCtr.controller("MineSetController",["$scope","api","APP_ID","$state","Upload","$cookies","appCache","$rootScope",function(e,t,a,n,i,s,r,o){e.userinfo=angular.fromJson(sessionStorage.userinfo),t.get("/api/account/ranks?appId="+a+"&userId="+e.userinfo.userId,function(t){t.success&&(e.ranks=t.content.ranks)}),e.out=function(){confirm("确定退出吗？")&&(s.remove("username"),s.remove("password"),sessionStorage.clear(),r.removeAll(),o.startDate=null,o.endDate=null,n.go("index.find"),console.log("退出成功"))},null===sessionStorage.getItem("userinfo")&&(txtTips("请登录"),n.go("login")),e.userinfo=angular.fromJson(sessionStorage.userinfo),e.uploadFiles=function(n,s){s[0]&&txtTips(s[0].name+"的大小超过了"+s[0].$errorParam),angular.forEach(n,function(n){n.upload=i.upload({url:"/image/upload?type=1",data:{file:n}}),loader.open(),n.upload.then(function(n){"success"==n.data.status&&(loader.close(),e.userinfo.imagePath=n.data.path,t.post("/api/account/update",{userId:e.userinfo.userId,appId:a,coverId:n.data.picKey},function(t){t.success&&(txtTips("头像修改成功"),e.userinfo.coverId=n.data.picKey,sessionStorage.setItem("userinfo",angular.toJson(e.userinfo)))}))},function(e){console.log("Error status: "+e.status)},function(t){e.progressPercentage=parseInt(100*t.loaded/t.total)})})},e.showInput=function(){e.nickInput=1},e.hideInput=function(){e.nickInput=0,e.userinfo.nickname=e.newNick,t.post("/api/account/update",{userId:e.userinfo.userId,appId:a,nickname:e.newNick},function(t){t.success&&(sessionStorage.setItem("userinfo",angular.toJson(e.userinfo)),txtTips("昵称修改成功"))})}}]),appBuilderCtr.controller("MyMemberController",["$scope","appCache","$state","api","$rootScope",function(e,t,a,n,i){
var s=angular.fromJson(sessionStorage.userinfo);t.get("mymembers")?(i.members=t.get("mymembers"),e.totalMembers=i.members.cnt):n.get("/api/account/users",{userId:s.userId,page:1,pageCount:10},function(a){if(a.success){i.members=a.content.users,e.totalMembers=a.content.cnt;var n=a.content.users;n.totalPage=a.content.pager.totalPage,n.currentPage=a.content.pager.currentPage,n.cnt=a.content.cnt,t.put("mymembers",n)}})}]),appBuilderCtr.controller("AppSetController",["$scope","appCache","$state",function(e,t,a){e.appCacheSize=t.info(),e.appInfo=angular.fromJson(localStorage.app),e.removeAppCache=function(){confirm("确定清除缓存吗？")&&(t.removeAll(),a.reload("appset"))}}]),appBuilderCtr.controller("GrowthController",["$scope","api","APP_ID","$rootScope","$state",function(e,t,a,n,i){null===sessionStorage.getItem("userinfo")&&(txtTips("请登录"),i.go("login")),e.userinfo=angular.fromJson(sessionStorage.userinfo),t.get("/api/account/ranks?appId="+a+"&userId="+e.userinfo.userId,function(t){if(t.success){e.growth=t.content.ranks,e.nextRankNeedScore=t.content.nextRankNeedScore,e.userGrowth=e.userinfo.growthScore;var a=0;e.onewidth=parseFloat(9.2/e.growth.length).toFixed(1),angular.forEach(e.growth,function(t,n){console.log(t),e.userGrowth>=t.startCredit&&(a+=1)}),e.growthIndex=a,e.userLevel=a,e.previousLevelGrowth=e.growth[e.growthIndex-1].startCredit,e.growth.length<=a?(e.growthLength=9.2,e.nextLevelGrowth=e.previousLevelGrowth,e.userLevel=e.userLevel-1,console.log(e.userLevel)):(e.nextLevelGrowth=e.growth[e.growthIndex].startCredit,e.growthLength=((e.userGrowth-e.previousLevelGrowth)/(e.nextLevelGrowth-e.previousLevelGrowth)+e.growthIndex)*e.onewidth)}}),t.get("/api/account/creditrecord",{appId:a,userId:e.userinfo.userId,page:1,pageCount:10,type:1},function(e){e.success&&(n.creditRecordList=e.content.records)})}]),appBuilderCtr.controller("MyPointController",["appCache","$scope","APP_ID","api","$rootScope",function(e,t,a,n,i){null===sessionStorage.getItem("userinfo")&&(txtTips("请登录"),$state.go("login")),t.userinfo=angular.fromJson(sessionStorage.userinfo),e.get("myPointRecords")?i.pointRecords=e.get("myPointRecords"):n.get("/api/account/creditrecord",{userId:t.userinfo.userId,appId:a,type:0,page:1,pageCount:10},function(t){if(t.success){var a=t.content.records;a.totalPage=t.content.pager.totalPage,a.currentPage=t.content.pager.currentPage,e.put("myPointRecords",a),i.pointRecords=a}})}]),appBuilderCtr.controller("AddressController",["$scope","api","APP_ID","$stateParams","$state",function(e,t,a,n,i){null===sessionStorage.getItem("userinfo")&&(txtTips("请登录"),i.go("login")),e.userinfo=angular.fromJson(sessionStorage.userinfo),jQuery(".list").css("height",window.innerHeight-window.rem/window.dpr*3),sessionStorage.useraddress?e.address=angular.fromJson(sessionStorage.useraddress):void 0===sessionStorage.useraddress&&t.get("/api/account/address/"+e.userinfo.userId,function(t){if(t.success){if(void 0===t.content)return;0===t.content.length&&txtTips("点击新增地址"),e.address=t.content,sessionStorage.setItem("useraddress",angular.toJson(t.content))}}),e.scrollleft=function(e){jQuery("ul li:nth-child("+(e+1)+")").css("margin-left","-1.87rem")},e.scrollright=function(e){jQuery("ul li:nth-child("+(e+1)+")").css("margin-left",0)},e.deleteAdd=function(a){t.get("/api/account/deleteaddress",{userId:e.userinfo.userId,addressId:a},function(e){sessionStorage.removeItem("useraddress"),i.reload("address")})},e.handleAddress=function(t,a){1==n.tag?(sessionStorage.setItem("consignee",angular.toJson(e.address[t])),location.href=decodeURIComponent(decodeURIComponent(n.reurl)),console.log(!n.tag)):2!=n.tag&&n.tag?sessionStorage.reurl&&(sessionStorage.setItem("consignee",angular.toJson(e.address[t])),location.href=angular.fromJson(sessionStorage.reurl)):i.go("plus-address",{id:a})},e.plusadd=function(){i.go("plus-address",{reurl:n.reurl})}}]),appBuilderCtr.controller("PlusAddressController",["$scope","api","APP_ID","appCache","$state","$stateParams",function(e,t,a,n,i,s){if(null===sessionStorage.getItem("userinfo")&&(txtTips("请登录"),i.go("login")),e.userinfo=angular.fromJson(sessionStorage.userinfo),n.get("proData")?e.prodata=n.get("proData"):t.get("/api/public/provincecityareaitems?parentId=0",function(t){t.success&&(e.prodata=t.content,n.put("proData",t.content))}),s.id){e.title="修改收货地址";var r=angular.fromJson(sessionStorage.useraddress);angular.forEach(r,function(t,a){s.id==t.id&&(e.name=t.consignee,e.mobile=t.mobile,e.proName=t.province,e.cityName=t.city,e.areaName=t.area,e.proID=t.provinceId,e.cityID=t.cityId,e.areaId=t.areaId,e.detailPart=t.detail,e.postCode=t.postcode)})}e.set=function(t){void 0===t?e.flag=!e.flag:1==t&&(e.flagPart=!e.flagPart),e.style={height:window.innerHeight}},e.saveAdd=function(){11!==e.mobile.length?txtTips("请输入11位手机号码"):t.post("/api/account/addaddress",{userId:e.userinfo.userId,consignee:e.name,provinceId:e.proID,cityId:e.cityID,areaId:e.areaID,detail:e.detailPart,mobile:e.mobile,postcode:e.postCode,addressId:s.id},function(e){txtTips(e.msg),e.success&&(s.id||!s.reurl?i.go("address",{tag:2}):i.go("address",{reurl:s.reurl,tag:1}),sessionStorage.removeItem("useraddress"))})}}]),appBuilderCtr.controller("AboutUsController",["$scope","resData","APP_ID","$state","appCache","$sce",function(e,t,a,n,i,s){t.data.success&&(e.us=s.trustAsHtml(t.data.content),i.put("aboutus",t))}]),appBuilderCtr.controller("ResetController",["$scope","api","$cookieStore","$state","appCache","$rootScope","$cookies",function(e,t,a,n,i,s,r){sessionStorage.userinfo||(txtTips("请登录"),n.go("login")),e.reset=function(){e.resetValidate()&&t.post("/api/account/modifypwd",{userId:angular.fromJson(sessionStorage.userinfo).userId,passwordNew:e.resetPassword,passwordOld:e.resetOldpassword},function(e){txtTips(e.msg),e.success&&n.go("mineset")})},e.resetValidate=function(){if(e.resetOldpassword){if(e.resetPassword)return!0;txtTips("请输入6-12位新密码")}else txtTips("请输入6-12位旧密码")}}]),appBuilderCtr.controller("MapHeightController",["$scope",function(e){e.setMapheight=function(){var e=0;jQuery.each(jQuery("#map").siblings(),function(t,a){e+=parseInt(jQuery(a).height())}),jQuery("#map").css({height:window.innerHeight-e-10,width:"10rem"})}}]),appBuilderCtr.controller("SuggestController",["$scope","resData","APP_ID","$state","api",function(e,t,a,n,i){t.data.success&&t.data.content&&(e.msg=t.data.content),null===sessionStorage.getItem("userinfo")&&(txtTips("请登录"),n.go("login")),e.userinfo=angular.fromJson(sessionStorage.userinfo),e.suggest=function(){return void 0===e.content||""===e.content?void txtTips("请输入内容"):void i.post("/api/account/createadvice",{userId:e.userinfo.userId,appId:a,content:e.content},function(e){txtTips(e.msg),e.success&&n.reload("suggest")})}}]),appBuilderCtr.controller("CarController",["$scope","resData","APP_ID","$state","$rootScope","$stateParams","KillZero",function(e,t,a,n,i,s,r){e.type=s.type,1==e.type?e.carclassic="产品":2==e.type&&(e.carclassic="积分商城"),e.userinfo=angular.fromJson(sessionStorage.userinfo),console.log(e.userinfo.roleTag==e.AppUser),console.log(e.userinfo),i.cartProducts=r(t.data.content.cartProducts)}]),appBuilderCtr.controller("ConfirmController",["$filter","$stateParams","api","APP_ID","resData","$scope","$state","appCache","KillZero","handleURL","$rootScope","$interval",function(e,t,a,n,i,s,r,o,l,c,d,p){function u(){return"RMB"!==s.order.currency?void(s.shippingfee=0):void a.get("/api/public/shippingfee",{appId:n,provinceId:s.consignee.provinceId},function(t){if(t.success){s.productsTotalNum=0;var a=t.content;angular.forEach(s.order.products,function(e,t){s.productsTotalNum+=e.number}),console.log("产品总数量："+s.productsTotalNum),s.shippingfee=parseFloat(a.price)+(s.productsTotalNum-1)*parseFloat(a.addPrice),console.log("总运费："+s.shippingfee),s.totalPrice=e("number")(parseFloat(s.shippingfee+s.order.totalPrice),2),console.log("订单总金额："+s.totalPrice),s.sendway="快递"}else txtTips(t.msg),s.consignee=null,sessionStorage.removeItem("consignee")})}if(0===i.data.success)return txtTips(i.data.msg),void history.go(-1);sessionStorage.getItem("userinfo")||(txtTips("请登录"),r.go("login"));var m=angular.fromJson(sessionStorage.userinfo),g=angular.fromJson(localStorage.app);s.order=i.data.content,s.totalPrice=e("number")(s.order.totalPrice,2),console.log(s.totalPrice),s.spendCredits=0,angular.forEach(i.data.content.products,function(e,t){s.spendCredits+=e.spendCredits*e.number}),s.spendCredits>m.credits&&(s.spendCredits=m.credits),console.log("产品可用积分："+s.spendCredits),s.toMoney=s.spendCredits/g.creditRate,s.toMoney>s.order.totalPrice&&(s.toMoney=s.order.totalPrice,s.spendCredits=s.toMoney*g.creditRate),console.log("可抵扣的现金："+s.toMoney),sessionStorage.consignee?(s.consignee=angular.fromJson(sessionStorage.consignee),u()):a.get("/api/account/address/"+m.userId,function(e){if(e.success){if(!e.content)return void txtTips("请先添加一个收货地址");sessionStorage.consignee=angular.toJson(e.content[0]),s.consignee=e.content[0],u()}}),s.goAddress=function(){r.go("address",{tag:1,reurl:encodeURIComponent(location.href)})},s.toCash=function(){if(s.tomoneyflag=!s.tomoneyflag,s.tomoneyflag){var t=s.order.totalPrice-s.toMoney;if(t<0)return void(s.totalPrice=s.shippingfee);s.totalPrice=e("number")(parseFloat(s.order.totalPrice-s.toMoney+s.shippingfee),2)}else s.totalPrice=e("number")(parseFloat(s.order.totalPrice+s.shippingfee),2)};var f=angular.fromJson(localStorage.app).yuedanPay;0===f?c.markValue("code")?s.wx=!0:s.wx=!1:1==f&&(s.wx=!0),localStorage.payWay?(s.paytype=localStorage.payWay,s.payWay=localStorage.payWayWord):"undefined"==typeof WeixinJSBridge&&0===f?(s.payWay=e("translate")("cashOnDelivery"),s.paytype=3):(s.payWay=e("translate")("weChatPayment"),s.paytype=2),s.pay=function(e){localStorage.payWay=e,s.paytype=e,2==e?s.payWay="微信支付":3==e&&(s.payWay="货到付款"),localStorage.payWayWord=s.payWay},s.sendOrder=function(e){if(!s.consignee)return void txtTips("请选择收货地址");if(void 0===s.paytype)return void txtTips("请选择支付方式");var i=Date.parse(new Date);console.log(t.tag),a.post("/api/order/create?creattime="+i,{userId:m.userId,appId:n,tag:t.tag,payType:s.paytype,shippingAddress:s.consignee.id,cartIds:t.cartIds,cartType:t.cartType,remark:s.remark,productId:t.productId,number:t.number,fromType:2,spendCredit:s.tomoneyflag?s.spendCredits:0,openId:m.openId||null},function(e){function t(e,t,i,s,o){WeixinJSBridge.invoke("getBrandWCPayRequest",{appId:e,timeStamp:t,nonceStr:i,package:s,signType:"MD5",paySign:o},function(e){txtTips(e),a.post("/api/public/error",{appId:n,message:e}),"get_brand_wcpay_request:ok"==e.err_msg&&r.go("myOrder")})}if(txtTips(e.msg),e.success){if(o.removeAll(),2==s.paytype)if("undefined"==typeof WeixinJSBridge){if(e.content.data.billQRCodePath)return void r.go("qrcode",{src:e.content.data.billQRCodePath,id:e.content.orderId});document.addEventListener?document.addEventListener("WeixinJSBridgeReady",t,!1):document.attachEvent&&(document.attachEvent("WeixinJSBridgeReady",t),document.attachEvent("onWeixinJSBridgeReady",t))}else{if(!localStorage.wxid&&WeixinJSBridge){var i=e.content.data.billQRCode;return void(location.href=i)}var l=e.content.data.appId,c=e.content.data.timeStamp,d=e.content.data.nonceStr,p=e.content.data.package,u=e.content.data.paySign;t(l,c,d,p,u)}else r.go("order-detail",{id:e.content.orderId});sessionStorage.removeItem("consignee")}})}}]),function(){"use strict";function e(e,t,a,n,i,s,r){e.src=t.src;var o=t.id;i.stop=a(function(){n.get("/api/order/detail/"+o,{norealParam:1},function(e){if(e.success){var t=e.content.info.payState;1!=t&&2!=t||(s.go("order-detail",{id:o}),a.cancel(i.stop),r.removeAll())}},"noloader")},2e3)}e.$inject=["$scope","$stateParams","$interval","api","$rootScope","$state","appCache"],appBuilderCtr.controller("QrCodeController",e),e.inject=["$scope","$stateParams","$interval","api","$rootScope","$state","appCache"]}(),appBuilderCtr.controller("CalendarController",["$scope","appCache","$rootScope",function(e,t,a){function n(){a.startDate&&a.endDate&&(e._startMonth=a.startDate.split("-")[1],e._startDay=a.startDate.split("-")[2],e._endMonth=a.endDate.split("-")[1],e._endDay=a.endDate.split("-")[2])}function i(e){for(var t=[],a=0;a<e;a++)t[a]=a+1;return t}if(t.get("calendar"))return e.month=t.get("calendar"),void n();var s=new Date,r=s.getFullYear(),o=[31,0,31,30,31,30,31,31,30,31,30,31],l=[],c=[];r%400===0||r%4===0&&r%100!==0?o[1]=29:o[1]=28;for(var d=0;d<12;d++){var p=new Date(r,d,1);l[d]=p.getDay()}for(var u=0;u<12;u++)o[u]=i(o[u]),l[u]=i(l[u]);for(var m=0;m<12;m++){for(var g=l[m],f=[],h=0;h<l[m].length;h++)f[h]=g[h].toString().replace(/\d/g," ");c[m]=f}for(var v=0;v<12;v++)o[v]=c[v].concat(o[v]);e.month=o,n(),t.put("calendar",o)}]),appBuilder.directive("rheader",function(){return{restrict:"AE",replace:!0,templateUrl:viewSrc+"partials/header.html",link:function(e,t,a,n){var i=angular.fromJson(localStorage.app);e.isBranch=i.isBranch,e.isPromotionProduct=i.isPromotionProduct,e.isCreditProduct=i.isCreditProduct}}}),appBuilder.directive("rfooter",function(){return{restrict:"AE",replace:!0,scope:{productlink:"@",articlelink:"@"},templateUrl:viewSrc+"partials/footer.html",link:function(e,t,a,n){var i=angular.fromJson(localStorage.app);e.isForum=i.isForum}}}),appBuilder.directive("rhomefooter",function(){return{restrict:"AE",replace:!0,scope:{homelink:"@"},templateUrl:viewSrc+"partials/home-footer.html",link:function(e,t,a,n){var i=angular.fromJson(localStorage.app);e.isForum=i.isForum}}}),appBuilder.directive("product",["$interval","$state",function(e,t){return{restrict:"AE",replace:!0,scope:{start:"@",end:"@",status:"@",summary:"@"},templateUrl:viewSrc+"partials/saleProduct.html",link:function(a,n,i,s){a.start>0?a.time=e(function(){a.start?(a.second=parseInt(a.start%60),a.minute=parseInt(parseInt(a.start/60)%60),a.hour=parseInt(parseInt(a.start/3600)%24),a.day=parseInt(a.start/3600/24),0===a.hour&&0===a.minute&&0===a.second&&(a.day=a.day-1,a.hour=23,a.minute=59,a.second=59),0===a.minute&&0===a.second&&(a.hour=a.hour-1,a.minute=59,a.second=59),0===a.second&&(a.minute=a.minute-1,a.second=59),a.second<10&&(a.second="0"+a.second),a.minute<10&&(a.minute="0"+a.minute),a.hour<10&&(a.hour="0"+a.hour)):(a.day=0,a.hour=0,a.minute=0,a.second=0),a.start=a.start-1,a.start<0&&(e.cancel(a.time),t.reload())},1e3):a.end>0&&(a.time=e(function(){a.end?(a.second=parseInt(a.end%60),a.minute=parseInt(parseInt(a.end/60)%60),a.hour=parseInt(parseInt(a.end/3600)%24),a.day=parseInt(a.end/3600/24),0===a.hour&&0===a.minute&&0===a.second&&(a.day=a.day-1,a.hour=23,a.minute=59,a.second=59),0===a.minute&&0===a.second&&(a.hour=a.hour-1,a.minute=59,a.second=59),0===a.second&&(a.minute=a.minute-1,a.second=59),a.second<10&&(a.second="0"+a.second),a.minute<10&&(a.minute="0"+a.minute),a.hour<10&&(a.hour="0"+a.hour)):(a.day=0,a.hour=0,a.minute=0,a.second=0),a.end=a.end-1,a.end<0&&(e.cancel(a.time),t.reload())},1e3))}}}]),appBuilder.directive("map",function(){return{controller:"MapHeightController",restrict:"AE",template:'<div id="map"></div>',replace:!0,link:function(e,t,a,n){var i=angular.fromJson(localStorage.app);e.setMapheight();var s=new BMap.Map("map");s.centerAndZoom(new BMap.Point(e.detail.addressLng,e.detail.addressLat),17),s.setCurrentCity("北京"),s.enableScrollWheelZoom(!0),i.iconId?appIcon="/image/get/"+i.iconId:appIcon=viewSrc+"/img/branches_icon_shop_nor.png";var r=new BMap.Icon(appIcon,new BMap.Size(40,40)),o=new BMap.Point(e.detail.addressLng,e.detail.addressLat),l=new BMap.Marker(o,{icon:r});s.addOverlay(l),s.panTo(o),jQuery(".geo").click(function(){loader.open();var e=new BMap.Geolocation;e.getCurrentPosition(function(e){if(this.getStatus()==BMAP_STATUS_SUCCESS){var t=new BMap.WalkingRoute(s,{renderOptions:{map:s,autoViewport:!0}});loader.close(),t.search(e.point,o)}else txtTips("failed"+this.getStatus())},{enableHighAccuracy:!0})})}}}),appBuilder.directive("mapupbtn",function(){return{controller:"MapHeightController",restrict:"A",link:function(e,t,a,n){jQuery(t).click(function(a){jQuery(t).hasClass("slidearrow")?(jQuery(t).removeClass("slidearrow").parents(".up").css("margin-top",0).siblings(".subshop-detail").removeClass("slideup"),e.setMapheight()):(jQuery(t).addClass("slidearrow").parents(".up").css("margin-top","1rem").siblings(".subshop-detail").addClass("slideup"),e.setMapheight())})}}}),appBuilder.directive("gotop",["$timeout",function(e){return{restrict:"AE",template:'<div class="go-top">&uarr;</div>',replace:!0,link:function(e,t,a){jQuery(window).scroll(function(e){var t=window.innerHeight,a=jQuery(window).scrollTop();a>t/2?(jQuery(".go-top").fadeIn(),jQuery(".go-top").click(function(e){jQuery(window).scrollTop(0)})):a<t/2&&jQuery(".go-top").fadeOut()})}}}]),appBuilder.directive("slideimg",["$state","$interval",function(e,t){return{restrict:"AE",templateUrl:viewSrc+"partials/slideimg.html",scope:{imgdata:"@"},replace:!0,link:function(a,n,i){a.imgs=angular.fromJson(a.imgdata),a.slideindex=0,a.index=0,auto=!1,a.goright=function(){a.slideindex>0?a.slideindex=a.slideindex-1:a.slideindex=0,a.index=a.slideindex,auto=!0},a.goleft=function(){a.slideindex<a.imgs.length-1?a.slideindex=a.slideindex+1:a.slideindex=0,a.index=a.slideindex,auto=!0},a.time=t(function(){auto&&(a.slideindex=a.index,auto=!1),a.slideindex<a.imgs.length-1?a.slideindex=a.slideindex+1:a.slideindex=0},3e3),a.goDetail=function(t,a,n,i){1==t?1==a?e.go("product-detail",{id:n}):2==a&&e.go("article-detail",{id:n}):2==t&&(i.indexOf("http://")>-1||i.indexOf("https://")>-1?location.href=i:location.href="http://"+i)}}}}]),appBuilder.directive("swipemenu",function(){return{restrict:"AE",templateUrl:viewSrc+"partials/swipemenu.html",replace:!0,link:function(e,t,a,n){jQuery(".swipemenu").parent().css({position:"relative",overflow:"hidden"}),e.countmax=0,e.acount=0,e.count=0,e.diswidth=a.diswidth,e.discount=a.discount,jQuery(window).scroll(function(e){var t=(window.innerHeight,jQuery(window).scrollTop());0===t?jQuery(".swipemenu").removeClass("fixed"):jQuery(".swipemenu").addClass("fixed")}),e.sum=0,e.swipeLeft=function(){return e.navmax=jQuery(".swipemenu>li").length,e.count===e.navmax-4?"不能左滑了":(e.count=e.count+1,void(e.sum=e.sum+jQuery("li:nth-child("+e.count+")").width()/37.5+.5))},e.swipeRight=function(){return 0===e.count?"不能右滑了":(e.sum=e.sum-jQuery("li:nth-child("+e.count+")").width()/37.5-.5,void(e.count=e.count-1))}}}}),appBuilder.directive("swipenavmenu",function(){return{restrict:"AE",templateUrl:viewSrc+"partials/swipenavmenu.html",replace:!0,link:function(e,t,a,n){jQuery(".swipenavmenu").parent().css({position:"relative",overflow:"hidden"}),jQuery(window).scroll(function(e){var t=(window.innerHeight,jQuery(window).scrollTop());0===t?jQuery(".swipenavmenu").removeClass("fixed"):jQuery(".swipenavmenu").addClass("fixed")}),e.navmax=0,e.navdiswidth=a.diswidth,e.navdiscount=a.discount,e.anavcount=0,e.navcount=0,e.navsum=0,e.swipeNavLeft=function(){return e.navmax=jQuery(".swipenavmenu>li").length,e.navcount===e.navmax-2?"不能左滑了":(e.navcount=e.navcount+1,void(e.navsum=e.navsum+jQuery("li:nth-child("+e.navcount+")").width()/37.5+.5))},e.swipeNavRight=function(){return 0===e.navcount?"不能右滑了":(e.navsum=e.navsum-jQuery("li:nth-child("+e.navcount+")").width()/37.5-.5,void(e.navcount=e.navcount-1))}}}}),appBuilder.directive("size",["$rootScope","api","$cookies","$state","$stateParams","appCache","KillZero",function(e,t,a,n,i,s,r){return{restrict:"AE",templateUrl:viewSrc+"partials/size.html",replace:!0,scope:{maxcount:"@",limitnum:"@",promotionprice:"@",specinfo:"@",specmaps:"@",price:"@",imagepath:"@",specvalues:"@",needcredit:"@"},link:function(s,o,l,c){function d(){var e="";return jQuery.each(jQuery(".size-box>a.active"),function(t,a){e=e+jQuery(a).attr("value-id")+","}),e.substring(0,e.length-1)}function p(e){jQuery.each(e.split(","),function(e,t){jQuery.each(jQuery(".size-box"),function(a,n){e==a&&jQuery(n).find('a[value-id="'+t+'"]').addClass("active").siblings().removeClass("active")})})}function u(t){s.newprice=r(t.promotionPrice)||r(t.price),s.imagepath=t.imagePath,s.maxcount=t.promotionLimitInventory||t.inventory,s.limitnum=t.promotionLimitNum,s.productID=t.id,e.maxcount=s.maxcount}s.specInfo=angular.fromJson(s.specinfo),s.specValues=angular.fromJson("["+s.specvalues+"]"),s.newprice=s.promotionprice||s.price;var m=angular.fromJson(s.specmaps),g="",f=jQuery(".count-box");e.maxcount=s.maxcount,jQuery(".bar").click(function(e){jQuery(".size").css("left",0),jQuery("body").css({height:window.innerHeight,overflow:"hidden"}),g="",a.put("rightStr",d()),f.attr("data-id",i.id)}),jQuery(".size-top>i").click(function(e){var t=jQuery(".addcut>input");jQuery(".size").css("left","-10rem"),jQuery("body").css({height:"100%",overflow:""}),jQuery.each(jQuery(".size-container>.size-box"),function(e,t){g=g+","+jQuery(t).children("a.active").text()}),g=g.length>10?g.substring(1,10)+"...":g.substring(1,g.length),jQuery(".size-container>.size-box").hasClass("size-box")?(jQuery(".bar").html('<span>已选</span><span class="chosed">'+g+","+t.val()+"件</span><i></i>"),n.go("product-detail",{id:f.data("id")})):jQuery(".bar").html('<span>已选</span><span class="chosed">'+t.val()+"件</span><i></i>")}),jQuery(".size-container").on("click",".size-box>a",function(e){var n=0,i=0,s="",r=jQuery(".size-container a.active"),o=jQuery(".size-box");jQuery(this).addClass("active").siblings(".active").removeClass("active"),jQuery.each(m,function(e,t){n+=1}),r.length<o.length||(s=d(),jQuery.each(m,function(e,n){s==n?(window.hasSize=!0,a.put("rightStr",s),p(s),t.get("/api/product/detail/"+e,function(e){u(e.content),f.data("id",e.content.id)})):i+=1}),i==n&&(window.hasSize=!1,txtTips("没有该规格的产品")))})}}}]),appBuilder.directive("addcut",["$rootScope",function(e){return{scope:{maxcount:"@",limitnum:"@",count:"@"},restrict:"AE",templateUrl:viewSrc+"partials/addcut.html",replace:!0,link:function(t,a,n,i){t.max=0,t.max=t.limitnum||t.maxcount,t.cost=a.parents(".price").find(".cost").text(),t.cutNum=function(){return void 0!==t.count&&(1!=t.count&&void((e.updateNumTag||void 0===e.updateNumTag)&&(t.count=parseInt(t.count)-1,t.costTotal(t.cost,t.count),jQuery(a).parents(".count-box").attr("data-num",t.count))))},t.addNum=function(){return void 0!==t.count&&(t.count==t.max?(txtTips("数量已到最大值"),!1):void((e.updateNumTag||void 0===e.updateNumTag)&&(t.count=parseInt(t.count)+1,t.costTotal(t.cost,t.count),jQuery(a).parents(".count-box").attr("data-num",t.count))))},t.inputNum=function(){parseInt(t.count)>parseInt(t.max)?(t.count=t.max,t.costTotal(t.cost,t.count),jQuery(a).parents(".count-box").attr("data-num",t.count)):isNaN(t.count)?(t.count=0,t.costTotal(t.cost,0),jQuery(a).parents(".count-box").attr("data-num",t.count)):(0===parseInt(t.count.substring(0,1))&&(t.count=t.count.substring(1,t.count.length)),t.costTotal(t.cost,t.count),jQuery(a).parents(".count-box").attr("data-num",t.count))},t.costTotal=function(e,a){t.total=e*a},t.costTotal(t.cost,t.count)}}}]),appBuilder.directive("car",["$http","APP_ID","api","$state","$rootScope","$stateParams",function(e,t,a,n,i,s){return{restrict:"A",link:function(e,r,o,l){function c(e,n){return 0===parseInt(n)?void txtTips("数量不能为0"):void(i.updateNumTag&&(i.updateNumTag=0,a.post("/api/cart/set",{userId:p,appId:t,productId:parseInt(e),number:parseInt(n),tag:2},function(e){e.success&&(i.updateNumTag=1)})))}var d=angular.fromJson(sessionStorage.userinfo),p=d.userId;jQuery(".car-main").on("click",".list i",function(e){var t=jQuery(this).parents("li").hasClass("active");t?jQuery(this).parents("li").removeClass("active"):jQuery(this).parents("li").addClass("active"),jQuery(".list>li").length==jQuery(".list>li.active").length?jQuery(".car-bottom>i").addClass("active"):jQuery(".car-bottom>i").removeClass("active"),u.total(u.activeCost(),u.activeCount())}),jQuery(".list").on("click","li .addcut>.add,li .addcut>.cut",function(e){jQuery(this).parents("li").hasClass("active")&&u.total(u.activeCost(),u.activeCount()),c(jQuery(this).parents("li").attr("data-id"),jQuery(this).siblings("input").val())}),jQuery(".list").on("keyup","li .addcut>input",function(e){jQuery(this).parents("li").hasClass("active")&&u.total(u.activeCost(),u.activeCount()),c(jQuery(this).parents("li").attr("data-id"),jQuery(this).val())}),jQuery(".car-bottom>i").click(function(e){jQuery(this).hasClass("active")?(jQuery(this).removeClass("active"),jQuery(".list>li").removeClass("active"),u.total(0,0)):(jQuery(this).addClass("active"),jQuery(".list>li").addClass("active"),u.total(u.activeCost(),u.activeCount()))}),jQuery("a.edit").click(function(e){var t=jQuery(".car-bottom.edit"),a=jQuery(".car-bottom"),n=jQuery(".list>li").length==jQuery(".list>li.active").length,i=t.hasClass("active");i?(jQuery(this).text("编辑"),t.removeClass("active")):i||(jQuery(this).text("完成"),t.addClass("active")),n?(t.children("i").addClass("active"),a.children("i").addClass("active")):n||(t.children("i").removeClass("active"),a.children("i").removeClass("active"))}),jQuery(".car-bottom.edit").on("click",".deleteItem",function(e){var n="",i=jQuery(".list>li.active").length,s=jQuery(".list>li").length;return s&&0===i?void txtTips("请选择要删除的产品"):(jQuery.each(jQuery(".list>li.active"),function(e,t){n=n+jQuery(t).attr("car-id")+","}),n=n.substring(0,n.length-1),void a.post("/api/cart/delete",{userId:p,appId:t,cartIds:n},function(e){e.success&&location.reload()}))}),jQuery(".header>span>i,.header>span>span").click(function(e){jQuery(".car-top").show(),jQuery(".header>a.edit").hide()}),jQuery(".car-top").on("click","li",function(e){jQuery(this).addClass("active").siblings().removeClass("active"),jQuery(".header>span>span").text(jQuery(this).text()),jQuery(".car-top").hide(),jQuery(".header>a.edit").show(),n.go("car",{type:jQuery(this).data("id")})});var u={total:function(e,t){var a="",n="",i=jQuery(".car-bottom").find(".carPrice"),r=jQuery(".car-bottom").find(".carCount");0===e?(i.html(""),r.html("")):(e=parseFloat(e).toFixed(2),a=1==s.type?"&yen;"+e:e+"积分",n="("+t+")",i.html(a),r.html(n))},activeCost:function(){var e=0;return jQuery.each(jQuery(".list>li.active"),function(t,a){e+=parseFloat(jQuery(a).find(".addcut").attr("total"))}),e},activeCount:function(){return jQuery(".list>li.active").length}};i.updateNumTag=1,e.confirm=function(){var e="",t=angular.fromJson(sessionStorage.userinfo);if(jQuery(".list>li.active").length>0)jQuery.each(jQuery(".list>li.active"),function(t,a){e=e+","+jQuery(this).attr("car-id")}),n.go("confirm",{tag:1,cartIds:e.substring(1,e.length),cartType:s.type});else{if(""===t.guideId)return txtTips("请先绑定导购"),void n.go("choseguide");txtTips("请勾选产品")}}}}}]),appBuilder.directive("chosepart",["api","appCache",function(e,t){return{restrict:"AE",templateUrl:viewSrc+"partials/chosepart.html",replace:!0,link:function(a,n,i,s){a.chosePro=function(n,i,s){a.proName=n,a.proID=i,a.cityName="",a.cityID="",a.cityindex=-1,a.areadata=[],a.areaName="",a.areaID="",a.areaindex=-1,a.proindex=s,t.get("cityData"+i)?a.citydata=t.get("cityData"+i):e.get("/api/public/provincecityareaitems?parentId="+i,function(e){e.success&&(a.citydata=e.content,t.put("cityData"+i,e.content))})},a.choseCity=function(n,i,s){a.cityName=n,a.cityID=i,a.cityindex=s,a.areaName="",a.areaID="",a.areaindex=-1,t.get("areaData"+i)?a.areadata=t.get("areaData"+i):e.get("/api/public/provincecityareaitems?parentId="+i,function(e){e.success&&(a.areadata=e.content,t.put("areaData"+i,e.content))})},a.choseArea=function(e,t,n){a.areaName=e,a.areaID=t,a.areaindex=n},a.sure=function(){a.flagPart=!1}}}}]),appBuilder.directive("selectguide",["api","APP_ID","appCache","$state","$stateParams",function(e,t,a,n,i){return{restrict:"AE",templateUrl:viewSrc+"partials/selectguide.html",replace:!0,link:function(s,r,o,l){var c=angular.fromJson(sessionStorage.userinfo);s.set=function(t){var n=6.48*(window.rem/window.dpr);console.log(t),void 0!==t&&e.get("/api/branch/guide/"+t,function(e){if(e.success){if(s.flag=!s.flag,s.guide=e.content,console.log(s.flag),!s.guide)return s.flag=!s.flag,void txtTips("该店面暂时没有导购");s.style={height:window.innerHeight},a.put("branchGuide"+t,e.content),jQuery(".guide-con").width(s.guide.length*n)}})},s.back=function(){s.flag=!s.flag},s.setGuide=function(s){return s==c.guideId?void n.go("myguide"):void e.post("/api/branch/setguide",{appId:t,userId:c.userId,guideId:s},function(e){txtTips(e.msg),e.success&&(c.guideId=e.content.guideId,sessionStorage.setItem("userinfo",angular.toJson(c)),a.remove("guideinfo"),i.reurl?n.go("myguide",{reurl:i.reurl}):n.is("myguide")?n.reload():n.go("myguide"))})},s.move=0,s.swipeLeft=function(){s.move!=-6.48*(s.guide.length-1)&&(s.move=s.move-6.48,s.guideStyle={"margin-left":s.move+"rem"})},s.swipeRight=function(){0!==s.move&&(s.move=s.move+6.48,s.guideStyle={"margin-left":s.move+"rem"})}}}}]),appBuilder.directive("phonenumber",function(){return{restrict:"A",link:function(e,t,a,n){var i=a.phone.toString().substr(-8,4);jQuery(t).text(a.phone.toString().replace(i,"****"))}}}),appBuilder.directive("scroll",["api","appCache","$state","APP_ID","$rootScope","$stateParams",function(e,t,a,n,i,s){return{restrict:"A",link:function(r,o,l,c){function d(e){return void 0===e||(void 0===e.totalPage||(e.totalPage&&e.currentPage?e.currentPage>=e.totalPage?(txtTips("已经到底了"),console.log("缓存提示：已经到底了"),!1):(i.currentPage=e.currentPage,i.totalPage=e.totalPage,!0):void 0))}function p(t,a,s){var r=angular.fromJson(sessionStorage.userinfo);return angular.isFunction(a)&&(s=a,a={}),i.currentPage>=i.totalPage?(txtTips("已经到底了"),void console.log("当前页提示：已经到底了")):(i.currentPage+=1,a.appId=n,a.page=i.currentPage,a.pageCount=10,a.userId=r?r.userId:null,void e.get(t,a,function(e){i.totalPage=e.content.pager.totalPage,e.success&&(txtTips(e.msg),s(e))}))}function u(e){var a=e.oldData;e.scrollData=angular.fromJson(e.scrollData),0!==e.scrollData.length&&(e.oldData=a.concat(e.scrollData));var n=e.oldData;return n.totalPage=i.totalPage,n.currentPage=i.currentPage,t.put(e.cacheName,n),n}jQuery(window).scroll(function(e){var r=jQuery(window).height(),o=jQuery("html").height(),l=$(this).scrollTop();if(l==o-r)if(a.is("index.find"))console.log("没有翻页");else if(a.is("index.sale")){var c=jQuery(".swipemenu>li.active").attr("data-index");d(t.get("saleMenuCache"+c))&&p("/api/product/promotionproduct/"+jQuery(".swipemenu>li.active").attr("data-id"),function(e){i.saleMenuData||(i.saleMenuData=[]);var a=jQuery(".swipemenu>li.active").attr("data-index"),n=t.get("saleMenuCache"+a);i.saleMenuData[a]=u({oldData:n,scrollData:e.content.products,cacheName:"saleMenuCache"+a})})}else if(a.is("index.subshop"))d(t.get("indexSubCache"))&&p("api/branch/list?appId="+n,function(e){i.subshopList=u({oldData:t.get("indexSubCache"),scrollData:e.content.branches,cacheName:"indexSubCache"})});else if(a.is("index.pointmall"))jQuery("h2.bar>button").hasClass("active")?p("/api/product/credit",function(e){var t=i.creditProductsList;i.creditProductsList=t.concat(e.content.creditProducts)}):d(t.get("creditProductsList"))&&p("/api/product/credit",function(e){i.creditProductsList=u({oldData:t.get("creditProductsList"),scrollData:e.content.creditProducts,cacheName:"creditProductsList"})});else if(a.is("search"))p("/api/product/list",{order:jQuery(".menu>li.active").attr("data-id")||null,orderType:i.searchtag||0,type:i.searchtype||1},function(e){var t=i.searchList;i.searchList=t.concat(e.content.products)});else if(a.is("product")){var m=$(".swipemenu>li.active").data("id");d(t.get("productIndexList"+m))&&p("/api/product/list?&categoryId="+m,function(e){i.productList=u({oldData:t.get("productIndexList"+m),scrollData:e.content.products,cacheName:"productIndexList"+m})})}else if(a.is("product-list"))d(t.get("productListCache"+s.id))&&p("/api/product/list?&categoryId="+s.id,function(e){i.productList=u({oldData:t.get("productListCache"+s.id),scrollData:e.content.products,cacheName:"productListCache"+s.id})});else if(a.is("allComment"))d(t.get("AllProductComment"+s.id))&&p("/api/product/comment",{productId:s.id},function(e){i.AllProductComment=u({oldData:t.get("AllProductComment"+s.id),scrollData:e.content.comments,cacheName:"AllProductComment"+s.id})});else if(a.is("community"))d(t.get("communityIndexCache"))&&p("/api/forum/list",function(e){
i.communityList=u({oldData:t.get("communityIndexCache"),scrollData:e.content.forums,cacheName:"communityIndexCache"})});else if(a.is("community-sublist"))d(t.get("communityListCache"+s.id))&&p("/api/forum/topics?forumId="+s.id,function(e){i.topicsList=u({oldData:t.get("communityListCache"+s.id),scrollData:e.content.topics,cacheName:"communityListCache"+s.id})});else if(a.is("growth"))p("/api/account/creditrecord",function(e){var t=i.creditRecordList;i.creditRecordList=t.concat(e.content.records)});else if(a.is("myCommunity"))jQuery(".nav>.community").hasClass("active")?d(t.get("myCommunity"))&&p("/api/forum/topics",function(e){i.myCommunity=u({oldData:t.get("myCommunity"),scrollData:e.content.topics,cacheName:"myCommunity"})}):d(t.get("myCommunityComment"))&&p("/api/comment/mine",{tag:2},function(e){i.myCommunity=u({oldData:t.get("myCommunityComment"),scrollData:e.content.comments,cacheName:"myCommunityComment"})});else if(a.is("myComment"))jQuery(".nav>.product").hasClass("active")?d(t.get("myProductComment"))&&p("/api/comment/mine",{tag:3},function(e){i.myProductComment=u({oldData:t.get("myProductComment"),scrollData:e.content.comments,cacheName:"myProductComment"})}):d(t.get("myArticleComment"))&&p("/api/comment/mine",{tag:1},function(e){i.myCommunity=u({oldData:t.get("myArticleComment"),scrollData:e.content.comments,cacheName:"myArticleComment"})});else if(a.is("myOrder"))d(t.get("myOrder"+jQuery(".swipemenu>li.active").data("id")))&&p("/api/order/list",{tag:1,payState:jQuery(".swipemenu>li.active").data("id")},function(e){var a=jQuery(".swipemenu>li.active").data("id");i.myOrder=u({oldData:t.get("myOrder"+a),scrollData:e.content.orders,cacheName:"myOrder"+a})});else if(a.is("mymember"))d(t.get("mymembers"))&&p("/api/account/users",function(e){i.members=u({oldData:t.get("mymembers"),scrollData:e.content.users,cacheName:"mymembers"})});else if(a.is("mypoint"))d(t.get("myPointRecords"))&&p("/api/account/creditrecord",{type:0},function(e){i.pointRecords=u({oldData:t.get("myPointRecords"),scrollData:e.content.records,cacheName:"myPointRecords"})});else if(a.is("mine")){var g,f={},h=angular.fromJson(sessionStorage.userinfo);"BranchAdmin"==h.roleTag?(g="/api/order/list",f={tag:1,type:2,payState:i.payState||-1,timeEnd:i.timeEnd,timeStart:i.timeStart}):"AppUser"!==h.roleTag&&(g="/api/account/deduct",f={timeEnd:i.timeEnd,timeStart:i.timeStart}),d(t.get("roleRecords"))&&p(g,f,function(e){i.records=u({oldData:t.get("roleRecords"),scrollData:e.content.orders||e.content.records,cacheName:"roleRecords"})})}}),i.currentPage=1,i.totalPage=2}}}]),appBuilder.directive("backpage",["$state","$stateParams","HOST",function(e,t,a){return{restrict:"A",link:function(n,i,s,r){var o=t.reurl||sessionStorage.reurl;localStorage._host;jQuery("body").removeAttr("style"),jQuery(i).on("click",function(t){if(console.log("reurl："+o),o)if(o=decodeURIComponent(decodeURIComponent(o)),o.indexOf("http")<0)location.href=a+o;else{if(location.href==o||o.indexOf("#")==-1)return sessionStorage.removeItem("reurl"),void e.go("index.find");location.href=o,sessionStorage.removeItem("reurl")}else e.is("address")?e.go("mine"):e.is("confirm")||e.is("car")||e.is("choseguide")?e.go("index.find"):history.go(-1)})}}}]),appBuilder.directive("star",function(){return{scope:{totalstar:"@"},restrict:"AE",templateUrl:viewSrc+"partials/star.html",replace:!0,link:function(e,t,a,n){e.star=function(a){e.totalstar=a,jQuery(t).parents("li").attr("data-userscore",a)}}}}),appBuilder.directive("usercomment",["ResetMyOrderData","$rootScope","$stateParams","api","$state","appCache","handleUserInfo",function(e,t,a,n,i,s,r){return{restrict:"AE",link:function(t,o,l,c){var d=[],p=angular.fromJson(sessionStorage.userinfo);jQuery(o).click(function(t){jQuery.each(jQuery(".list>li"),function(e,t){if(""===jQuery(t).find("textarea").val())return void txtTips("评价不能为空");var a={};a.productId=jQuery(t).data("productid"),a.score=jQuery(t).data("userscore"),a.content=jQuery(t).find("textarea").val(),d[e]=a}),jQuery(".list>li").length==d.length&&n.post("/api/order/comment",{userId:p.userId,orderId:a.orderId,data:angular.toJson(d)},function(t){t.success&&(e._delete(),i.go("myOrder"),s.remove("myOrder7"),s.remove("myProductComment"),r.update())})})}}}]),appBuilder.directive("calendar",["$rootScope","$state","appCache","APP_ID","api",function(e,t,a,n,i){return{restrict:"A",link:function(s,r,o,l){function c(){a.remove("roleRecords");var t=jQuery(".start").data("month"),s=jQuery(".start").data("day"),r=jQuery(".end").data("month"),o=jQuery(".end").data("day");if(t||r){m=new Date(v+","+t+","+s);var l=m.getTime()/1e3;g=new Date(v+","+r+","+o);var c=g.getTime()/1e3;e.timeStart=l,e.timeEnd=c,e.startDate=v+"-"+t+"-"+s,e.endDate=v+"-"+r+"-"+o,console.log(e.startDate),console.log(e.endDate),"BranchAdmin"==f.roleTag?i.get("/api/order/list",{type:2,userId:f.userId,appId:n,tag:e.tag||1,payState:e.payState||-1,page:1,pageCount:10,timeStart:l,timeEnd:c},function(e){d(e)}):i.get("/api/account/deduct",{userId:f.userId,appId:n,page:1,pageCount:10,timeStart:l,timeEnd:c},function(e){e.success&&d(e)})}}function d(e){if(e.content.orders&&!e.content.orders.length)return void txtTips("没有此时间段的订单");if(e.content.records&&!e.content.records.length)return void txtTips("没有此时间段的订单");var n=e.content.records||e.content.orders;n.totalPage=e.content.pager.totalPage,n.currentPage=e.content.pager.currentPage,n.sum=e.content.sum,a.put("roleRecords",n),t.go("mine")}var p,u,m,g,f=angular.fromJson(sessionStorage.userinfo),h=new Date,v=h.getFullYear();e.payState=-1,s.year=v,"BranchAdmin"!==f.roleTag&&(jQuery(".status-name").remove(),jQuery(".classic-name").remove(),jQuery(".line").remove(),jQuery(".week").css("border",0),jQuery(".calendar").css("margin-top","2rem")),jQuery(".menu").on("click",".status-name,.classic-name",function(e){var t=window.innerHeight-jQuery(".header").height()-jQuery(".menu").height()-10,a=jQuery(this);jQuery(".chose-con").show(100,function(){0===a[0].className.indexOf("status")?(jQuery(".classic").hide(),jQuery(".status").show()):a[0].className.indexOf("status")==-1&&(jQuery(".status").hide(),jQuery(".classic").show()),jQuery(this).find(".bg").css("height",t)})}),jQuery(".chose-con").on("click","ul>li",function(t){jQuery(this).addClass("active").siblings("li").removeClass("active"),jQuery(this).parent("ul").hasClass("status")?(jQuery(".status-name>span").text(jQuery(this).text()),e.payState=jQuery(this).data("status"),c(),console.log("订单状态："+e.payState)):(jQuery(".classic-name>span").text(jQuery(this).text()).parent("li").addClass("active"),e.tag=jQuery(this).data("classic"),c(),console.log("订单类别："+e.tag)),jQuery(".chose-con").hide()}),jQuery(".calendar").on("click",".list>div",function(e){var t=jQuery(".start").hasClass("start"),a=jQuery(".end").hasClass("end"),n=jQuery(".start").data("month"),i=jQuery(".start").data("day");!t&&!a||t&&a?t&&a?(jQuery(".start").removeClass("start").children(".tag").text(" "),jQuery(".end").removeClass("end").children(".tag").text(" "),jQuery(this).addClass("start").children(".tag").text("开始")):jQuery(this).addClass("start").children(".tag").text("开始"):t&&!a&&(p=jQuery(this).data("month"),u=jQuery(this).data("day"),p>n?(jQuery(this).addClass("end").children(".tag").text("结束"),c()):p==n&&u>i?(jQuery(this).addClass("end").children(".tag").text("结束"),c()):txtTips("结束时间不能早于开始时间"))})}}}]),appBuilder.directive("showsendproduct",["$rootScope",function(e){return{link:function(e,t,a,n){var i=window.innerHeight;jQuery(t).on("click",function(e){jQuery("body").css({height:i,overflow:"hidden"}),jQuery(".show-send-product").css({height:i,left:0})})}}}]),appBuilder.directive("nodata",["$rootScope",function(e){return{restrict:"AE",templateUrl:viewSrc+"partials/nodata.html",scope:{dis:"@"},replace:!0,link:function(e,t,a,n){var i=e.dis,s=jQuery(window).height(),r=jQuery(t).find("div").height(),o=jQuery(t);o.height(s),o.find("div").css({"margin-top":(s-r)/2}),console.log(i),i>0?o.hide():o.show()}}}]),appBuilder.component("lookphoto",{templateUrl:viewSrc+"partials/community.photo.html",bindings:{data:"="},controller:function(){var e=jQuery(window).height(),t=jQuery(window).width();this.isShow="none",this.max=this.data.length,this.imgMaxHeight=.9*e,this._move_val=0,this._photo_height=e,this._photo_width=t*this.max,this.showPhoto=function(e){this._move_val=10*-e,this.isShow="block"},this.hidePhoto=function(){this.isShow="none"},this.runright=function(){0!==this._move_val&&(this._move_val=this._move_val+10)},this.runleft=function(){this._move_val!=-10*(this.max-1)&&(this._move_val=this._move_val-10)}}}),angular.module("phonecatFilters",[]).filter("checkmark",function(){return function(e){return e?"✓":"✘"}});var appBuilderService=angular.module("appBuilderService",[]),appBuilderFactory=angular.module("appBuilderFactory",[]);appBuilderFactory.factory("api",["$http","API_SALT","KillZero","$state",function(e,t,a,n){function i(e){var a=[];angular.forEach(e,function(e,t){if(angular.isObject(e)){var n=e;e="",angular.forEach(n,function(t,a){var n;n=/.*[\u4e00-\u9fa5]+.*$/.test(t)?escape(t).toLocaleLowerCase().replace(/%u/gi,"\\u"):t,e+=angular.isNumber(t)?'"'+a+'":'+n+",":'"'+a+'":"'+n+'",'}),e="{"+e.substring(0,e.length-1)+"}",e=e.replace(/,/g,";")}else if("sign"==t)return;a.push(t+"="+e)});var n=a.sort().toString(),i=n.replace(/,/g,"&");return i.indexOf("content")>-1&&(i=i.replace(/;/g,",")),hex_md5(i.replace(/\//g,"\\/")+t)}return{get:function(t,n,s,r){return t=reqHost+t,r||loader.open(),angular.isFunction(n)&&(s=n),n||(n={}),n.timeout=5e3,n.sign=i(n),e.get(t,{params:n}).success(function(e,n,i,r){loader.close(),e.content&&(e.content.products?e.content.products=a(e.content.products,t):e.content.hotProducts?e.content.hotProducts=a(e.content.hotProducts,t):e.content.newProducts?e.content.newProducts=a(e.content.newProducts,t):e.content.orders&&(e.content.orders=a(e.content.orders,t))),angular.isFunction(s)&&s(e,n,i,r)}).error(function(e,t,a,n){loader.close(),txtTips("请求失败，请稍后再试")})},post:function(t,n,s){return t=reqHost+t,loader.open(),angular.isFunction(n)&&(s=n),n||(n={}),n.timeout=5e3,n.sign=i(n),e.post(t,n).success(function(e,t,n,i){loader.close(),e.success||txtTips(e.msg),e.content&&(e.content.products?e.content.products=a(e.content.products):e.content.hotProducts?e.content.hotProducts=a(e.content.hotProducts):e.content.newProducts?e.content.newProducts=a(e.content.newProducts):e.content.orders&&(e.content.orders=a(e.content.orders))),angular.isFunction(s)&&s(e,t,n,i)}).error(function(e,t,a,n){loader.close(),txtTips("请求失败，请稍后再试")})}}}]),appBuilderFactory.factory("appCache",["$cacheFactory",function(e){return e("app_cache")}]),appBuilderFactory.factory("handleURL",function(){return{set:function(e,t,a){var n;void 0===a&&(a=location.href);var i=a.indexOf("?");if(i<0)n=a+"?"+e+"="+t;else{var s=a.indexOf(e);if(s<0)n=a+"&"+e+"="+t;else if(s>0){var r=a.substring(0,s),o=a.substring(s,a.length);if(o.indexOf("&")<0)o=o.substring(0,o.indexOf("=")+1)+t,n=r+o;else{var l=o.substring(o.indexOf("&"),o.length);o=o.substring(0,o.indexOf("=")+1)+t,n=r+o+l}}}return n},getParam:function(e){void 0===e&&(e=location.href);var t="",a=e.indexOf("?");return t=a<0?null:e.substr(a+1,e.length)},markValue:function(e,t){var a;a=t?t:location.href;var n=a.indexOf(e);if(!(n<0)){var i,s=a.substring(n,a.length),r=s.indexOf("&");return i=r<0?s.substring(e.length+1,s.length):s.substring(e.length+1,r)}}}}),appBuilderFactory.factory("handleUserInfo",["api","APP_ID",function(e,t){return{update:function(a,n){var i=angular.fromJson(sessionStorage.userinfo);e.post("/api/account/update",{userId:i.userId,appId:t},function(e){1==e.success&&sessionStorage.setItem("userinfo",angular.toJson(e.content))})}}}]),appBuilderFactory.factory("ResetMyOrderData",["api","APP_ID","appCache",function(e,t,a){return{_delete:function(){for(var e=-1;e<7;e++)a.remove("myOrder"+e)}}}]),appBuilderFactory.factory("KillZero",["$state",function(e){return function(e,t){function a(e){return e=e.toString(),e=1==e.length?e:e.substring(e.length-1,e.length)}console.log("开始处理数据--KillZero");var n;if(!e)return void console.log("当你看到这个log时，或许是你传的值不对或未定义----------来自于KillZero的日志");if(t&&console.log("数据来源（"+t+"）--KillZero"),angular.isArray(e))console.log("数据是数组--KillZero"),n=[],angular.forEach(e,function(e,t){var i="";angular.forEach(e,function(e,t){if((t.indexOf("price")>-1||t.indexOf("Price")>-1)&&e.toString().indexOf(".")>-1&&"0"==a(e)&&(e=e.substring(0,e.length-1),"0"==a(e)&&(e=e.substring(0,e.length-2))),angular.isArray(e)){console.log("数据有嵌套--KillZero");var n="";angular.forEach(e,function(e,t){var i="";angular.forEach(e,function(e,t){(t.indexOf("price")>-1||t.indexOf("Price")>-1)&&e.toString().indexOf(".")>-1&&"0"==a(e)&&(e=e.substring(0,e.length-1),"0"==a(e)&&(e=e.substring(0,e.length-2))),i+='"'+t+'":"'+e+'",'}),n+="{"+i.substring(0,i.length-1)+"},"}),e="",e="["+n.substring(0,n.length-1)+"]"}else angular.isArray(e)||(e='"'+e+'"',e.indexOf("<p>")>-1&&"detail"==t&&(e='"这原本是HTML结构字符串，在JS内经过KillZero方法重新赋值了!!!!!!"'));i+='"'+t+'":'+e+","}),i=angular.fromJson("{"+i.substring(0,i.length-1)+"}"),n.push(i)});else{if(angular.isObject(e)){console.log("数据是对象--KillZero");var i="";return angular.forEach(e,function(e,t){(t.indexOf("price")>-1||t.indexOf("Price")>-1)&&e.toString().indexOf(".")>-1&&"0"==a(e)&&(e=e.substring(0,e.length-1),"0"==a(e)&&(e=e.substring(0,e.length-2))),i+='"'+t+'":"'+e+'",'}),angular.fromJson("{"+i.substring(0,i.length-1)+"}")}console.log("数据是字符串--KillZero"),e.toString().indexOf(".")>-1&&"0"==a(e)&&(e=e.substring(0,e.length-1),"0"==a(e)&&(e=e.substring(0,e.length-2))),n=e}return n}}]),angular.module("appBuilder").run(["$templateCache",function(e){e.put("aboutus.html",'<div class="about-us-main"><div class="header"><i ui-sref="appset"></i> <span translate="aboutUs"></span></div><div class="content" ng-bind-html="us"></div></div>'),e.put("blank.html","<!-- 空白页，路由跳转用 -->"),e.put("home.html","<div ui-view></div><!-- 底部在find/index.html,sale/index.html,subshop/index.html中 -->"),e.put("search.html",'<div class="search-main"><div class="top"><a class="back" ui-sref="index.find"></a> <input placeholder="{{\'enterSearchContent\' | translate}}" ng-model="keyword"><span ng-click="searchKey()">&nbsp;&nbsp;搜索</span></div><ul class="menu"><li class="menu-line" style="left:{{movevalue}}rem"></li><!-- <li ng-click="menuActive(0)" ng-class="{active:movevalue==0}" class="nopadding">综合</li> --><li ng-class="{active:movevalue==0}"><b ng-class="{up:ml,down:!ml}" class="product" ng-click="menuActive(0)">{{distype}}</b><ul class="classic" ng-if="ml"><li ng-click="classic(1)">产品</li><li ng-click="classic(3)">积分</li><li ng-click="classic(2)">促销</li></ul></li><li ng-click="menuActive(2)" ng-class="{active:movevalue==2,down:classnum2==0,up:classnum2==1}" data-id="updateTime">时间</li><li ng-click="menuActive(4)" ng-class="{active:movevalue==4,down:classnum3==0,up:classnum3==1}" data-id="saleCount">销量</li><li ng-click="menuActive(6)" ng-class="{active:movevalue==6,down:classnum4==0,up:classnum4==1}" data-id="price">价格</li><li ng-click="dis=!dis" ng-class="{listbtn:!dis,blockbtn:dis}"></li></ul><ul class="list" ng-class="{listdis:!dis,blockdis:dis}"><li id="nocss" ng-if="searchList.length===0">没有相应的搜索结果</li><li ng-repeat="data in searchList" ui-sref="product-detail( {id:data.id} )"><i ng-if="data.isHot==1&&data.type==1" class="hot-icon"></i> <i ng-if="data.isNew==1&&data.type==1" class="new-icon"></i> <img lazy-src="{{data.imagePath}}"> <span class="block-status" ng-if="data.promotionStatus==1">即将开抢</span> <span class="block-status" ng-if="data.promotionStatus==2">马上抢</span> <span class="block-status" ng-if="data.promotionStatus==3">已抢光</span><p>{{data.name}}</p><span class="price" ng-if="data.type==1" ng-bind-template="&yen;{{data.price}}"></span> <span class="price" ng-if="data.type==2"><span class="old-price-list" ng-bind-template="&yen;{{data.price}}" ng-if="data.type==2&&data.promotionType==2 || data.type==2&&data.promotionType==1"></span> &yen;{{data.promotionPrice}} <span class="txt" ng-if="data.promotionType==1">折</span> <span class="txt" ng-if="data.promotionType==2">减</span> <span class="txt" ng-if="data.promotionType==3">满</span> </span><span class="price" ng-if="data.type==3"><img src="http://appbuilder.loongjoy.com/phoneweb/app/img/my_integral_icon_2.png">{{data.needCredit}}</span> <span class="sale" ng-bind-template="已售{{data.saleCount}}件"></span> <span class="list-btn"><a class="ready" ng-if="data.promotionStatus==1">即将开抢</a> <a ng-if="data.promotionStatus==2">马上抢</a> <a class="end" ng-if="data.promotionStatus==3">已抢光</a> <span ng-if="data.promotionStatus==2" ng-bind-template="已抢{{data.promotionSaleCount}}件"></span> </span><!-- data.type==1为普通产品 --><!-- data.type==2为促销产品 --><!-- data.type==3为积分产品 --><!-- promotionStatus==1 促销未开始 --><!-- promotionStatus==2 促销已开始 --><!-- promotionStatus==3 促销已结束 --> <i ng-if="data.type==2&&data.promotionType==1" class="promotion-icon"><img src="http://appbuilder.loongjoy.com/phoneweb/app/img/search_zhe.png"></i><i ng-if="data.type==2&&data.promotionType==2" class="promotion-icon"><img src="http://appbuilder.loongjoy.com/phoneweb/app/img/search_jian.png"></i><i ng-if="data.type==2&&data.promotionType==3" class="promotion-icon"><img src="http://appbuilder.loongjoy.com/phoneweb/app/img/search_man.png"></i></li></ul></div>'),e.put("test.html",'<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1,minimum-scale=1"><title>Document</title><style type="text/css">/*\tbody, html,#allmap {width: 100%;height: 100%;overflow: hidden;margin:0;font-family:"微软雅黑";}*/\r\n\t#map{\r\n\t\twidth: 100%;height: 100%;overflow: hidden;margin:0;font-family:"微软雅黑";\r\n\t\theight: 1000px;\r\n\t}</style><script src="http://api.map.baidu.com/api?v=2.0&ak=qYEBZwdKQxosmqZq4Cwttvqw" type="text/javascript"></script><script type="text/javascript" src="/phoneweb/app/bower_components/jquery/dist/jquery.min.js"></script></head><body><div id="map"></div></body></html><script type="text/javascript">console.log(window.mapheight)\r\n\t// 百度地图API功能\r\n\tvar map = new BMap.Map("map");    // 创建Map实例\r\n\tmap.centerAndZoom(new BMap.Point(116.404, 39.915), 11);  // 初始化地图,设置中心点坐标和地图级别\r\n\tmap.addControl(new BMap.MapTypeControl());   //添加地图类型控件\r\n\tmap.setCurrentCity("重庆");          // 设置地图显示的城市 此项是必须设置的\r\n\tmap.enableScrollWheelZoom(true);     //开启鼠标滚轮缩放</script>'),e.put("buy/car.html",'<div class="car-main" car><div class="header"><i backpage></i> <span><label translate="shoppingCart"></label>（<span>{{carclassic}}</span>）<i></i> </span><a class="edit" ng-hide="cartProducts.length===0" translate="edit"></a></div><ul class="car-top"><li data-id="1" ng-class="{active: type==1}" translate="product"></li><li data-id="2" ng-class="{active: type==2}" translate="integralMall"></li></ul><nodata dis="{{cartProducts.length}}"></nodata><ul class="list"><li ng-repeat="list in cartProducts" data-id="{{list.productId}}" car-id="{{list.id}}"><i></i> <img ng-src="{{list.imagePath}}"><dl><dd ng-bind-template="{{list.name}}" class="product-name" ui-sref="product-detail( {id: list.productId} )"></dd><dd class="list-size" ng-bind-template="{{list.specStr}}"></dd><dd class="price"><span ng-if="!list.needCredit">&yen;&nbsp;<span class="cost" ng-bind-template="{{list.promotionPrice || list.price}}"></span></span> <span ng-if="list.needCredit" class="credit-cast"><i></i>&nbsp;<span class="cost" ng-bind-template="{{list.needCredit}}"></span></span> <span class="discount" ng-if="list.type==2&&list.promotionType==1" ng-bind-template="{{list.promotionValue}}{{\'discount\'|translate}}"></span> <span class="discount" ng-if="list.type==2&&list.promotionType==2" ng-bind-template="{{\'subtract\'|translate}}"></span> <span class="discount" ng-if="list.type==2&&list.promotionType==3" ng-bind-template="{{\'give\'|translate}}"></span><addcut maxcount="{{list.inventory}}" limitnum="{{list.promotionLimitNum}}" count="{{list.number}}"></addcut></dd></dl></li></ul><div style="height: 1.2rem"></div><div class="car-bottom" ng-show="userinfo.roleTag==\'AppUser\'"><i></i><p><span translate="Total"></span> <span class="price carPrice">{{totalprice}}</span> <span translate="notFreight"></span></p><a ng-click="confirm()" translate="accounts"><span class="carCount"></span></a></div><div class="car-bottom edit"><i></i><p translate="checkAll"></p><a class="deleteItem" translate="delete"></a></div></div>'),e.put("buy/confirm.html",'<div class="confirm-main"><div class="header"><i backpage></i> <span translate="placeOrder"></span></div><div class="address" ng-click="goAddress()"><p><span ng-if="!consignee" class="auto" translate="sendAddress"></span> <span class="name" ng-bind-template="{{consignee.consignee}}"></span> <span class="mobile" ng-bind-template="{{consignee.mobile}}"></span> <span class="detail" ng-bind-template="{{consignee.province}}{{consignee.city}}{{consignee.area}}{{consignee.detail}}"></span></p><span class="icon"><i></i></span></div><ul class="list"><li ng-repeat="list in order.products"><img ng-src="{{list.imagePath}}"><dl><dd class="name" ng-bind-template="{{list.name}}"></dd><dd class="list-size" ng-bind-template="{{list.specStr}}"></dd><dd class="price" ng-hide="list.mallNeedCredits">{{list.promotionPrice||list.price}}<span>x{{list.number}}</span></dd><dd class="price" ng-if="list.mallNeedCredits"><img src="http://appbuilder.loongjoy.com/phoneweb/app/img/integral_product_icon.png">{{list.mallNeedCredits}}<span>x{{list.number}}</span></dd></dl></li><li ng-repeat="gift in order.gift"><img ng-src="{{gift.imagePath}}"><dl><dd class="name" ng-bind-template="{{gift.name}}"></dd><dd class="list-size" ng-bind-template="{{gift.specStr}}"></dd><dd class="price">{{gift.sourcePrice}}x{{gift.number}}</dd></dl></li></ul><div class="spend-credit" ng-if="order.currency==\'RMB\'&&spendCredits>0"><span><span translate="available"></span>{{spendCredits}}&nbsp;<span translate="integralDeductible"></span>&yen;{{toMoney}}</span> <span class="button" ng-class="{active: tomoneyflag}" ng-click="toCash()"><i></i></span></div><div class="pay-type" ng-if="order.currency==\'RMB\'" ng-click="set()"><span translate="paymentMethod"></span> <span class="icon"><i></i></span> <span class="chosed" ng-bind-template="{{payWay}}"></span></div><div class="send-way"><span class="way" translate="shippingMethod"></span> <span class="chosed" ng-bind-template="{{sendway}}"></span></div><div class="confirm-total"><span translate="inAll"></span>&nbsp;{{productsTotalNum | number}}&nbsp;<span translate="pieceProduct"></span><span translate="Total"></span> <span><span ng-if="order.currency==\'RMB\'">&yen;</span> <span ng-if="order.currency!==\'RMB\'"><img src="http://appbuilder.loongjoy.com/phoneweb/app/img/integral_product_icon.png"></span>{{totalPrice}} </span>（<span translate="freight"></span>&yen;{{shippingfee||0}}）</div><div class="msg"><span><span translate="messageRemarks"></span><input type="" name="" translate-attr="{ placeholder:\'optionalInformation\'}" ng-model="remark"></span></div><div class="hack"></div><div class="bottom"><span><span translate="Total"></span> <span ng-if="order.currency==\'RMB\'">&yen;</span> <span ng-if="order.currency!==\'RMB\'"><img src="http://appbuilder.loongjoy.com/phoneweb/app/img/integral_product_icon.png"></span>{{totalPrice}} </span><button ng-click="sendOrder()" translate="placeOrder"></button></div><div class="chose-bg" ng-style="style" ng-class="{active:flag}" ng-click="set()"><div class="con"><div><i ng-click="set()"></i><span translate="selectPaymentMethod"></span></div><ul><!-- <li class="alipay" ng-class="{active:paytype==1}" ng-click="pay(1)" ng-hide="wx">支付宝支付<i></i></li> --><li class="wechat" ng-class="{active:paytype==2}" ng-click="pay(2)" ng-if="wx"><span translate="weChatPayment"></span><i></i></li><li class="cash" ng-class="{active:paytype==3}" ng-click="pay(3)"><span translate="cashOnDelivery"></span><i></i></li></ul></div></div></div>'),e.put("buy/QRcode.html",'<div class="header"><i backpage></i> <span>扫码支付</span></div><div class="qrcode-container"><img src="{{src}}" alt=""><p>请使用微信扫码支付</p></div>'),e.put("article/detail.html",'<div class="article-main detail"><div class="header"><i ui-sref="article-list"></i> <span translate="articleDetails"></span></div><div class="content"><h3 ng-bind-template="{{detail.name}}"></h3><span class="date" ng-bind-template="{{detail.createTime}}"></span><div class="con" ng-bind-html="word"></div></div><div class="no-conment" ng-if="detail.commentCount===0" translate="noComment"></div><div class="conment" ng-if="detail.commentCount>0"><div class="tag" translate="allComments"></div><div ng-if="discomment==0" class="loading-comment"><img src="http://appbuilder.loongjoy.com/phoneweb/app/img/loading.gif"></div><ul><li ng-repeat="conment in comments"><img ng-src="{{conment.userImagePath}}"> <span class="name" ng-bind-template="{{conment.nickname}}"></span> <span class="date pull-right" ng-bind-template="{{conment.updateTime}}"></span><div class="des" ng-bind-template="{{conment.content}}"></div><div class="seller" ng-if="conment.reply"><span class="name" translate="merchantReply"></span> <span class="date" ng-bind-template="{{conment.reply.updateTime}}"></span><div ng-bind-template="{{conment.reply.content}}"></div></div></li></ul></div><div style="height:1.5rem; background:#fff"></div><div class="send"><input placeholder="{{\'commentArticle\' | translate}}" ng-model="articleConment" maxlength="200" ng-focus="tips()"> <a ng-click="sendConment(detail.id)" translate="sendOut"></a></div></div>'),e.put("article/index.html",'<div class="article-main"><div class="header" ng-if="articleLevel==0"><span translate="articleCenter"></span></div><!-- 顶级菜单 --><swipenavmenu discount="{{navMenu.length}}" diswidth="2"></swipenavmenu><!-- 一级、二级菜单 --><swipemenu discount="5" diswidth="2"></swipemenu><ul class="list" ng-if="articleLevel==1||articleLevel==2" ng-style="listStyle"><li ng-repeat="article in MenuArticleList" ng-click="goArticle(article.id)"><img ng-src="{{article.imagePath}}"><dl class="info"><dd class="title" ng-bind-template="{{article.name}}"></dd><dd class="des" ng-bind-template="{{article.summary}}"></dd><dd class="date" ng-bind-template="{{article.updateTime}}"></dd></dl></li></ul><!-- 0级菜单 --><ul class="list" ng-if="articleLevel===0" ng-style="listStyle"><li ng-repeat="article in MenuArticleList" ui-sref="article-detail({id: article.id})"><img ng-src="{{article.imagePath}}"><dl class="info"><dd class="title" ng-bind-template="{{article.name}}"></dd><dd class="des" ng-bind-template="{{article.summary}}"></dd><dd class="date" ng-bind-template="{{article.updateTime}}"></dd></dl></li></ul><div style="height:1.2rem" ng-if="articleLevel==3"></div><!-- 三级菜单 --><div ng-if="navdata.length===0" class="no-content" translate="noContent"></div><div class="third-menu" ng-if="articleLevel==3" ng-repeat="thirdmenu in navdata||navMenu[0].children"><div class="title" style="background-image: url({{thirdmenu.imagePath}})"></div><div class="name" ng-bind-template="{{thirdmenu.name}}"></div><div class="shade"></div><span ng-repeat="children in thirdmenu.children" ng-bind-template="{{children.name}}" ui-sref="article-list( {id:children.id,name:children.name})"></span></div></div><rfooter productlink="product" articlelink="article"></rfooter>'),e.put("article/list.html",'<div class="article-main list"><div class="header"><i ui-sref="article"></i> <span ng-if="listName" ng-bind-template="{{listName}}"></span> <span ng-if="!listName" ng-bind-template="{{\'articleList\' | translate}}"></span></div><ul class="list" ng-class="{active:listData.length>0}"><li ng-repeat="list in listData" ui-sref="article-detail({id:list.id})"><img ng-src="{{list.imagePath}}"><dl class="info"><dd class="title line-ellipsis" ng-bind-template="{{list.name}}"></dd><dd class="des line-campT" ng-bind-template="{{list.summary}}"></dd><dd class="date" ng-bind-template="{{list.updateTime.substring(0,10)}}"></dd></dl></li></ul></div><rfooter productlink="product" articlelink="article-list"></rfooter>'),e.put("community/detail.html",'<div class="community-main detail"><div class="header"><i backpage></i> <span translate="noteDetail"></span></div><div class="con"><div class="author"><img class="author-head" ng-src="{{detail.userImagePath}}"><div class="author-detail"><span class="name" ng-bind-template="{{detail.nickname}}"></span> <img class="author-level" ng-src="{{detail.iconImagePath}}"><p class="date" ng-bind-template="{{detail.updateTime}}"></p></div></div><h3><span class="tag" ng-if="detail.top==1" translate="pushUp"></span>{{detail.name}}</h3><div class="word"><p ng-bind-template="{{detail.detail}}" ng-if="detail.deleted===0"></p><p ng-if="detail.deleted==1" style="color:#ddd" translate="postDeleted"></p><img ng-repeat="img in detail.albumImages track by $index" lazy-src="{{img}}" ng-if="detail.deleted===0"></div><div class="operation" ng-if="detail.deleted===0"><span ng-bind-template="{{detail.commentNum}}"></span> <button class="comment-num"></button> <span ng-bind-template="{{detail.thumbNum}}"></span> <button class="zan" ng-click="clickZan(detail.id)" ng-class="{active:zan}"></button></div><div class="tips" ng-if="thumbs.length>0&&detail.deleted===0"><span ng-bind="thumbs"></span></div></div><div class="no-conment" ng-if="detail.commentCount===0" translate="noComment"></div><div class="conment" ng-if="detail.commentCount>0"><!-- <div class="tag">全部评论</div> --><!-- <div ng-if="discomment==0" class="loading-comment"><img src="http://appbuilder.loongjoy.com/phoneweb/app/img/loading.gif"></div> --><ul><li ng-repeat="conment in comments"><img ng-src="{{conment.userImagePath}}"> <span class="name" ng-bind-template="{{conment.nickname}}"></span> <span class="date pull-right" ng-bind-template="{{conment.updateTime}}"></span><div class="des" ng-bind-template="{{conment.content}}"></div><div class="seller" ng-if="conment.reply"><span class="name" translate="merchantReply"></span> <span class="date" ng-bind-template="{{conment.reply.updateTime}}"></span><div ng-bind-template="{{conment.reply.content}}"></div></div></li></ul></div><div style="height:1.5rem;width:10rem"></div><div class="send" ng-if="detail.deleted===0"><textarea translate-attr="{placeholder:\'commentOnIt\'}" maxlength="200" class="txa"></textarea><a ng-click="sendConment(detail.id)" translate="sendOut"></a></div></div>'),e.put("community/edit.html",'<div class="community-edit"><div class="header"><i backpage></i> <span translate="PUBLISHPOST"></span> <button ng-click="sub()" translate="issue"></button></div><div class="edit-con"><div class="title"><textarea type="text" style="overflow-y:visible;min-height:2rem" translate-attr="{placeholder:\'editorPostTitle\'}" ng-model="title"></textarea></div><div class="des"><textarea translate-attr="{placeholder:\'enterPostContent\'}" ng-model="des"></textarea></div><div class="photo"><div class="button uploader" ngf-select="uploadFiles($files,$invalidFiles)" ngf-accept="\'image/*\'" ngf-max-size="2MB"></div><img src="http://appbuilder.loongjoy.com/phoneweb/app/img/forum_posts_button_upload_nor.png"> <span ng-hide="hidespan" translate="addToPicture"></span><div ng-repeat="img in thumb" class="img-queue" data-id="{{img.id}}"><span ng-bind-template="{{img.imgName}}"></span> <img ng-src="{{img.imagePath}}"> <i ng-click="removeItem(img.id)"></i></div></div></div></div>'),e.put("community/index.html",'<div class="community-main"><div class="header"><span translate="forum"></span></div><ul class="list"><li ui-sref="community-sublist( {id:community.id} )" ng-repeat="community in communityList" data-id="{{community.id}}"><img ng-src="{{community.imagePath}}"><dl><dd class="title" ng-bind-template="{{community.name}}"></dd><dd class="description" ng-bind-template="{{community.summary}}"></dd><dd class="info"><img ng-src="{{member.userImagePath}}" ng-repeat="member in community.members"> <span>{{community.memberNum}}<span translate="personParticipate"></span></span></dd></dl></li></ul></div><rfooter productlink="product" articlelink="article"></rfooter>'),
e.put("community/sublist.html",'<div class="community-sublist"><div class="header"><i ui-sref="community"></i> <span ng-bind-template="{{forumInfo.name}}"></span> <a class="edit" ng-click="sendMessage()"></a></div><div class="list-title"><div class="blur" style="background-image: url({{forumInfo.backgroundPath}})"></div><div style="width:9.98rem;height:2.98rem;position:absolute;top:.01rem;left:.01rem;background:#000;opacity:.2"></div><div class="img-box"><img ng-src="{{forumInfo.imagePath}}"></div><div class="list-info"><span class="title" ng-bind-template="{{forumInfo.name}}" translate="dailyLifeNaggings"></span> <span><span translate="post" style="display: inline"></span>{{forumInfo.topicNum}}&nbsp;&nbsp;&nbsp;&nbsp;<span translate="Replies" style="display: inline"> </span>{{forumInfo.topicCommentNum}}</span> <span ng-bind-template="{{forumInfo.summary}}"></span></div></div><div class="list"><dl ng-repeat="topics in topicsList"><dd class="title" ui-sref="community-detail({ id:topics.id })"><img lazy-src="{{topics.userImage}}" class="user"> {{topics.nickname}} <img lazy-src="{{topics.iconImage}}" class="level"></dd><dd class="subtiitle line-ellipsis" ui-sref="community-detail({ id:topics.id })"><span class="tag" ng-if="topics.top==1" translate="pushUp"></span>{{topics.name}}</dd><dd class="des line-camp" ui-sref="community-detail({ id:topics.id })" ng-if="topics.deleted===0">{{topics.detail}}</dd><dd class="des line-camp" ui-sref="community-detail({ id:topics.id })" ng-if="topics.deleted==1&&topics.commentNum!==0" style="color:#ddd" translate="postDeleted"></dd><dd class="img" ng-if="topics.deleted==0"><lookphoto data="topics.albumImages"></lookphoto></dd><dd class="info"><span class="time" ng-bind-template="{{topics.createTime}}"></span> <span class="right" ng-if="topics.deleted===0"><i class="zan"></i><span ng-bind-template="{{topics.thumbNum}}"></span> <i class="discuss"></i><span ng-bind-template="{{topics.commentNum}}"></span></span></dd></dl></div></div>'),e.put("enter/forget.html",'<div class="forget-main enter"><div class="top"><a class="back" ui-sref="login"></a> <span translate="forgetPassword"></span></div><form name="forgetForm" ng-controller="ForgetController"><input translate-attr="{placeholder:\'phoneNumber\'}" ng-model="forgetMobile" required="required" autofocus="autofocus" ng-maxlength="11" ng-minlength="11" onkeyup="this.value=this.value.replace(/[^\\d]/g,\'\')" onafterpaste="this.value=this.value.replace(/[^\\d]/g,\'\')" maxlength="11" ng-blur="checkPhone()"><div class="pass"><input translate-attr="{placeholder:\'newPassword\'}" type="{{flag ? \'text\' : \'password\'}}" value="{{password}}" ng-model="forgetPass" required="required" ng-minlength="6" ng-maxlength="12"><a ng-class="{active: flag}" ng-click="flag=!flag"></a></div><div class="code"><input translate-attr="{placeholder:\'verificationCode\'}" maxlength="4" onkeyup="this.value=this.value.replace(/[^\\d]/g,\'\')" onafterpaste="this.value=this.value.replace(/[^\\d]/g,\'\')" ng-model="forgetCode" required="required" ng-minlength="4" ng-maxlength="4"><a ng-click="getCode()" ng-bind-template="{{getcodeword}}"></a></div><div><button class="btn" ng-click="forget()" ng-disabled="!forgetForm.$valid" translate="Determine"></button></div></form></div>'),e.put("enter/login.html",'<div class="login-main enter"><div class="top"><a class="back" ui-sref="index.find"></a> <span translate="Login"></span></div><form name="loginForm" ng-controller="LoginController"><input type="text" translate-attr="{placeholder:\'phoneNumber\'}" class="mobile" ng-model="loginMobile" required autofocus="autofocus" ng-maxlength="11" ng-minlength="11" onkeyup="this.value=this.value.replace(/[^\\d]/g,\'\')" onafterpaste="this.value=this.value.replace(/[^\\d]/g,\'\')" maxlength="11"><input type="password" translate-attr="{placeholder:\'password\'}" class="password" type="password" ng-model="loginPassword" required="required" ng-minlength="6" ng-maxlength="12"><div><button class="btn" ng-click="login()" ng-disabled="!loginForm.$valid" translate="Login"></button></div></form><div class="entry-btn"><a ui-sref="reg" translate="register"></a><a ui-sref="forget" translate="forgetPassword"></a></div></div>'),e.put("enter/reg.html",'<div class="reg-main enter"><div class="top"><a class="back" ui-sref="login"></a> <span translate="register"></span></div><form name="regForm" ng-controller="RegController"><input type="text" onkeyup="this.value=this.value.replace(/[^\\d]/g,\'\')" onafterpaste="this.value=this.value.replace(/[^\\d]/g,\'\')" ng-model="regMobile" translate-attr="{placeholder:\'phoneNumber\'}" autofocus="autofocus" ng-minlength="11" ng-maxlength="11" maxlength="11" ng-blur="checkPhone()"><input type="text" translate-attr="{placeholder:\'nickname\'}" ng-model="regNick" ng-minlength="2" ng-maxlength="10"><div class="pass"><input translate-attr="{placeholder:\'password\'}" type="{{flag ? \'text\' : \'password\'}}" required="required" ng-model="regPass" ng-minlength="6" ng-maxlength="12"><a ng-class="{active: flag}" ng-click="flag=!flag"></a></div><div class="code"><input translate-attr="{placeholder:\'verificationCode\'}" maxlength="4" onkeyup="this.value=this.value.replace(/[^\\d]/g,\'\')" onafterpaste="this.value=this.value.replace(/[^\\d]/g,\'\')" required="required" ng-model="regCode" ng-minlength="4" ng-maxlength="4"><a ng-click="getCode()">{{getcodeword}}</a></div><div><button class="btn" ng-click="reg()" ng-disabled="!regForm.$valid" translate="register"></button></div></form></div>'),e.put("index/find.html",'<rheader></rheader><div class="find-main"><i class="search" ui-sref="search"></i><!-- **************************************** --><div><slideimg imgdata="{{topimgs}}"></slideimg></div><!-- **************************************** --><h1><img src="http://appbuilder.loongjoy.com/phoneweb/app/img/home_icon_new_dis.png"><span translate="newProducts"></span> <span>NEW</span></h1><div class="new"><dl ng-repeat="new in indexdata.newProducts" ui-sref="product-detail({id: new.id})"><dt><a><img lazy-src="{{new.imagePath}}"></a></dt><dd><span class="price"><span class="new-price" ng-bind-template="&yen;{{new.promotionPrice||new.price}}"></span> <span class="old-price" ng-if="new.promotionType==2||new.promotionType==1" ng-bind-template="&yen;{{new.price}}"></span></span><p ng-bind-template="{{new.name}}"></p><a ui-sref="product-detail({id: new.id})" translate="Rush"></a></dd></dl></div><!-- **************************************** --><div class="center-ads"><slideimg imgdata="{{centerimgs}}"></slideimg></div><!-- **************************************** --><!-- <a class="full-adv">\r\n\t\t<img lazy-src="{{centerAd[0].imagePath}}" ng-click="goDetail(centerAd[0].type,centerAd[0].resourceType,centerAd[0].resourceId)">\r\n\t</a> --><div class="list"><dl ng-repeat="hot in indexdata.hotProducts" ui-sref="product-detail({id: hot.id})"><dt><a><img lazy-src="{{hot.imagePath}}"></a><i ng-if="hot.isHot==1"></i> <span class="block-status" ng-if="hot.promotionStatus==1" translate="grab"></span> <span class="block-status" ng-if="hot.promotionStatus==2" translate="grabAtOnce"></span> <span class="block-status" ng-if="hot.promotionStatus==3" translate="robbed"></span></dt><dd class="txt"><a ng-bind-template="{{hot.name}}"></a></dd><dd class="delete"><span ng-if="hot.promotionPrice<hot.price" ng-bind-template="{{hot.promotionPrice}}"></span></dd><dd>&yen;<span ng-bind-template="{{hot.price}}"></span><span class="sale"> <span translate="Sold"></span> {{hot.saleCount}} <span translate="piece"></span></span></dd><!-- promotionType: "1", //促销类型 1:打折 2减价  3满送 --><dd class="icon" ng-if="hot.type==2"><img src="http://appbuilder.loongjoy.com/phoneweb/app/img/search_jian.png" ng-if="hot.promotionType==2"> <img src="http://appbuilder.loongjoy.com/phoneweb/app/img/search_zhe.png" ng-if="hot.promotionType==1"> <img src="http://appbuilder.loongjoy.com/phoneweb/app/img/search_man.png" ng-if="hot.promotionType==3"></dd></dl></div></div><div style="height:1rem"></div><rhomefooter homelink="index.find"></rhomefooter>'),e.put("index/pointmall.html",'<rheader></rheader><div class="pointmall-main"><h2 class="bar"><span translate="currentIntegration"></span> <span ng-bind-template="{{userinfo.credits}}"></span> <button ng-class="{active:active}" ng-click="exchange()" translate="convertible"></button></h2><div class="list"><dl ui-sref="product-detail({id: point.productId})" ng-repeat="point in creditProductsList"><dt><a><img lazy-src="{{point.imagePath}}"></a></dt><dd class="txt"><a ng-bind-template="{{point.productName}}"></a></dd><dd class="point"><i></i><span ng-bind-template="{{point.credit}}"></span></dd></dl></div><div class="noproduct" ng-if="creditProductsList.length==0&&active"><span translate="Deficiency"></span> <span translate="noConvertibleProducts"></span></div><div style="height:1rem"></div><rhomefooter homelink="index.pointmall"></rhomefooter></div>'),e.put("index/sale.html",'<rheader></rheader><div class="sale-main"><swipemenu discount="2" diswidth="2"></swipemenu><div class="content" ng-repeat="sale in topMenu" ng-class="{active:index==$index}"><!-- /********************************************/ --><product start="{{sale.promotionTimeStart}}" end="{{sale.promotionTimeLeft}}" status="{{sale.status}}" summary="{{sale.summary}}"></product><!-- /********************************************/ --><ul class="list"><li ng-repeat="product in saleMenuData[$index] || topMenu[0].products"><img ng-src="{{product.imagePath}}"><dl class="content" ng-if="sale.type==1" ui-sref="product-detail({id:product.productId})"><dd class="title">【<span translate="sale"></span>】{{product.productName}}</dd><dd class="old-price">&yen;&nbsp;{{product.price}}</dd><dd class="new-price"><span class="num">&yen;&nbsp;{{product.promotionPrice}}</span><span class="txt">{{product.promotionValue}}折</span></dd></dl><dl class="content" ng-if="sale.type==2" ui-sref="product-detail({id:product.productId})"><dd class="title">【<span translate="subtract"></span>】{{product.productName}}</dd><dd class="old-price">&yen;&nbsp;{{product.price}}</dd><dd class="new-price"><span class="num">&yen;{{product.promotionPrice}}</span><span class="txt" translate="subtract"></span></dd></dl><dl class="content" ng-if="sale.type==3" ui-sref="product-detail({id:product.productId})"><dd class="title">【<span translate="give"></span>】{{product.productName}}</dd><dd class="new-price"><span class="num">&yen;&nbsp;{{product.price}}</span><span class="txt" translate="give"></span></dd></dl><div class="list-btn" ng-if="product.status==1"><a ng-class="{ready:product.status==1}"><span translate="openGrab"></span>&gt;</a></div><div class="list-btn" ng-if="product.status==2"><a ui-sref="product-detail({id:product.productId})"><span translate="alreadyOpenGrab"></span>&gt;</a> <span><span translate="havebeenRobbed"></span>{{product.saleCount}}<span translate="piece"></span></span></div><div class="list-btn" ng-if="product.status==3"><a ui-sref="product-detail({id:product.productId})" ng-class="{end:product.status==3}" translate="robbed">&gt;</a> <span><span translate="havebeenRobbed"></span>{{product.saleCount}}<span translate="piece"></span></span></div></li></ul></div></div><div style="height:1rem"></div><rhomefooter homelink="index.sale"></rhomefooter>'),e.put("index/subshop-detail.html",'<div class="header"><i ui-sref="index.subshop"></i> <span translate="convenienceSupermarket"></span> <a class="car" ng-click="goCar()"></a></div><div class="subshop-detail"><dl><dd class="part" ng-bind-template="{{detail.province}}"></dd><dd class="name" ng-bind-template="{{detail.name}}"></dd><dd class="address" ng-bind-template="{{detail.city}}{{detail.area}}{{detail.address}}"></dd></dl><a class="tel" ng-bind-template="{{detail.telephone}}" href="tel:{{detail.telephone}}"></a> <input type="hidden" name="addressLng" value="{{detail.addressLng}}"> <input type="hidden" name="addressLat" value="{{detail.addressLat}}"></div><div class="up"><i mapupbtn></i></div><map></map><div class="geo" translate="path"></div>'),e.put("index/subshop.html",'<rheader></rheader><div class="subshop-main"><div class="list"><dl ui-sref="subshop-detail( {id:list.id} )" ng-repeat="list in subshopList"><dd class="part" ng-bind-template="{{list.province}}"></dd><dd class="name" ng-bind-template="{{list.name}}"></dd><dd class="address" ng-bind-template="{{list.city}}{{list.area}}{{list.address}}"></dd><dd class="arrow"></dd></dl></div></div><rhomefooter homelink="index.subshop"></rhomefooter>'),e.put("mine/address.html",'<div class="address-main"><div class="header"><i backpage></i> <span translate="shippingAddress"></span></div><ul class="list"><li ng-repeat="add in address" data-id="{{add.id}}" ng-swipe-left="scrollleft($index)" ng-swipe-right="scrollright($index)"><p ng-click="handleAddress($index,add.id)"><span class="name">{{add.consignee}}</span> <span class="mobile">{{add.mobile}}</span> <span class="address">{{add.province}}{{add.city}}{{add.area}}{{add.detail}}</span></p><i ng-click="handleAddress($index,add.id)"></i> <button ng-click="deleteAdd(add.id)" translate="delete"></button></li></ul><div style="height:1.8rem;width:10rem"></div><div class="place"><button ng-click="plusadd()">+&nbsp;<span translate="addAddress"></span></button></div><!-- ui-sref="plus-address" --></div>'),e.put("mine/appset.html",'<div class="appset-main"><div class="header"><i ui-sref="mine"></i> <span translate="setUp"></span><!-- <i class="share"></i> --></div><ul class="list"><li ui-sref="aboutus"><span translate="aboutStore"></span><i></i></li><li ng-click="removeAppCache()"><span translate="wipeCache"></span><i></i><span ng-bind-template="{{appCacheSize.size}}K"></span></li></ul><div class="hack"></div><div class="code-con"><img src="{{appInfo.wxQrcodePath}}" ng-if="appInfo.wxQrcodePath"> <span><span translate="currentVersion"></span>{{appInfo.versionName}}</span> <a translate="quicklyDownload" ng-if="appInfo.wxQrcodePath"></a></div></div>'),e.put("mine/calendar.html",'<div class="calendar-main" calendar><div class="header"><i backpage></i> <span translate="filter"></span></div><div class="menu"><div class="status-name"><span ng-if="payState==-1" translate="whole"></span> <span ng-if="payState==0" translate="notPaid"></span> <span ng-if="payState==1" translate="alreadyPaid"></span> <span ng-if="payState==2" translate="paymentFailure"></span> <span ng-if="payState==3" translate="alreadyAhipped"></span> <span ng-if="payState==4" translate="cashOnDelivery"></span> <span ng-if="payState==5" translate="canceled"></span> <span ng-if="payState==6" translate="completed"></span></div><div class="line"></div><div class="classic-name"><span ng-if="tag==2" translate="IntegrationOrder"></span> <span ng-if="!tag || tag==1" translate="ProductOrder"></span></div><ul class="week"><li translate="Sun"></li><li translate="Mon"></li><li translate="Tues"></li><li translate="Wed"></li><li translate="Thurs"></li><li translate="Fri"></li><li translate="Sat"></li></ul><div class="chose-con"><ul class="status"><li data-status="-1" ng-class="{active: payState==-1}" translate="whole"></li><li data-status="0" ng-class="{active: payState==0}" translate="notPaid"></li><li data-status="1" ng-class="{active: payState==1}" translate="alreadyPaid"></li><li data-status="2" ng-class="{active: payState==2}" translate="paymentFailure"></li><li data-status="3" ng-class="{active: payState==3}" translate="alreadyAhipped"></li><li data-status="4" ng-class="{active: payState==4}" translate="cashOnDelivery"></li><li data-status="5" ng-class="{active: payState==5}" translate="canceled"></li><li data-status="6" ng-class="{active: payState==6}" translate="completed"></li></ul><ul class="classic"><li data-classic="2" ng-class="{active: tag ==2}" translate="IntegrationOrder"></li><li data-classic="1" ng-class="{active: tag ==1}" translate="ProductOrder"></li></ul><div class="bg"></div></div></div><div class="calendar"><div class="list" ng-repeat="monthdays in month track by $index"><h5>{{year}}<span translate="year"> </span>{{$index+1}} <span translate="month"></span></h5><div ng-repeat="days in monthdays track by $index" data-month="{{$parent.$index+1}}" data-day="{{days}}" ng-class="{start:$parent.$index+1==_startMonth&&days==_startDay,end:$parent.$index+1==_endMonth&&days==_endDay}"><span class="day">{{days}}</span> <span class="tag" ng-if="$parent.$index+1==_startMonth&&days==_startDay" translate="start"></span> <span class="tag" ng-if="$parent.$index+1==_endMonth&&days==_endDay" translate="end"></span> <span class="tag"></span></div></div></div></div>'),e.put("mine/choseguide.html",'<div class="guide-main"><div class="header"><i backpage></i> <span translate="selectShoppingGuide"></span></div><div class="list"><dl ng-repeat="list in branchList" ng-click="set(list.id)"><dd class="part" ng-bind-template="{{list.province}}"></dd><dd class="name" ng-bind-template="{{list.name}}"></dd><dd class="address" ng-bind-template="{{list.city}}{{list.area}}{{list.address}}"></dd><dd class="arrow"></dd></dl></div><selectguide></selectguide></div>'),e.put("mine/growth.html",'<div class="growth-main"><div class="header"><i backpage></i> <span translate="currentLevel"></span></div><div class="user"><div class="img-box"><img ng-src="{{userinfo.imagePath}}"></div><i ng-style="level={\'backgroundImage\':\'url({{userinfo.userRankIconPath}})\'}"></i></div><p class="num"><span ng-bind-template="{{userGrowth}}"></span> <span ng-bind-template="{{nextLevelGrowth}}" style="margin-left:0"></span></p><div class="growth-bar"><div class="bar" style="width:{{growthLength}}rem"></div></div><div class="growth-level"><span ng-repeat="rank in growth" ng-bind-template="{{rank.name}}" ng-class="{active:userLevel==$index}"></span></div><p class="note"><span translate="nextLevel"></span><span ng-bind-template="{{nextRankNeedScore}}"></span><span translate="growthValue"></span></p><div class="line"></div><div class="growth-detail"><h3 translate="growthValueDetailed"></h3><ul class="list"><li ng-repeat="list in creditRecordList"><div class="round"><div class="round-out"><div class="round-in"></div></div><div class="round-line"></div></div><div class="growth-record"><p class="des" ng-bind-template="{{list.actionMsg}}"></p><span class="add-growth">+{{list.increaseCredit}}<span translate="growthValue"></span></span> <span class="date" ng-bind-template="{{list.updateTime}}"></span></div></li></ul></div></div>'),e.put("mine/guideinformation.html",'<div class="guideinformation-main"><div class="header"><i backpage></i> <span translate="information"></span></div><div class="content"><h3 translate="myInformation"></h3><ul class="list"><li class="pic"><span translate="portrait"></span><img ng-src="{{userinfo.imagePath}}" ngf-select="uploadFiles($files,$invalidFiles)" ngf-accept="\'image/*\'" ngf-max-size="2MB"></li><li class="name"><span translate="name"></span> <input type="text" ng-show="nickInput==1" class="nickname" ng-mouseleave="hideInput()" ng-model="newNick" translate-attr="{placeholder:\'nickname\'}" maxlength="10" minlength="2"> <span ng-bind-template="{{userinfo.nickname}}" ng-click="showInput()"></span></li><li class="phone"><span translate="CellphoneNumber"></span><span ng-bind="{{userinfo.mobile}}"></span></li></ul><button ng-click="out()" translate="exitAccount"></button></div></div>'),e.put("mine/index.html",'<div class="mine-main" ng-show="dismine"><div ng-if="userinfo.roleTag==\'AppUser\'" class="common-user"><div class="banner"><div class="btn"><i class="set" ui-sref="appset"></i> <i class="msg" ui-sref="message" ui-sref-active="active" ng-if="isPush==1"></i></div><div class="user" ui-sref="mineset"><div class="img-box"><img ng-src="{{userinfo.imagePath}}"></div><i style="background-image:url({{userinfo.userRankIconPath}})"></i> <span ng-bind-template="{{userinfo.nickname}}"></span></div></div><ul class="info"><li ui-sref="myComment"><span ng-bind-template="{{userinfo.commentNum}}"></span> <span translate="comment"></span></li><li ui-sref="mypoint"><span ng-bind-template="{{userinfo.credits}}"></span> <span translate="integral"></span></li><li ui-sref="growth"><span ng-bind-template="{{userinfo.growthScore}}"></span> <span translate="growthValue"></span></li></ul><ul class="menu"><li class="bottom" ui-sref="myOrder"><i style="background-image: url(http://appbuilder.loongjoy.com/phoneweb/app/img/my_order_icon_dis.png)"></i> <span translate="MyOrder"></span> <a></a></li><li ng-if="app.isBranch==1" ng-click="goGuide()"><i style="background-image: url(http://appbuilder.loongjoy.com/phoneweb/app/img/my_shoppingguide_icon_dis.png)"></i> <span translate="MyGuide"></span> <a></a></li><li class="line" ng-if="app.isBranch==1"><div></div></li><li class="bottom" ui-sref="address({tag:2})"><i style="background-image: url(http://appbuilder.loongjoy.com/phoneweb/app/img/my_address_icon_dis.png)"></i> <span translate="shippingAddress"></span> <a></a></li><li ui-sref="myCommunity"><i style="background-image: url(http://appbuilder.loongjoy.com/phoneweb/app/img/my_post_icon_dis.png)"></i> <span translate="MyPost"></span> <a></a></li><li class="line"><div></div></li><li ui-sref="suggest"><i style="background-image: url(http://appbuilder.loongjoy.com/phoneweb/app/img/my_feedback_icon_dis.png)"></i> <span translate="complaintsAndAuggestions"></span> <a></a></li></ul></div><div ng-if="userinfo.roleTag==\'BranchGuide\'||userinfo.roleTag==\'BranchAdmin\'||userinfo.roleTag==\'BranchManager\'||userinfo.roleTag==\'BranchCashier\'" class="guide"><!-- BranchAdmin：门店管理员 --><!-- BranchManager：分店店长 --><!-- BranchGuide：分店导购 --><!-- BranchCashier：分店收银员 --><div class="banner"><div class="btn"><ul class="point" ng-if="userinfo.roleTag==\'BranchGuide\'"><li></li><li></li><li></li></ul><i class="info"><img ng-src="{{userinfo.imagePath}}" ng-if="userinfo.roleTag==\'BranchGuide\'" ui-sref="guideinformation"> <img src="http://appbuilder.loongjoy.com/phoneweb/app/img/left_nor.png" ng-if="userinfo.roleTag==\'BranchAdmin\'||userinfo.roleTag==\'BranchManager\'||userinfo.roleTag==\'BranchCashier\'" ng-click="out()"> </i><i class="set" ui-sref="appset"></i> <i class="msg" ui-sref="message" ng-if="isPush==1"></i></div><div class="content"><span class="con1" ng-if="userinfo.roleTag==\'BranchGuide\'||userinfo.roleTag==\'BranchManager\'||userinfo.roleTag==\'BranchCashier\'"><span ng-if="roleUpdateTime&&!startDate" translate="accumulatedIncome"></span> </span><span class="con1" ng-if="startDate" translate="earningsPeriod"></span> <span class="con1" ng-if="userinfo.roleTag==\'BranchAdmin\'&&!startDate" translate="TotalOrder"></span><!--产品订单金额--> <span class="money" ng-bind-template="{{sum}}" ng-if="tag==1||!tag"></span><!--积分订单--> <span class="money" ng-bind-template="0" ng-if="tag==2"></span> <span class="con2" ng-if="roleUpdateTime&&!startDate" translate="RecentUpdate"></span> <span class="con2" ng-if="roleUpdateTime&&!startDate" ng-bind-template="{{roleUpdateTime}}"></span> <span class="con2" ng-if="startDate">{{startDate}}<span translate="to"></span>{{endDate}}</span> <span ng-click="clearTime()" ng-if="startDate" class="clear-time" translate="ClearFilterDate"></span></div></div><div class="my-member" ng-hide="userinfo.roleTag==\'BranchCashier\'"><span translate="MyMember"></span> <i ui-sref="mymember"></i></div><h4><span ng-if="userinfo.roleTag==\'BranchAdmin\'" translate="orderDetails"></span> <span ng-if="userinfo.roleTag==\'BranchManager\'||userinfo.roleTag==\'BranchGuide\'||userinfo.roleTag==\'BranchCashier\'" translate="IncomeDetails"></span> <span ui-sref="calendar"><span translate="filter"></span><i></i></span></h4><div ng-if="records.length===0" class="no-list" translate="NoRecord"></div><ul class="list" ng-if="records.length>0"><li ng-repeat="record in records"><img ng-src="{{record.imagePath}}"><div class="info"><span class="name">{{record.nickname}}</span> <span class="price" ng-if="tag==1||!tag"><span translate="OrderAmount"></span>&yen;{{record.factPrice || record.price}} </span><span class="price" ng-if="tag==2"><span translate="OrderIntegration"></span>{{record.factPrice || record.price}} </span><span class="date">{{record.createTime || record.updateTime}}</span></div><span class="detail" ng-if="userinfo.roleTag!==\'BranchAdmin\'">+{{record.factPrice || record.money}}</span></li></ul><div style="width:10rem;height: 1rem"></div></div><rfooter productlink="product" articlelink="article"></rfooter></div>'),e.put("mine/message.html",'<div class="message-total"><div class="head"><img src="img/nav_button_back_nor.png" translate-attr="{alt:\'back\'}" ui-sref="mine"> <span translate="news"></span><p class="line"></p></div><ul><li ng-if="data.resourceType==1" ng-repeat="data in messageTotal" ng-swipe-left="scrollleft(data.resourceType)" ng-swipe-right="scrollright(data.resourceType)" style="margin-left:{{leftWidth1}}rem"><img src="img/product.png" alt="" ui-sref="messageList({resourceType:data.resourceType})"><div class="containers" ui-sref="messageList({resourceType:data.resourceType})"><div class="title"><h4>{{data.title}}</h4><b ng-if="data.haveRead==0"></b> <span>{{data.updateTime}}</span></div><p class="line-campT">{{data.content}}</p></div><input type="button" class="btn" translate-attr="{value:\'delete\'}" ng-click="deleteMessage(data.resourceType)"></li><li ng-if="data.resourceType==2" ng-repeat="data in messageTotal" ng-swipe-left="scrollleft(data.resourceType)" ng-swipe-right="scrollright(data.resourceType)" style="margin-left:{{leftWidth2}}rem"><img src="img/articleList.png" ui-sref="messageList({resourceType:data.resourceType})"><div class="containers" ui-sref="messageList({resourceType:data.resourceType})"><div class="title"><h4>{{data.title}}</h4><b ng-if="data.haveRead==0"></b> <span>{{data.updateTime}}</span></div><p class="line-campT">{{data.content}}</p></div><input type="button" class="btn" translate-attr="{value:\'delete\'}" ng-click="deleteMessage(data.resourceType)"></li><li ng-if="data.resourceType==3" ng-repeat="data in messageTotal" ng-swipe-left="scrollleft(data.resourceType)" ng-swipe-right="scrollright(data.resourceType)" style="margin-left:{{leftWidth3}}rem"><img src="img/system.png" alt="" ui-sref="messageList({resourceType:data.resourceType})"><div class="containers" ui-sref="messageList({resourceType:data.resourceType})"><div class="title"><h4>{{data.title}}</h4><b ng-if="data.haveRead==0"></b> <span>{{data.updateTime}}</span></div><p class="line-campT">{{data.content}}</p></div><input type="button" class="btn" translate-attr="{value:\'delete\'}" ng-click="deleteMessage(data.resourceType)"></li></ul></div>'),e.put("mine/messageList.html",'<div class="List"><ul class="title"><li ng-if="resourceType==1"><img src="img/nav_button_back_nor.png" alt="返回" ui-sref="message">产品</li><li ng-if="resourceType==2"><img src="img/nav_button_back_nor.png" alt="返回" ui-sref="message">文章</li><li ng-if="resourceType==3"><img src="img/nav_button_back_nor.png" alt="返回" ui-sref="message">系统</li></ul><ul class="detail"><li ng-repeat="list in messageList" ng-if="list.resourceType==1" ui-sref="product-detail({id:list.resourceId})"><p class="time">{{list.updateTime}}</p><img ng-src="{{list.imagePath}}" alt=""><div class="product"><h3>{{list.title}}</h3><p class="line-campT content">{{list.content}}</p></div></li><li ng-repeat="list in messageList" ng-if="list.resourceType==2" ui-sref="article-detail({id:list.resourceId})"><p class="time">{{list.updateTime}}</p><img ng-src="{{list.imagePath}}" alt=""><div class="product"><h3>{{list.title}}</h3><p class="line-campT content">{{list.content}}</p></div></li><li ng-repeat="list in messageList" class="detail" ng-if="list.resourceType==3"><p class="time">{{list.updateTime}}</p><div><h3>{{list.title}}</h3><p class="content">{{list.content}}</p></div></li></ul></div>'),e.put("mine/mineset.html",'<div class="mine-main"><div class="setting"><div class="header"><i ui-sref="mine"></i> <span>个人设置</span></div><ul class="info"><li>我的资料（点击相应信息即可修改）</li><li class="headdraw"><span>头像</span><div class="img-box"><img ng-src="{{userinfo.imagePath}}" ngf-select="uploadFiles($files,$invalidFiles)" ngf-accept="\'image/*\'" ngf-max-size="2MB"></div></li><li>昵称<span class="pull-right canClick" ng-bind-template="{{userinfo.nickname}}" ng-click="showInput()"></span> <input type="text" ng-show="nickInput==1" class="nickname" ng-mouseleave="hideInput()" ng-model="newNick" placeholder="请输入2-10位昵称" maxlength="10" minlength="2"></li><li ng-repeat="data in ranks" ng-if="userinfo.userRankId==data.id">当前等级<span class="pull-right" ui-sref="growth">{{data.name}}</span></li><li ui-sref="reset({reurl:mineset})"><span>修改密码</span></li><li ng-click="out()">注销</li></ul></div></div>'),e.put("mine/mycomment.html",'<div class="comment-main"><div class="header"><i ui-sref="mine"></i> <span>我的评论</span></div><ul class="nav"><li ng-class="{active:commentactive}" ng-click="exchange()" class="product">产品</li><li ng-class="{active:!commentactive}" ng-click="exchange()" class="article">文章</li></ul><ul class="list" ng-if="commentactive"><li ng-repeat="comment in myProductComment"><h4 class="product-title"><img lazy-src="{{comment.imagePath}}"><p ng-bind-template="{{comment.name}}" ui-sref="product-detail({id:comment.productId})"></p></h4><dl class="user-conmment"><dd class="user-info"><div class="user-img"><img lazy-src="{{userinfo.imagePath}}"></div><span class="user-name">{{userinfo.nickname}}<img ng-src="{{userinfo.userRankIconPath}}"></span><span class="star"><i class="yellow" style="width: {{ 2*.4}}rem"></i><i class="gray" style="width: {{ (5-2)*.4 }}rem"></i></span></dd><dd class="user-des" ng-bind-template="{{comment.content}}"></dd><dd class="conmment-date" ng-bind-template="{{comment.updateTime}}"></dd><dd class="seller" ng-if="comment.reply"><span class="name">商户回复：</span> <span class="date" ng-bind-template="{{comment.reply.updateTime}}"></span><div ng-bind-template="{{comment.reply.content}}"></div></dd></dl></li></ul><ul class="article-comment-list" ng-if="!commentactive"><li ng-repeat="comment in myArticleComment"><h4 ng-bind-template="{{comment.resourceName}}" ui-sref="article-detail({id:comment.resourceId})"></h4><img lazy-src="{{userinfo.imagePath}}"> <span class="name" ng-bind-template="{{userinfo.nickname}}"></span> <span class="date pull-right" ng-bind-template="{{comment.updateTime}}"></span><div class="des" ng-bind-template="{{comment.content}}"></div><div class="seller" ng-if="comment.reply"><span class="name">作者回复：</span> <span class="date" ng-bind-template="{{comment.reply.updateTime}}"></span><div ng-bind-template="{{comment.reply.content}}"></div></div></li></ul></div>'),e.put("mine/mycommunity.html",'<div class="discuz-main"><div class="header"><i ui-sref="mine"></i> <span>我的帖子</span></div><ul class="nav"><li ng-class="{active:discuzactive}" ng-click="exchange()" class="community">发布</li><li ng-class="{active:!discuzactive}" ng-click="exchange()" class="comment">评论</li></ul><div class="list" ng-if="discuzactive"><dl ng-repeat="community in myCommunity"><dd class="title"><img lazy-src="{{community.userImage}}" class="user"> {{community.nickname}}<img ng-src="{{userinfo.userRankIconPath}}" class="level"></dd><dd class="subtiitle line-ellipsis" ui-sref="community-detail( {id:community.id} )">{{community.name}}</dd><dd class="line-camp des">{{community.detail}}</dd><dd class="img"><img lazy-src="{{img}}" ng-repeat="img in community.albumImages track by $index"></dd><dd class="info"><span class="time" ng-bind-template="{{community.createTime}}"></span><span class="right"><i class="zan"></i><span>{{community.thumbNum}}</span><i class="discuss"></i><span>{{community.commentNum}}</span></span></dd></dl></div><ul class="article-comment-list" ng-if="!discuzactive"><li ng-repeat="comment in myCommunity"><h4 ng-bind-template="{{comment.resourceName}}" ui-sref="community-detail({ id:comment.resourceId })"></h4><img lazy-src="{{userinfo.imagePath}}"> <span class="name" ng-bind-template="{{userinfo.nickname}}"></span> <span class="date pull-right" ng-bind-template="{{comment.updateTime}}"></span><div class="des" ng-bind-template="{{comment.content}}"></div></li></ul></div>'),
e.put("mine/myguide.html",'<div class="guide-main myguide" pageback><div class="header"><i ui-sref="mine"></i> <span ui-sref="choseguide" ng-bind-template="{{guideInfo.branchName}}"><i></i></span></div><div class="banner"><a href="tel:{{guideInfo.mobile}}"><img ng-src="{{guideInfo.guideImagePath}}"> </a><i></i><div class="guide-info"><div class="name">{{guideInfo.nickname}}</div><div class="txt">点击头像可以咨询我</div></div><a ng-click="set(guideInfo.branchId)" class="change-guide">更换导购</a></div><ul class="list"><li ng-repeat="problem in problemsData" ui-sref="problemdetail( {id:problem.id} )"><span ng-bind-template="{{problem.name}}"></span><i></i></li></ul><selectguide></selectguide></div>'),e.put("mine/mymember.html",'<div class="mymember-main"><div class="header"><i backpage></i> <span>我的会员</span></div><h3 ng-bind-template="会员总数（{{totalMembers}}）"></h3><ul class="list"><li ng-repeat="member in members"><img lazy-src="{{member.imagePath}}"><div class="info"><span class="name" ng-bind="member.nickname"></span> <span class="phone" data-phone="{{member.mobile}}" phonenumber></span></div></li></ul></div>'),e.put("mine/myorder.html",'<div class="myorder-main" style="top:1rem"><div class="header"><i ui-sref="mine"></i> <span>我的订单</span></div><swipemenu discount="4" diswidth="2"></swipemenu><div ng-if="myOrder.length===0" class="no-order">暂无订单~~~</div><ul class="list" ng-if="myOrder.length>0"><li ng-repeat="order in myOrder"><div class="title" ui-sref="order-detail({id: order.id})">订单编号：{{order.id}} <span class="status" ng-if="order.payState==0">未支付</span> <span class="status" ng-if="order.payState==1">已支付</span> <span class="status" ng-if="order.payState==2">支付失败</span> <span class="status" ng-if="order.payState==3">已发货</span> <span class="status" ng-if="order.payState==4">货到付款</span> <span class="status" ng-if="order.payState==5">已取消</span> <span class="status" ng-if="order.payState==6">已完成</span></div><div class="detail" ng-repeat="detail in order.detail" ui-sref="order-detail({id: order.id})"><img lazy-src="{{detail.imagePath}}"><dl class="product"><dd class="product-title">{{detail.name}}</dd><dd class="product-size">{{detail.spec}}</dd><dd class="product-count" ng-if="order.type==1"><span>&yen;{{detail.price}}</span>x{{detail.number}}</dd><dd class="product-count" ng-if="order.type==2"><img src="http://appbuilder.loongjoy.com/phoneweb/app/img/integral_product_icon.png"><span>{{detail.price}}</span>x{{detail.number}}</dd></dl></div><div class="total" ng-if="order.type==1">共{{order.totalNum}}件商品 合计：&yen;<span>{{order.factPrice}}</span>（含运费&yen;{{order.shippingPrice}}）</div><div class="total" ng-if="order.type==2">共{{order.totalNum}}件商品 合计：<img src="http://appbuilder.loongjoy.com/phoneweb/app/img/integral_product_icon.png"><span>{{order.factPrice}}</span>（含运费&yen;{{order.shippingPrice}}）</div><button class="get" ng-if="order.payState==3" ng-click="takeGoods(order.id)">确认收货</button> <button class="discuz" ng-if="order.payState==5" ng-click="deleteGoods(order.id)">删除</button><!-- <button class="discuz" ng-if="order.payState==6&&order.haveComment==\'false\'||order.payState==6&&order.haveComment==\'false\'&&!comment" ng-click="takeComments(order.id)">立即评价</button> --> <button class="discuz" ng-if="order.payState==6&&order.haveComment==\'false\'" ng-click="takeComments(order.id)">立即评价</button> <button class="get" ng-if="order.payState==2">重新支付</button> <button class="get" ng-if="order.payState==0||order.payState==2" ng-click="goConfirm($index)">去支付</button> <button class="discuz" ng-if="order.payState==0" ng-click="cancelOrder(order.id)">取消订单</button></li><!-- \t\t<li>\r\n\t\t\t<div class="title">订单编号：21313132<span class="status">已发货</span></div>\r\n\t\t\t<div class="detail">\r\n\t\t\t\t<img src="/phoneweb/app/img/temp/0-1.jpg">\r\n\t\t\t\t<dl class="product">\r\n\t\t\t\t\t<dd class="product-title">和风马马属210g佐料四选一大家立刻大叫阿娇阿娇打开了巨大</dd>\r\n\t\t\t\t\t<dd class="product-size">口味：抹茶味 规格：210g</dd>\r\n\t\t\t\t\t<dd class="product-count"><span>&yen;3.00</span>x2</dd>\r\n\t\t\t\t</dl>\r\n\t\t\t</div>\r\n\t\t\t<div class="total">共两件商品 合计：&yen;<span>6.00</span>（含运费&yen;0.00）</div>\r\n\t\t\t<button class="get">确认收货</button>\r\n\t\t</li>\r\n\t\t<li>\r\n\t\t\t<div class="title">订单编号：21313132<span class="status">待评论</span></div>\r\n\t\t\t<div class="detail">\r\n\t\t\t\t<img src="/phoneweb/app/img/temp/0-1.jpg">\r\n\t\t\t\t<dl class="product">\r\n\t\t\t\t\t<dd class="product-title">和风马马属210g佐料四选一大家立刻大叫阿娇阿娇打开了巨大</dd>\r\n\t\t\t\t\t<dd class="product-size">口味：抹茶味 规格：210g</dd>\r\n\t\t\t\t\t<dd class="product-count"><span>&yen;3.00</span>x2</dd>\r\n\t\t\t\t</dl>\r\n\t\t\t</div>\r\n\t\t\t<div class="total">共两件商品 合计：&yen;<span>6.00</span>（含运费&yen;0.00）</div>\r\n\t\t\t<button class="discuz">立即评价</button>\r\n\t\t</li>\r\n\t\t<li>\r\n\t\t\t<div class="title">订单编号：21313132<span class="status">未支付</span></div>\r\n\t\t\t<div class="detail">\r\n\t\t\t\t<img src="/phoneweb/app/img/temp/0-1.jpg">\r\n\t\t\t\t<dl class="product">\r\n\t\t\t\t\t<dd class="product-title">和风马马属210g佐料四选一大家立刻大叫阿娇阿娇打开了巨大</dd>\r\n\t\t\t\t\t<dd class="product-size">口味：抹茶味 规格：210g</dd>\r\n\t\t\t\t\t<dd class="product-count"><span>&yen;3.00</span>x2</dd>\r\n\t\t\t\t</dl>\r\n\t\t\t</div>\r\n\t\t\t<div class="total">共两件商品 合计：&yen;<span>6.00</span>（含运费&yen;0.00）</div>\r\n\t\t\t<button class="get">重新支付</button>\r\n\t\t</li> --></ul></div>'),e.put("mine/mypoint.html",'<div class="mypoint-main"><div class="header"><i ui-sref="mine"></i> <span>我的积分</span></div><div class="user-info"><img ng-src="{{userinfo.imagePath}}"><div class="content"><span class="nicknanme" ng-bind-template="{{userinfo.nickname}}"></span> <span class="point" ng-bind-template="{{userinfo.credits}}积分"></span></div></div><div class="hack"></div><h5>积分收支明细</h5><ul class="list"><li ng-repeat="record in pointRecords"><div class="point-detail"><p>{{record.actionMsg}}</p><span>{{record.updateTime}}</span></div><span class="point-change"><span>{{ record.increaseCredit > 0 ? \'+\'+record.increaseCredit : record.increaseCredit}}</span></span></li></ul></div>'),e.put("mine/orderdetail.html",'<div class="order-detail-main"><div class="header"><i backpage></i> <span>订单详情</span></div><div class="address"><p><span class="name" ng-bind-template="{{order.info.consignee}}"></span> <span class="mobile" ng-bind-template="{{order.info.mobile}}"></span> <span class="detail" ng-bind-template="{{order.info.province}}{{order.info.city}}{{order.info.area}}{{order.info.detail}}"></span></p></div><ul class="list" style="margin-top:0"><li><div class="title">订单编号：{{order.info.id}} <span class="status" ng-if="order.info.payState==0">未支付</span> <span class="status" ng-if="order.info.payState==1">已支付</span> <span class="status" ng-if="order.info.payState==2">支付失败</span> <span class="status" ng-if="order.info.payState==3">已发货</span> <span class="status" ng-if="order.info.payState==4">货到付款</span> <span class="status" ng-if="order.info.payState==5">已取消</span> <span class="status" ng-if="order.info.payState==6">已完成</span></div><div class="detail" ng-repeat="detail in order.details"><img lazy-src="{{detail.imagePath}}"><dl class="product"><dd class="product-title">{{detail.name}}</dd><dd class="product-size">{{detail.spec}}</dd><!-- 单个产品价格 --><dd class="product-count" ng-if="order.info.type==1"><span>&yen;{{detail.price}}</span>x{{detail.number}}</dd><dd class="product-count" ng-if="order.info.type==2"><span><img src="http://appbuilder.loongjoy.com/phoneweb/app/img/integral_product_icon.png">{{detail.price}}</span>x{{detail.number}}</dd><!-- 单个产品价格 --></dl></div></li></ul><div class="msg"><span>留言备注：<span class="con" ng-bind-template="{{order.info.remark||\'无备注\'}}"></span></span><!--public static $payStateUnpaid = 0; //未支付\r\n\t\t public static  $payStatePaid = 1; //已支付\r\n\t\t public static  $payStateFail = 2; //支付失败\r\n\t\t public static  $payStateShipped = 3; //已发货\r\n\t\t public static  $payStateCashOnDelivery = 4; //货到付款cash on delivery\r\n\t\t public static  $payStateCanceled = 5; //已取消\r\n\t\t public static  $payStateFinished = 6; //已完成\r\n\t\t public static  $payStateExpired = 7; //已过期 --><ul class="content" ng-if="order.info.payState==3||order.info.payState==6||order.info.payState==4||order.info.payState==1||order.info.payState==0"><li ng-if="order.info.payState==3||order.info.payState==6">物流方式：<span ng-bind="order.info.ShippingCompanyName"></span></li><li ng-if="(order.info.payState==3&&order.info.shippingCompanyId!=0)||(order.info.payState==6&&order.info.shippingCompanyId!=0)">物流单号：<span ng-bind="order.info.shippingCode"></span></li><li ng-if="(order.info.payState==3&&order.info.shippingCompanyId==0)||(order.info.payState==6&&order.info.shippingCompanyId==0)"><span ng-bind-template="导购{{order.info.guideNickname}}正在配送，电话{{order.info.guideMobile}}"></span></li><li>使用积分数：{{order.info.spendCredit*number}}</li><li>本次消费累计积分：{{order.info.earnCredit}}</li><li>下单时间：<span ng-bind-template="{{order.info.updateTime}}"></span></li></ul></div><!-- 总价格 --><div class="total" ng-if="order.info.type==1">总金额：<span class="font">&yen;</span><span>&nbsp;{{order.info.factPrice}}</span>（含运费：&yen;{{order.info.shippingPrice}}）</div><div class="total" ng-if="order.info.type==2">总金额：<span class="font"><img src="http://appbuilder.loongjoy.com/phoneweb/app/img/integral_product_icon.png"></span><span>&nbsp;{{order.info.factPrice}}</span>（含运费：&yen;{{order.info.shippingPrice}}）</div><!-- 总价格 --><div class="hack"></div><div class="bottom"><button class="take" ng-if="order.info.payState==3&&!orderComfirm" ng-click="takeGoods(order.info.id)">确认收货</button> <button class="delete" ng-if="order.info.payState==5" ng-click="deleteGoods(order.info.id)">删除</button> <button class="evaluate" ng-if="order.info.payState==6&&haveComment==\'false\'" ng-click="takeComments(order.info.id)">立即评价</button> <button class="cancel" ng-click="cancelOrder(order.info.id)" ng-if="order.info.payState==0||order.info.payState==2">取消订单</button> <button class="repay" ng-click="repay(order.info.id,order.info.payType)" ng-if="order.info.payState==0||order.info.payState==2">重新支付</button></div></div>'),e.put("mine/plusaddress.html",'<div class="plus-address-main"><!-- 新增收货地址 --><form name="addressForm"><div class="plus-add" ng-style="style"><div class="header"><i backpage></i> <span ng-bind-template="{{title||\'新增收货地址\' }}"></span></div><ul class="list1"><li><span>姓名</span><input placeholder="请输入收货人姓名" ng-model="name" required></li><li><span>电话</span><input placeholder="请输入收货人联系电话" ng-model="mobile" required maxlength="11"></li></ul><ul class="list2"><li><span>所在地区</span><div class="input-div" ng-click="set(1)"><span ng-bind-template="{{proName || \'请选择省市\'}}" data-id="{{proID}}"></span><span ng-bind-template="{{cityName}}" data-id="{{cityID}}"></span><span ng-bind-template="{{areaName}}" data-id="{{areaID}}"></span></div></li><li><span>详细地址</span><input placeholder="请输入详细地址" ng-model="detailPart" required></li><li><span>邮编</span><input placeholder="请输入邮编" ng-model="postCode"></li></ul><button ng-click="saveAdd()" class="btn" ng-disabled="!addressForm.$valid">保存</button></div></form><!-- 选择省市 --><chosepart></chosepart></div>'),e.put("mine/problemdetail.html",'<div class="problem-detail-main"><div class="header"><i backpage></i> <span>常见问题详情</span></div><div ng-bind-html="detail" style="margin-top:1.1rem;padding-left:.4rem;padding-right:.3rem"></div></div>'),e.put("mine/reset.html",'<div class="reset-main enter"><div class="top"><a class="back" ui-sref="mineset"></a> <span>重设密码</span></div><form name="resetForm"><input type="password" placeholder="请输入旧密码" class="mobile" ng-model="resetOldpassword" ng-maxlength="12" ng-minlength="6" required><input type="password" placeholder="请输入6-12位新密码" class="password" ng-model="resetPassword" ng-maxlength="12" ng-minlength="6" required><button class="btn" ng-click="reset()" ng-disabled="!resetForm.$valid">确认修改</button></form></div>'),e.put("mine/suggest.html",'<div class="suggest-main"><div class="header"><i ui-sref="mine"></i> <span>投诉建议</span></div><div style="height:1rem; width:10rem"></div><ul class="msg-con" ng-repeat="suggest in msg"><li class="mine"><img src="{{userinfo.imagePath}}"><div class="msg"><div class="content">{{suggest.content}}</div><div class="date">{{suggest.updateTime}}</div></div></li><li class="other" ng-if="suggest.reply.content"><img src="http://appbuilder.loongjoy.com/phoneweb/app/img/photo_2.png"><div class="msg"><div class="content">{{suggest.reply.content}}</div><div class="date">{{suggest.reply.updateTime}}</div></div></li></ul><div style="height:1.15rem; width:10rem"></div><div class="suggest-input"><textarea placeholder="输入你想反馈的内容（限2-200字）" ng-model="content" maxlength="200" minlength="2">\r\n\t\t</textarea><button ng-click="suggest()">发送</button></div></div>'),e.put("mine/takecomments.html",'<div class="take-comments-main"><div class="header"><i backpage></i> <span>发表评价</span></div><ul class="list"><li ng-repeat="product in list" data-productid="{{product.productId}}" data-userscore="5"><img ng-src="{{product.imagePath}}"><textarea placeholder="产品怎么样？"></textarea><div><span>总分</span><star totalstar="5"></star></div></li></ul><button usercomment>立即评价</button></div>'),e.put("partials/addcut.html",'<div class="addcut" total="{{total}}"><span class="cut" ng-click="cutNum()">-</span> <input type="text" onkeyup="this.value=this.value.replace(/[^\\d]/g,\'\')" onafterpaste="this.value=this.value.replace(/[^\\d]/g,\'\')" ng-model="count" required ng-keyup="inputNum()" value="{{count}}"><span class="add" ng-click="addNum()">+</span></div>'),e.put("partials/chosepart.html",'<div class="chose-bg" ng-style="style" ng-class="{active:flagPart}"><div class="chose-part"><p><span>请上下滑动列表选择地区</span><button ng-click="sure()">确定</button></p><div class="pro" id="pro"><ul><li ng-repeat="pro in prodata" ng-bind-template="{{pro.value}}" data-id="{{pro.id}}" ng-click="chosePro(pro.value,pro.id,$index)" ng-class="{active:proindex==$index}"></li></ul></div><div class="city" id="city"><ul><li ng-repeat="city in citydata" ng-bind-template="{{city.value}}" data-id="{{city.id}}" ng-click="choseCity(city.value,city.id,$index)" ng-class="{active:cityindex==$index}"></li></ul></div><div class="area" id="area"><ul><li ng-repeat="area in areadata" ng-bind-template="{{area.value}}" data-id="{{area.id}}" ng-click="choseArea(area.value,area.id,$index)" ng-class="{active:areaindex==$index}"></li></ul></div></div></div>'),e.put("partials/community.photo.html",'<div id="photo-show" ng-click="$ctrl.hidePhoto()" ng-swipe-left="$ctrl.runleft()" ng-swipe-right="$ctrl.runright()" style="left: {{$ctrl._move_val}}rem;height:{{$ctrl._photo_height}}px;line-height:{{$ctrl._photo_height}}px;width:{{$ctrl._photo_width}}px;display:{{$ctrl.isShow}}"><div ng-repeat="img in $ctrl.data track by $index"><img lazy-src="{{img}}" style="max-height: {{$ctrl.imgMaxHeight}}px"> <span class="photo-btn"><span class="currentIndex" ng-bind-template="{{$index+1}}"></span>/ <span class="totalImg" ng-bind-template="{{$ctrl.max}}"></span></span></div></div><img lazy-src="{{img}}" ng-repeat="img in $ctrl.data track by $index" ng-click="$ctrl.showPhoto($index)">'),e.put("partials/footer.html",'<footer><ul><li ui-sref="index.find" ui-sref-active="active"><span>首页</span></li><li ui-sref="{{productlink}}" ui-sref-active="active"><span>品类</span></li><li ui-sref="community" ui-sref-active="active"><span>论坛</span></li><li ui-sref="{{articlelink}}" ui-sref-active="active"><span>文章</span></li><li ui-sref="mine" ui-sref-active="active"><span>我的</span></li></ul></footer>'),e.put("partials/header.html",'<header><div class="header-btn"><a ui-sref="index.find" href="" ui-sref-active="active">发现</a> <a ui-sref="index.sale" href="" ui-sref-active="active" ng-if="isPromotionProduct==1">促销</a> <a ui-sref="index.subshop" href="" ui-sref-active="active">分店</a> <a ui-sref="index.pointmall" href="" ui-sref-active="active" ng-if="isCreditProduct==1">积分商城</a><!-- <headerline></headerline> --></div><a class="car" ng-click="goCar()"></a></header>'),e.put("partials/home-footer.html",'<footer><ul><li ui-sref="{{homelink}}" ui-sref-active="active"><span>首页</span></li><li ui-sref="product" ui-sref-active="active"><span>品类</span></li><li ui-sref="community" ui-sref-active="active"><span>论坛</span></li><li ui-sref="article" ui-sref-active="active"><span>文章</span></li><li ui-sref="mine" ui-sref-active="active"><span>我的</span></li></ul></footer>'),e.put("partials/nodata.html",'<div class="no-data"><div><img src="http://appbuilder.loongjoy.com/phoneweb/app/img/dis_blank.png"><p>没有数据</p></div></div>'),e.put("partials/saleProduct.html",'<div class="bar"><i></i><div ng-if="status==1">{{summary}}<span>距离开始时间：{{day}}天{{hour}}:{{minute}}:{{second}}</span></div><div ng-if="status==2">{{summary}}<span>距离结束时间：{{day}}天{{hour}}:{{minute}}:{{second}}</span></div><div ng-if="status==3">{{summary}}<span>活动已结束</span></div></div>'),e.put("partials/selectguide.html",'<div class="chose-bg" ng-class="{active:flag}" ng-style="style"><!-- set()设置chose-bg样式，高度 --><div class="guide-con" ng-click="back()" ng-swipe-left="swipeLeft()" ng-swipe-right="swipeRight()" ng-style="guideStyle"><div class="list" ng-repeat="guide in guide"><h5 ng-bind-template="{{guide.nickname}}"></h5><i></i> <img ng-src="{{guide.imagePath}}" ng-click="setGuide(guide.id)"> <button ng-click="setGuide(guide.id)">选择TA</button></div></div></div>'),e.put("partials/size.html",'<div class="size"><div class="content"><img ng-src="{{imagepath}}"><div class="size-top"><i></i> <span class="price" ng-hide="needcredit">&yen;{{newprice}}</span> <span class="price" ng-if="needcredit"><i></i>{{needcredit}}</span> <span class="max-count">库存<span>{{maxcount}}</span>件<span ng-if="limitnum">&nbsp;限购{{limitnum}}件</span></span></div><div class="size-container"><div class="size-box" ng-repeat="spec in specInfo"><p ng-bind-template="{{spec.specName}}" spec-id="{{spec.specId}}"></p><a ng-repeat="values in spec.specValues" ng-bind-template="{{values.specValueName}}" value-id="{{values.specValueId}}" ng-class="{active:{{values.specValueId}}=={{specValues[$parent.$index]}} }"></a></div><div class="count-box" data-id="{{productID}}"><p>数量</p><!-- 加减按钮 --><addcut maxcount="{{maxcount}}" limitnum="{{limitnum}}" count="{{count||1}}"></addcut><!-- 加减按钮 --></div></div></div></div>'),e.put("partials/slideimg.html",'<div class="slide-img"><div class="img-box" ng-swipe-left="goleft()" ng-swipe-right="goright()"><img ng-repeat="img in imgs" ng-src="{{img.imagePath||img.url}}" style="left: {{($index-slideindex)*10}}rem" ng-click="goDetail(img.type,img.resourceType,img.resourceId,img.url)" alt="{{img.name}}"></div><div class="img-btn"><ol><li ng-class="{active:slideindex==$index}" ng-repeat="img in imgs"></li></ol></div></div>'),e.put("partials/star.html",'<div class="star-bg" userstar="{{totalstar}}"><div class="star" style="width:{{totalstar*.6}}rem"></div><ul><li ng-click="star(1)"></li><li ng-click="star(2)"></li><li ng-click="star(3)"></li><li ng-click="star(4)"></li><li ng-click="star(5)"></li></ul></div>'),e.put("partials/swipemenu.html",'<ul class="swipemenu" ng-swipe-left="swipeLeft()" ng-swipe-right="swipeRight()" style="margin-left: {{-sum}}rem" ng-show="articleLevel==2||!articleLevel&&articleLevel!==0"><li ng-repeat="menu in topMenu" ng-class="{active:acount == {{$index}} }" ng-click="menuActive($index,menu.id)" ng-bind-template="{{menu.name}}" data-id="{{menu.id}}" data-index="{{$index}}"></li></ul>'),e.put("partials/swipenavmenu.html",'<ul class="swipenavmenu" ng-swipe-left="swipeNavLeft()" ng-swipe-right="swipeNavRight()" style="margin-left: {{-navsum}}rem"><li ng-repeat="nav in navMenu" ng-class="{active:anavcount == {{$index}} }" ng-click="navActive($index,nav.id)" ng-bind-template="{{nav.name}}" data-id="{{nav.id}}" data-index="{{$index}}"></li></ul>'),e.put("product/allcomment.html",'<div class="allcomment-main"><div class="header"><i onclick="window.history.go(-1)"></i> <span ng-bind-template="全部评价（{{AllProductComment.cnt}}）"></span></div><ul class="list"><li ng-repeat="comment in AllProductComment"><dl class="user-conmment"><dd class="user-info"><div class="user-img"><img lazy-src="{{comment.userImagePath}}"></div><span class="user-name">{{comment.nickname}}<img src="http://appbuilder.loongjoy.com/phoneweb/app/img/forum_icon_grade_1_dis.png"></span><span class="star"><i class="yellow" style="width: {{ comment.score*.4}}rem"></i><i class="gray" style="width: {{ (5-comment.score)*.4 }}rem"></i></span></dd><dd class="user-des" ng-bind-template="{{comment.content}}"></dd><dd class="conmment-date" ng-bind-template="{{comment.updateTime}}"></dd><dd class="seller" ng-if="comment.reply"><span class="name">商户回复：</span> <span class="date" ng-bind-template="{{comment.reply.updateTime}}"></span><div ng-bind-template="{{comment.reply.content}}"></div></dd></dl></li></ul></div>'),e.put("product/detail.html",'<div class="detail-main"><div class="header"><i backpage></i> <span>产品信息</span> <a class="car" ng-click="goCar()"></a></div><slideimg imgdata="{{detail.albumImages}}"></slideimg><div class="detail-info"><h2 ng-bind-template="{{detail.name}}"></h2><p ng-bind-template="{{detail.summary}}"></p><span class="price" ng-if="detail.needCredit"><i></i>{{detail.needCredit}}</span> <span class="price" ng-hide="detail.needCredit">&yen;{{detail.promotionPrice ||detail.price}}</span> <span class="old" ng-if="detail.type==2&&detail.promotionType!==3">&yen;{{detail.price}}</span> <span class="point" ng-if="detail.type==3">{{detail.timeStart.substring(0,10)}}&nbsp;-&nbsp;{{detail.timeEnd.substring(0,10)}}*单用户限购{{detail.creditLimitNum}}件</span></div><div class="big-sale" ng-if="detail.type==2&&detail.promotionType==1">促销 <span class="discount">{{detail.promotionValue}}折</span> <span>&nbsp;限购{{detail.promotionLimitNum}}件</span></div><div class="big-sale" ng-if="detail.type==2&&detail.promotionType==2">促销 <span class="discount">减价{{detail.promotionValue}}</span> <span>&nbsp;限购{{detail.promotionLimitNum}}件</span></div><div class="big-sale send" ng-if="detail.type==2&&detail.promotionType==3" showsendproduct><span>促销</span> <span class="discount send">满{{detail.promotionConditionNumber}}件送{{detail.promotionValueNum}}件</span> <span>{{detail.valueName.length>10 ? detail.valueName.substring(0,10)+\'...\' : detail.valueName}}</span></div><!-- 浮动层展示被赠送产品明细 --><div class="show-send-product" ng-if="detail.type==2&&detail.promotionType==3"><div class="content"><h2>促销<i ng-click="hidesendproduct()"></i></h2><span>送</span><ul><li ui-sref="product-detail({id: detail.promotionValue})"><span class="product-name">{{detail.valueName}}</span> <span>x{{detail.promotionValueNum}}</span></li></ul></div></div><div class="bar" ng-bind-html="chosedSize"></div><div class="conmment"><h3>宝贝评价（{{detail.comments.total}}）</h3><div class="conmment-box"><p ng-if="detail.comments.comments.length<=0">暂无评价</p><dl class="user-conmment" ng-if="detail.comments.comments.length>0"><dd class="user-info"><div class="user-img"><img ng-src="{{detail.comments.comments[0].userImagePath}}"></div><span class="user-name">{{detail.comments.comments[0].nickname}}<img ng-src="http://appbuilder.loongjoy.com/phoneweb/app/img/forum_icon_grade_1_dis.png"></span><span class="star"><i class="yellow" style="width: {{ detail.comments.comments[0].score*.4}}rem"></i><i class="gray" style="width: {{ (5-detail.comments.comments[0].score)*.4 }}rem"></i></span></dd><dd class="user-des" ng-bind-template="{{detail.comments.comments[0].content}}"></dd><dd class="conmment-date">{{detail.comments.comments[0].updateTime}} {{detail.comments.comments[0].spec}}</dd></dl><a class="see-all-conmment" ng-if="detail.comments.comments.length>0" ui-sref="allComment( {id:detail.id} )">查看全部评价</a></div></div><!--<div class="detail-center">\r\n\t\t<div class="line">\r\n\t\t\t<div class="txt">继续拖动，查看图文详情</div>\r\n\t\t</div>\r\n\t</div> --><div class="img-detail-box"><div class="detail-btn"><a ng-class="{active:!flag}" ng-click="flag=!flag">图文详情</a> <i></i> <a ng-class="{active:flag}" ng-click="flag=!flag">产品规格</a></div><div class="img-detail" ng-show="!flag" ng-bind-html="allDetail"></div><div class="product-size" ng-show="flag"><table><tr ng-repeat="attr in detail.attributes"><td ng-bind-template="{{attr.attrKey}}"></td><td ng-bind-template="{{attr.attrValue}}">12个月</td></tr></table></div></div></div><!-- 规格 --><size maxcount="{{ detail.creditLimitInventory ? detail.creditLimitInventory : detail.promotionLimitInventory || detail.inventory }}" limitnum="{{ detail.creditLimitNum || detail.promotionLimitNum }}" specinfo="{{detail.specInfo || 0}}" specmaps="{{detail.specMaps || 0}}" price="{{detail.price}}" promotionprice="{{detail.promotionPrice}}" imagepath="{{detail.imagePath}}" specvalues="{{detail.specValues}}" id="{{detail.id}}" needcredit="{{detail.needCredit}}"></size><!-- 规格 --><div class="footer-btn"><a class="add-bus" ng-click="addCar()">加入购物车</a> <a class="buy-now" ng-click="buyNow()">立即购买</a></div>'),e.put("product/index.html",'<div class="product-main"><div class="header"><span>品类</span> <a class="car" ng-click="goCar()"></a></div><!-- 一级分类 --><div class="list" ng-show="productLevel==1"><swipemenu discount="5" diswidth="2"></swipemenu><div ng-style="hackStyle"></div><dl ng-repeat="product in productList" data-id="{{product.id}}"><dt><a ui-sref="product-detail({ id:product.id })"><img lazy-src="{{product.imagePath}}"></a><span class="block-status" ng-if="product.promotionStatus==1">即将开抢</span> <span class="block-status" ng-if="product.promotionStatus==2">马上抢</span> <span class="block-status" ng-if="product.promotionStatus==3">已抢光</span> <i ng-if="product.type==2&&product.promotionType==1" class="promotion-icon"><img src="http://appbuilder.loongjoy.com/phoneweb/app/img/search_zhe.png"></i><i ng-if="product.type==2&&product.promotionType==2" class="promotion-icon"><img src="http://appbuilder.loongjoy.com/phoneweb/app/img/search_jian.png"></i><i ng-if="product.type==2&&product.promotionType==3" class="promotion-icon"><img src="http://appbuilder.loongjoy.com/phoneweb/app/img/search_man.png"></i><i class="hot" ng-if="product.isHot==1"></i></dt><dd class="txt"><a ui-sref="product-detail({ id:product.id })" ng-bind-template="{{product.name}}"></a></dd><dd class="delete"><span ng-if="product.promotionPrice<product.price">&yen;&nbsp;{{product.price}}</span></dd><dd>&yen;<span>{{product.promotionPrice||product.price}}</span><span class="sale" ng-bind-template="已售{{product.saleCount}}件"></span></dd></dl></div><!-- 二级分类 --><div class="list3" ng-show="productLevel==2"><div class="list-left"><ul class="menu"><li ng-repeat="category in categoryTop" ng-class="{active:index==$index}" ng-click="menuActive($index,category.id)" ng-bind-template="{{category.name}}"></li></ul></div><div class="list-right"><div class="dl-body" ng-show="index==$index" ng-repeat="category in categoryTop"><dl ui-sref="product-list( {id:subcategory.id,name:subcategory.name} )" ng-repeat="subcategory in category.children || categorychildren[$index]"><dt><img ng-src="{{subcategory.imagePath}}"></dt><dd>{{subcategory.name}}</dd></dl></div></div></div><!-- 三级分类 --><div class="list3" ng-show="productLevel==3"><ul class="menu list-left"><li ng-repeat="category in categoryTop" ng-class="{active:index==$index}" ng-click="menuActive($index,category.id)" ng-bind-template="{{category.name}}"></li></ul><div class="list-right"><div class="dl-body" ng-show="index==$index" ng-repeat="category in categoryTop"><div ng-repeat="subcategory in category.children || categorychildren[$index]"><h3 ng-bind-template="{{subcategory.name}}"></h3><dl ui-sref="product-list( {id:product.id,name:product.name} )" ng-repeat="product in subcategory.children"><dt><img ng-src="{{product.imagePath}}"></dt><dd>{{product.name}}</dd></dl></div></div></div></div></div><rfooter productlink="product" articlelink="article"></rfooter>'),e.put("product/list.html",'<div class="product-main product-list-main"><div class="header"><i ui-sref="product"></i> <span ng-bind-template="{{listName||\'品类\'}}"></span> <a class="car" ng-click="goCar()"></a></div><div class="list"><dl ng-repeat="product in productList"><dt><a ui-sref="product-detail({id: product.id})"><img lazy-src="{{product.imagePath}}"></a><span class="block-status" ng-if="product.promotionStatus==1">即将开抢</span> <span class="block-status" ng-if="product.promotionStatus==2">马上抢</span> <span class="block-status" ng-if="product.promotionStatus==3">已抢光</span> <i ng-if="product.type==2&&product.promotionType==1" class="promotion-icon"><img src="http://appbuilder.loongjoy.com/phoneweb/app/img/search_zhe.png"></i><i ng-if="product.type==2&&product.promotionType==2" class="promotion-icon"><img src="http://appbuilder.loongjoy.com/phoneweb/app/img/search_jian.png"></i><i ng-if="product.type==2&&product.promotionType==3" class="promotion-icon"><img src="http://appbuilder.loongjoy.com/phoneweb/app/img/search_man.png"></i><i class="hot" ng-if="product.isHot==1"></i></dt><dd class="txt"><a ui-sref="product-detail( {id:product.id} )" ng-bind-template="{{product.name}}"></a></dd><dd class="delete"><span ng-if="product.promotionPrice<product.price">&yen;&nbsp;{{product.price}}</span></dd><dd>&yen;<span>{{product.promotionPrice||product.price}}</span><span class="sale" ng-bind-template="已售{{product.saleCount}}件"></span></dd></dl></div></div><div style="height:1rem"></div><rfooter productlink="product-list" articlelink="article"></rfooter>')}]);